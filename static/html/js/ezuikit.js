require("../../../@babel/runtime/helpers/Arrayincludes");var e=require("../../../@babel/runtime/helpers/typeof");function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(t,i){n(this,e),this.coreX=t,this.coreY=i}return o(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}}]),e}();Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var d=function(e,t,n){var i=document.getElementsByTagName("head")[0].getElementsByTagName("script"),o=!1;if(n)o=n();else for(var r=0;r<i.length;r++)i[r].getAttribute("src")==e&&(o=!0,t());if(o)t();else{var a=document.createElement("script");a.setAttribute("src",e),a.setAttribute("crossorigin",!0),a.onload=t,document.getElementsByTagName("head")[0].appendChild(a)}},s=function(e,t){for(var n=document.getElementsByTagName("head")[0].getElementsByTagName("link"),i=!1,o=0;o<n.length;o++)n[o].getAttribute("href")==e&&(i=!0);if(!i){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=e,r.onload=t,document.getElementsByTagName("head")[0].appendChild(r)}},c=function(e){return!!e&&("object"===t(e)||"function"==typeof e)&&"function"==typeof e.then},l=function(e,t){var n=new RegExp("(\\?|#|&)"+e+"=(.*?)(#|&|$)"),i=(t||window.location.href).match(n);return decodeURIComponent(i?i[2]:"")},u=function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},p=function(e){var t=document.documentElement.clientWidth,n="";n+="width:"+document.documentElement.clientHeight+"px;",n+="height:"+t+"px;",n+="-webkit-transform: rotate(90.001deg); transform: rotate(90.001deg);",n+="-webkit-transform-origin: "+t/2+"px "+t/2+"px;",n+="transform-origin: "+t/2+"px "+t/2+"px;",n+="position: fixed;top: 0;left: 0;z-index:10",e.style.cssText=n},m=function(e){return function(e){console.log("requestFullScreen",document.getElementById(e));var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(t)t.call(e);else if(void 0!==window.ActiveXObject){var n=new window.ActiveXObject("WScript.Shell");null!==n&&n.SendKeys("{F11}")}}(e),new Promise((function(e,t){var n=setInterval((function(){if(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen)return clearInterval(n),e(!0)}),100),i=setTimeout((function(){document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||t(!1),clearTimeout(i)}),2e3)}))},h=function(e){return document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen(),new Promise((function(e,t){var n=setInterval((function(){if(!(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen))return clearInterval(n),e(!0)}),50),i=setTimeout((function(){(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen)&&t(!1),clearTimeout(i)}),2e3)}))},f=function(e){var t=e.split("/")[3],n=e.split("/")[4].split(".")[0],i=2===e.split("/")[2].split("@").length?e.split("/")[2].split("@")[0]:"",o=-1!==e.indexOf(".hd"),r=e.split("/")[4].split(".")[e.split("/")[4].split(".").length-1].split("?")[0];return"rec"===r&&-1!==e.indexOf(".cloud.rec")&&(r="cloud.rec"),{deviceSerial:t,channelNo:n,validCode:i,hd:o,type:r}};var v=function(e,n,i,o,r,a){var d=e,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState&&200==s.status)if(function(e){if("string"==typeof e)try{var n=JSON.parse(e);return!("object"!==t(n)||!n)}catch(e){return!1}console.log("It is not a string!")}(s.responseText)){var e=JSON.parse(s.responseText);r(e)}else r(s.responseText)},s.open(n,d,!0);var c=new FormData;for(var l in i)c.append(l,i[l]);s.send(c)},g=function(){function e(t,i){var o=this;n(this,e),d("https://open.ys7.com/assets/ezuikit_v3.4/js/hls.js",(function(){console.log("加载hls.min.js成功",window.Hls),console.log("isSupportHls",window.Hls.isSupported()),window.Hls.isSupported()&&o.initHLS(t,i)}),(function(){return!!window.Hls}))}return o(e,[{key:"toString",value:function(){return"hls ".concat(this.coreX,"-").concat(this.coreY)}},{key:"initHLS",value:function(e,t){var n=document.getElementById(e),i=new window.Hls({defaultAudioCodec:"mp4a.40.2"});i.loadSource(t),i.attachMedia(n),i.on(window.Hls.Events.MANIFEST_PARSED,(function(){n.play()})),i.on(window.Hls.Events.ERROR,(function(e,t){if(t.fatal)switch(t.type){case window.Hls.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover"),i.startLoad();break;case window.Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),i.recoverMediaError();break;default:i.destroy()}})),this.hls=i,this.video=n,this.hlsUrl=t}},{key:"play",value:function(){console.log("执行hls播放",this.video),this.hls.startLoad(),this.video.play()}},{key:"stop",value:function(){this.video.pause(),this.hls.stopLoad()}}]),e}(),y=function(){function e(t,i){var o=this;n(this,e),d("https://open.ys7.com/sdk/js/2.0/js/flv.min.js",(function(){console.log("加载flv.min.js成功",window.flvjs),console.log("isSupportFlv",window.flvjs.isSupported()),window.flvjs.isSupported()&&o.initFLV(t,i)}))}return o(e,[{key:"toString",value:function(){return"Flv ".concat(this.coreX,"-").concat(this.coreY)}},{key:"initFLV",value:function(e,t){var n=document.getElementById(e);n.getAttribute("controls")||n.setAttribute("controls",!0);var i=window.flvjs.createPlayer({type:"flv",url:t,isLive:!0},{enableStashBuffer:!0,stashInitialSize:128,enableWorker:!0});i.attachMediaElement(n),i.load(),i.play(),this.flvUrl=t,this.flv=i,this.video=n}},{key:"play",value:function(){console.log("执行flv播放",this.video),this.video.play()}},{key:"stop",value:function(){this.video.pause(),this.flv.unload()}}]),e}(),C="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var S=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(t,n){(function(){var i="Expected a function",o="__lodash_placeholder__",r=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],a="[object Arguments]",d="[object Array]",s="[object Boolean]",c="[object Date]",l="[object Error]",u="[object Function]",p="[object GeneratorFunction]",m="[object Map]",h="[object Number]",f="[object Object]",v="[object RegExp]",g="[object Set]",y="[object String]",S="[object Symbol]",T="[object WeakMap]",b="[object ArrayBuffer]",w="[object DataView]",P="[object Float32Array]",k="[object Float64Array]",E="[object Int8Array]",I="[object Int16Array]",x="[object Int32Array]",_="[object Uint8Array]",j="[object Uint16Array]",R="[object Uint32Array]",M=/\b__p \+= '';/g,D=/\b(__p \+=) '' \+/g,A=/(__e\(.*?\)|\b__t\)) \+\n'';/g,B=/&(?:amp|lt|gt|quot|#39);/g,z=/[&<>"']/g,F=RegExp(B.source),L=RegExp(z.source),O=/<%-([\s\S]+?)%>/g,N=/<%([\s\S]+?)%>/g,U=/<%=([\s\S]+?)%>/g,V=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,H=/^\w*$/,W=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,K=/[\\^$.*+?()[\]{}|]/g,Z=RegExp(K.source),G=/^\s+/,J=/\s/,q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,X=/\{\n\/\* \[wrapped with (.+)\] \*/,Y=/,? & /,$=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Q=/[()=,{}\[\]\/\s]/,ee=/\\(\\)?/g,te=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ne=/\w*$/,ie=/^[-+]0x[0-9a-f]+$/i,oe=/^0b[01]+$/i,re=/^\[object .+?Constructor\]$/,ae=/^0o[0-7]+$/i,de=/^(?:0|[1-9]\d*)$/,se=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ce=/($^)/,le=/['\n\r\u2028\u2029\\]/g,ue="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",me="[\\ud800-\\udfff]",he="["+pe+"]",fe="["+ue+"]",ve="\\d+",ge="[\\u2700-\\u27bf]",ye="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ce="[^\\ud800-\\udfff"+pe+ve+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Se="\\ud83c[\\udffb-\\udfff]",Te="[^\\ud800-\\udfff]",be="(?:\\ud83c[\\udde6-\\uddff]){2}",we="[\\ud800-\\udbff][\\udc00-\\udfff]",Pe="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ke="(?:"+ye+"|"+Ce+")",Ee="(?:"+Pe+"|"+Ce+")",Ie="(?:"+fe+"|"+Se+")"+"?",xe="[\\ufe0e\\ufe0f]?"+Ie+("(?:\\u200d(?:"+[Te,be,we].join("|")+")[\\ufe0e\\ufe0f]?"+Ie+")*"),_e="(?:"+[ge,be,we].join("|")+")"+xe,je="(?:"+[Te+fe+"?",fe,be,we,me].join("|")+")",Re=RegExp("['’]","g"),Me=RegExp(fe,"g"),De=RegExp(Se+"(?="+Se+")|"+je+xe,"g"),Ae=RegExp([Pe+"?"+ye+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[he,Pe,"$"].join("|")+")",Ee+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[he,Pe+ke,"$"].join("|")+")",Pe+"?"+ke+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Pe+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ve,_e].join("|"),"g"),Be=RegExp("[\\u200d\\ud800-\\udfff"+ue+"\\ufe0e\\ufe0f]"),ze=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Le=-1,Oe={};Oe[P]=Oe[k]=Oe[E]=Oe[I]=Oe[x]=Oe[_]=Oe["[object Uint8ClampedArray]"]=Oe[j]=Oe[R]=!0,Oe[a]=Oe[d]=Oe[b]=Oe[s]=Oe[w]=Oe[c]=Oe[l]=Oe[u]=Oe[m]=Oe[h]=Oe[f]=Oe[v]=Oe[g]=Oe[y]=Oe[T]=!1;var Ne={};Ne[a]=Ne[d]=Ne[b]=Ne[w]=Ne[s]=Ne[c]=Ne[P]=Ne[k]=Ne[E]=Ne[I]=Ne[x]=Ne[m]=Ne[h]=Ne[f]=Ne[v]=Ne[g]=Ne[y]=Ne[S]=Ne[_]=Ne["[object Uint8ClampedArray]"]=Ne[j]=Ne[R]=!0,Ne[l]=Ne[u]=Ne[T]=!1;var Ue={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,He=parseInt,We="object"==e(C)&&C&&C.Object===Object&&C,Ke="object"==("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,Ze=We||Ke||Function("return this")(),Ge=n&&!n.nodeType&&n,Je=Ge&&t&&!t.nodeType&&t,qe=Je&&Je.exports===Ge,Xe=qe&&We.process,Ye=function(){try{var e=Je&&Je.require&&Je.require("util").types;return e||Xe&&Xe.binding&&Xe.binding("util")}catch(e){}}(),$e=Ye&&Ye.isArrayBuffer,Qe=Ye&&Ye.isDate,et=Ye&&Ye.isMap,tt=Ye&&Ye.isRegExp,nt=Ye&&Ye.isSet,it=Ye&&Ye.isTypedArray;function ot(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function rt(e,t,n,i){for(var o=-1,r=null==e?0:e.length;++o<r;){var a=e[o];t(i,a,n(a),e)}return i}function at(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function dt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function st(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function ct(e,t){for(var n=-1,i=null==e?0:e.length,o=0,r=[];++n<i;){var a=e[n];t(a,n,e)&&(r[o++]=a)}return r}function lt(e,t){return!!(null==e?0:e.length)&&St(e,t,0)>-1}function ut(e,t,n){for(var i=-1,o=null==e?0:e.length;++i<o;)if(n(t,e[i]))return!0;return!1}function pt(e,t){for(var n=-1,i=null==e?0:e.length,o=Array(i);++n<i;)o[n]=t(e[n],n,e);return o}function mt(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e}function ht(e,t,n,i){var o=-1,r=null==e?0:e.length;for(i&&r&&(n=e[++o]);++o<r;)n=t(n,e[o],o,e);return n}function ft(e,t,n,i){var o=null==e?0:e.length;for(i&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function vt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var gt=Pt("length");function yt(e,t,n){var i;return n(e,(function(e,n,o){if(t(e,n,o))return i=n,!1})),i}function Ct(e,t,n,i){for(var o=e.length,r=n+(i?1:-1);i?r--:++r<o;)if(t(e[r],r,e))return r;return-1}function St(e,t,n){return t==t?function(e,t,n){var i=n-1,o=e.length;for(;++i<o;)if(e[i]===t)return i;return-1}(e,t,n):Ct(e,bt,n)}function Tt(e,t,n,i){for(var o=n-1,r=e.length;++o<r;)if(i(e[o],t))return o;return-1}function bt(e){return e!=e}function wt(e,t){var n=null==e?0:e.length;return n?It(e,t)/n:NaN}function Pt(e){return function(t){return null==t?void 0:t[e]}}function kt(e){return function(t){return null==e?void 0:e[t]}}function Et(e,t,n,i,o){return o(e,(function(e,o,r){n=i?(i=!1,e):t(n,e,o,r)})),n}function It(e,t){for(var n,i=-1,o=e.length;++i<o;){var r=t(e[i]);void 0!==r&&(n=void 0===n?r:n+r)}return n}function xt(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function _t(e){return e?e.slice(0,Gt(e)+1).replace(G,""):e}function jt(e){return function(t){return e(t)}}function Rt(e,t){return pt(t,(function(t){return e[t]}))}function Mt(e,t){return e.has(t)}function Dt(e,t){for(var n=-1,i=e.length;++n<i&&St(t,e[n],0)>-1;);return n}function At(e,t){for(var n=e.length;n--&&St(t,e[n],0)>-1;);return n}function Bt(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}var zt=kt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Ft=kt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Lt(e){return"\\"+Ue[e]}function Ot(e){return Be.test(e)}function Nt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function Ut(e,t){return function(n){return e(t(n))}}function Vt(e,t){for(var n=-1,i=e.length,r=0,a=[];++n<i;){var d=e[n];d!==t&&d!==o||(e[n]=o,a[r++]=n)}return a}function Ht(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Wt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Kt(e){return Ot(e)?function(e){var t=De.lastIndex=0;for(;De.test(e);)++t;return t}(e):gt(e)}function Zt(e){return Ot(e)?function(e){return e.match(De)||[]}(e):function(e){return e.split("")}(e)}function Gt(e){for(var t=e.length;t--&&J.test(e.charAt(t)););return t}var Jt=kt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var qt=function t(n){var C,J=(n=null==n?Ze:qt.defaults(Ze.Object(),n,qt.pick(Ze,Fe))).Array,ue=n.Date,pe=n.Error,me=n.Function,he=n.Math,fe=n.Object,ve=n.RegExp,ge=n.String,ye=n.TypeError,Ce=J.prototype,Se=me.prototype,Te=fe.prototype,be=n["__core-js_shared__"],we=Se.toString,Pe=Te.hasOwnProperty,ke=0,Ee=(C=/[^.]+$/.exec(be&&be.keys&&be.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"",Ie=Te.toString,xe=we.call(fe),_e=Ze._,je=ve("^"+we.call(Pe).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=qe?n.Buffer:void 0,Be=n.Symbol,Ue=n.Uint8Array,We=De?De.allocUnsafe:void 0,Ke=Ut(fe.getPrototypeOf,fe),Ge=fe.create,Je=Te.propertyIsEnumerable,Xe=Ce.splice,Ye=Be?Be.isConcatSpreadable:void 0,gt=Be?Be.iterator:void 0,kt=Be?Be.toStringTag:void 0,Xt=function(){try{var e=nr(fe,"defineProperty");return e({},"",{}),e}catch(e){}}(),Yt=n.clearTimeout!==Ze.clearTimeout&&n.clearTimeout,$t=ue&&ue.now!==Ze.Date.now&&ue.now,Qt=n.setTimeout!==Ze.setTimeout&&n.setTimeout,en=he.ceil,tn=he.floor,nn=fe.getOwnPropertySymbols,on=De?De.isBuffer:void 0,rn=n.isFinite,an=Ce.join,dn=Ut(fe.keys,fe),sn=he.max,cn=he.min,ln=ue.now,un=n.parseInt,pn=he.random,mn=Ce.reverse,hn=nr(n,"DataView"),fn=nr(n,"Map"),vn=nr(n,"Promise"),gn=nr(n,"Set"),yn=nr(n,"WeakMap"),Cn=nr(fe,"create"),Sn=yn&&new yn,Tn={},bn=_r(hn),wn=_r(fn),Pn=_r(vn),kn=_r(gn),En=_r(yn),In=Be?Be.prototype:void 0,xn=In?In.valueOf:void 0,_n=In?In.toString:void 0;function jn(e){if(Za(e)&&!Ba(e)&&!(e instanceof An)){if(e instanceof Dn)return e;if(Pe.call(e,"__wrapped__"))return jr(e)}return new Dn(e)}var Rn=function(){function e(){}return function(t){if(!Ka(t))return{};if(Ge)return Ge(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Mn(){}function Dn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function An(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Bn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Fn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Ln(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Fn;++t<n;)this.add(e[t])}function On(e){var t=this.__data__=new zn(e);this.size=t.size}function Nn(e,t){var n=Ba(e),i=!n&&Aa(e),o=!n&&!i&&Oa(e),r=!n&&!i&&!o&&ed(e),a=n||i||o||r,d=a?xt(e.length,ge):[],s=d.length;for(var c in e)!t&&!Pe.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||cr(c,s))||d.push(c);return d}function Un(e){var t=e.length;return t?e[Li(0,t-1)]:void 0}function Vn(e,t){return Er(So(e),Yn(t,0,e.length))}function Hn(e){return Er(So(e))}function Wn(e,t,n){(void 0!==n&&!Ra(e[t],n)||void 0===n&&!(t in e))&&qn(e,t,n)}function Kn(e,t,n){var i=e[t];Pe.call(e,t)&&Ra(i,n)&&(void 0!==n||t in e)||qn(e,t,n)}function Zn(e,t){for(var n=e.length;n--;)if(Ra(e[n][0],t))return n;return-1}function Gn(e,t,n,i){return ni(e,(function(e,o,r){t(i,e,n(e),r)})),i}function Jn(e,t){return e&&To(t,bd(t),e)}function qn(e,t,n){"__proto__"==t&&Xt?Xt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Xn(e,t){for(var n=-1,i=t.length,o=J(i),r=null==e;++n<i;)o[n]=r?void 0:gd(e,t[n]);return o}function Yn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function $n(e,t,n,i,o,r){var d,l=1&t,C=2&t,T=4&t;if(n&&(d=o?n(e,i,o,r):n(e)),void 0!==d)return d;if(!Ka(e))return e;var M=Ba(e);if(M){if(d=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Pe.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!l)return So(e,d)}else{var D=rr(e),A=D==u||D==p;if(Oa(e))return ho(e,l);if(D==f||D==a||A&&!o){if(d=C||A?{}:dr(e),!l)return C?function(e,t){return To(e,or(e),t)}(e,function(e,t){return e&&To(t,wd(t),e)}(d,e)):function(e,t){return To(e,ir(e),t)}(e,Jn(d,e))}else{if(!Ne[D])return o?e:{};d=function(e,t,n){var i=e.constructor;switch(t){case b:return fo(e);case s:case c:return new i(+e);case w:return function(e,t){var n=t?fo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case k:case E:case I:case x:case _:case"[object Uint8ClampedArray]":case j:case R:return vo(e,n);case m:return new i;case h:case y:return new i(e);case v:return function(e){var t=new e.constructor(e.source,ne.exec(e));return t.lastIndex=e.lastIndex,t}(e);case g:return new i;case S:return o=e,xn?fe(xn.call(o)):{}}var o}(e,D,l)}}r||(r=new On);var B=r.get(e);if(B)return B;r.set(e,d),Ya(e)?e.forEach((function(i){d.add($n(i,t,n,i,e,r))})):Ga(e)&&e.forEach((function(i,o){d.set(o,$n(i,t,n,o,e,r))}));var z=M?void 0:(T?C?qo:Jo:C?wd:bd)(e);return at(z||e,(function(i,o){z&&(i=e[o=i]),Kn(d,o,$n(i,t,n,o,e,r))})),d}function Qn(e,t,n){var i=n.length;if(null==e)return!i;for(e=fe(e);i--;){var o=n[i],r=t[o],a=e[o];if(void 0===a&&!(o in e)||!r(a))return!1}return!0}function ei(e,t,n){if("function"!=typeof e)throw new ye(i);return br((function(){e.apply(void 0,n)}),t)}function ti(e,t,n,i){var o=-1,r=lt,a=!0,d=e.length,s=[],c=t.length;if(!d)return s;n&&(t=pt(t,jt(n))),i?(r=ut,a=!1):t.length>=200&&(r=Mt,a=!1,t=new Ln(t));e:for(;++o<d;){var l=e[o],u=null==n?l:n(l);if(l=i||0!==l?l:0,a&&u==u){for(var p=c;p--;)if(t[p]===u)continue e;s.push(l)}else r(t,u,i)||s.push(l)}return s}jn.templateSettings={escape:O,evaluate:N,interpolate:U,variable:"",imports:{_:jn}},jn.prototype=Mn.prototype,jn.prototype.constructor=jn,Dn.prototype=Rn(Mn.prototype),Dn.prototype.constructor=Dn,An.prototype=Rn(Mn.prototype),An.prototype.constructor=An,Bn.prototype.clear=function(){this.__data__=Cn?Cn(null):{},this.size=0},Bn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Bn.prototype.get=function(e){var t=this.__data__;if(Cn){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Pe.call(t,e)?t[e]:void 0},Bn.prototype.has=function(e){var t=this.__data__;return Cn?void 0!==t[e]:Pe.call(t,e)},Bn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Cn&&void 0===t?"__lodash_hash_undefined__":t,this},zn.prototype.clear=function(){this.__data__=[],this.size=0},zn.prototype.delete=function(e){var t=this.__data__,n=Zn(t,e);return!(n<0)&&(n==t.length-1?t.pop():Xe.call(t,n,1),--this.size,!0)},zn.prototype.get=function(e){var t=this.__data__,n=Zn(t,e);return n<0?void 0:t[n][1]},zn.prototype.has=function(e){return Zn(this.__data__,e)>-1},zn.prototype.set=function(e,t){var n=this.__data__,i=Zn(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},Fn.prototype.clear=function(){this.size=0,this.__data__={hash:new Bn,map:new(fn||zn),string:new Bn}},Fn.prototype.delete=function(e){var t=er(this,e).delete(e);return this.size-=t?1:0,t},Fn.prototype.get=function(e){return er(this,e).get(e)},Fn.prototype.has=function(e){return er(this,e).has(e)},Fn.prototype.set=function(e,t){var n=er(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},Ln.prototype.add=Ln.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ln.prototype.has=function(e){return this.__data__.has(e)},On.prototype.clear=function(){this.__data__=new zn,this.size=0},On.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},On.prototype.get=function(e){return this.__data__.get(e)},On.prototype.has=function(e){return this.__data__.has(e)},On.prototype.set=function(e,t){var n=this.__data__;if(n instanceof zn){var i=n.__data__;if(!fn||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Fn(i)}return n.set(e,t),this.size=n.size,this};var ni=Po(li),ii=Po(ui,!0);function oi(e,t){var n=!0;return ni(e,(function(e,i,o){return n=!!t(e,i,o)})),n}function ri(e,t,n){for(var i=-1,o=e.length;++i<o;){var r=e[i],a=t(r);if(null!=a&&(void 0===d?a==a&&!Qa(a):n(a,d)))var d=a,s=r}return s}function ai(e,t){var n=[];return ni(e,(function(e,i,o){t(e,i,o)&&n.push(e)})),n}function di(e,t,n,i,o){var r=-1,a=e.length;for(n||(n=sr),o||(o=[]);++r<a;){var d=e[r];t>0&&n(d)?t>1?di(d,t-1,n,i,o):mt(o,d):i||(o[o.length]=d)}return o}var si=ko(),ci=ko(!0);function li(e,t){return e&&si(e,t,bd)}function ui(e,t){return e&&ci(e,t,bd)}function pi(e,t){return ct(t,(function(t){return Va(e[t])}))}function mi(e,t){for(var n=0,i=(t=lo(t,e)).length;null!=e&&n<i;)e=e[xr(t[n++])];return n&&n==i?e:void 0}function hi(e,t,n){var i=t(e);return Ba(e)?i:mt(i,n(e))}function fi(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":kt&&kt in fe(e)?function(e){var t=Pe.call(e,kt),n=e[kt];try{e[kt]=void 0;var i=!0}catch(e){}var o=Ie.call(e);i&&(t?e[kt]=n:delete e[kt]);return o}(e):function(e){return Ie.call(e)}(e)}function vi(e,t){return e>t}function gi(e,t){return null!=e&&Pe.call(e,t)}function yi(e,t){return null!=e&&t in fe(e)}function Ci(e,t,n){for(var i=n?ut:lt,o=e[0].length,r=e.length,a=r,d=J(r),s=1/0,c=[];a--;){var l=e[a];a&&t&&(l=pt(l,jt(t))),s=cn(l.length,s),d[a]=!n&&(t||o>=120&&l.length>=120)?new Ln(a&&l):void 0}l=e[0];var u=-1,p=d[0];e:for(;++u<o&&c.length<s;){var m=l[u],h=t?t(m):m;if(m=n||0!==m?m:0,!(p?Mt(p,h):i(c,h,n))){for(a=r;--a;){var f=d[a];if(!(f?Mt(f,h):i(e[a],h,n)))continue e}p&&p.push(h),c.push(m)}}return c}function Si(e,t,n){var i=null==(e=yr(e,t=lo(t,e)))?e:e[xr(Ur(t))];return null==i?void 0:ot(i,e,n)}function Ti(e){return Za(e)&&fi(e)==a}function bi(e,t,n,i,o){return e===t||(null==e||null==t||!Za(e)&&!Za(t)?e!=e&&t!=t:function(e,t,n,i,o,r){var u=Ba(e),p=Ba(t),C=u?d:rr(e),T=p?d:rr(t),P=(C=C==a?f:C)==f,k=(T=T==a?f:T)==f,E=C==T;if(E&&Oa(e)){if(!Oa(t))return!1;u=!0,P=!1}if(E&&!P)return r||(r=new On),u||ed(e)?Zo(e,t,n,i,o,r):function(e,t,n,i,o,r,a){switch(n){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case b:return!(e.byteLength!=t.byteLength||!r(new Ue(e),new Ue(t)));case s:case c:case h:return Ra(+e,+t);case l:return e.name==t.name&&e.message==t.message;case v:case y:return e==t+"";case m:var d=Nt;case g:var u=1&i;if(d||(d=Ht),e.size!=t.size&&!u)return!1;var p=a.get(e);if(p)return p==t;i|=2,a.set(e,t);var f=Zo(d(e),d(t),i,o,r,a);return a.delete(e),f;case S:if(xn)return xn.call(e)==xn.call(t)}return!1}(e,t,C,n,i,o,r);if(!(1&n)){var I=P&&Pe.call(e,"__wrapped__"),x=k&&Pe.call(t,"__wrapped__");if(I||x){var _=I?e.value():e,j=x?t.value():t;return r||(r=new On),o(_,j,n,i,r)}}if(!E)return!1;return r||(r=new On),function(e,t,n,i,o,r){var a=1&n,d=Jo(e),s=d.length,c=Jo(t).length;if(s!=c&&!a)return!1;var l=s;for(;l--;){var u=d[l];if(!(a?u in t:Pe.call(t,u)))return!1}var p=r.get(e),m=r.get(t);if(p&&m)return p==t&&m==e;var h=!0;r.set(e,t),r.set(t,e);var f=a;for(;++l<s;){u=d[l];var v=e[u],g=t[u];if(i)var y=a?i(g,v,u,t,e,r):i(v,g,u,e,t,r);if(!(void 0===y?v===g||o(v,g,n,i,r):y)){h=!1;break}f||(f="constructor"==u)}if(h&&!f){var C=e.constructor,S=t.constructor;C==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof C&&C instanceof C&&"function"==typeof S&&S instanceof S||(h=!1)}return r.delete(e),r.delete(t),h}(e,t,n,i,o,r)}(e,t,n,i,bi,o))}function wi(e,t,n,i){var o=n.length,r=o,a=!i;if(null==e)return!r;for(e=fe(e);o--;){var d=n[o];if(a&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++o<r;){var s=(d=n[o])[0],c=e[s],l=d[1];if(a&&d[2]){if(void 0===c&&!(s in e))return!1}else{var u=new On;if(i)var p=i(c,l,s,e,t,u);if(!(void 0===p?bi(l,c,3,i,u):p))return!1}}return!0}function Pi(e){return!(!Ka(e)||(t=e,Ee&&Ee in t))&&(Va(e)?je:re).test(_r(e));var t}function ki(t){return"function"==typeof t?t:null==t?Jd:"object"==e(t)?Ba(t)?Ri(t[0],t[1]):ji(t):is(t)}function Ei(e){if(!hr(e))return dn(e);var t=[];for(var n in fe(e))Pe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ii(e){if(!Ka(e))return function(e){var t=[];if(null!=e)for(var n in fe(e))t.push(n);return t}(e);var t=hr(e),n=[];for(var i in e)("constructor"!=i||!t&&Pe.call(e,i))&&n.push(i);return n}function xi(e,t){return e<t}function _i(e,t){var n=-1,i=Fa(e)?J(e.length):[];return ni(e,(function(e,o,r){i[++n]=t(e,o,r)})),i}function ji(e){var t=tr(e);return 1==t.length&&t[0][2]?vr(t[0][0],t[0][1]):function(n){return n===e||wi(n,e,t)}}function Ri(e,t){return ur(e)&&fr(t)?vr(xr(e),t):function(n){var i=gd(n,e);return void 0===i&&i===t?yd(n,e):bi(t,i,3)}}function Mi(e,t,n,i,o){e!==t&&si(t,(function(r,a){if(o||(o=new On),Ka(r))!function(e,t,n,i,o,r,a){var d=Sr(e,n),s=Sr(t,n),c=a.get(s);if(c)return void Wn(e,n,c);var l=r?r(d,s,n+"",e,t,a):void 0,u=void 0===l;if(u){var p=Ba(s),m=!p&&Oa(s),h=!p&&!m&&ed(s);l=s,p||m||h?Ba(d)?l=d:La(d)?l=So(d):m?(u=!1,l=ho(s,!0)):h?(u=!1,l=vo(s,!0)):l=[]:qa(s)||Aa(s)?(l=d,Aa(d)?l=sd(d):Ka(d)&&!Va(d)||(l=dr(s))):u=!1}u&&(a.set(s,l),o(l,s,i,r,a),a.delete(s));Wn(e,n,l)}(e,t,a,n,Mi,i,o);else{var d=i?i(Sr(e,a),r,a+"",e,t,o):void 0;void 0===d&&(d=r),Wn(e,a,d)}}),wd)}function Di(e,t){var n=e.length;if(n)return cr(t+=t<0?n:0,n)?e[t]:void 0}function Ai(e,t,n){t=t.length?pt(t,(function(e){return Ba(e)?function(t){return mi(t,1===e.length?e[0]:e)}:e})):[Jd];var i=-1;return t=pt(t,jt(Qo())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(_i(e,(function(e,n,o){return{criteria:pt(t,(function(t){return t(e)})),index:++i,value:e}})),(function(e,t){return function(e,t,n){var i=-1,o=e.criteria,r=t.criteria,a=o.length,d=n.length;for(;++i<a;){var s=go(o[i],r[i]);if(s){if(i>=d)return s;var c=n[i];return s*("desc"==c?-1:1)}}return e.index-t.index}(e,t,n)}))}function Bi(e,t,n){for(var i=-1,o=t.length,r={};++i<o;){var a=t[i],d=mi(e,a);n(d,a)&&Hi(r,lo(a,e),d)}return r}function zi(e,t,n,i){var o=i?Tt:St,r=-1,a=t.length,d=e;for(e===t&&(t=So(t)),n&&(d=pt(e,jt(n)));++r<a;)for(var s=0,c=t[r],l=n?n(c):c;(s=o(d,l,s,i))>-1;)d!==e&&Xe.call(d,s,1),Xe.call(e,s,1);return e}function Fi(e,t){for(var n=e?t.length:0,i=n-1;n--;){var o=t[n];if(n==i||o!==r){var r=o;cr(o)?Xe.call(e,o,1):to(e,o)}}return e}function Li(e,t){return e+tn(pn()*(t-e+1))}function Oi(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=tn(t/2))&&(e+=e)}while(t);return n}function Ni(e,t){return wr(gr(e,t,Jd),e+"")}function Ui(e){return Un(Rd(e))}function Vi(e,t){var n=Rd(e);return Er(n,Yn(t,0,n.length))}function Hi(e,t,n,i){if(!Ka(e))return e;for(var o=-1,r=(t=lo(t,e)).length,a=r-1,d=e;null!=d&&++o<r;){var s=xr(t[o]),c=n;if("__proto__"===s||"constructor"===s||"prototype"===s)return e;if(o!=a){var l=d[s];void 0===(c=i?i(l,s,d):void 0)&&(c=Ka(l)?l:cr(t[o+1])?[]:{})}Kn(d,s,c),d=d[s]}return e}var Wi=Sn?function(e,t){return Sn.set(e,t),e}:Jd,Ki=Xt?function(e,t){return Xt(e,"toString",{configurable:!0,enumerable:!1,value:Kd(t),writable:!0})}:Jd;function Zi(e){return Er(Rd(e))}function Gi(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var r=J(o);++i<o;)r[i]=e[i+t];return r}function Ji(e,t){var n;return ni(e,(function(e,i,o){return!(n=t(e,i,o))})),!!n}function qi(e,t,n){var i=0,o=null==e?i:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;i<o;){var r=i+o>>>1,a=e[r];null!==a&&!Qa(a)&&(n?a<=t:a<t)?i=r+1:o=r}return o}return Xi(e,t,Jd,n)}function Xi(e,t,n,i){var o=0,r=null==e?0:e.length;if(0===r)return 0;for(var a=(t=n(t))!=t,d=null===t,s=Qa(t),c=void 0===t;o<r;){var l=tn((o+r)/2),u=n(e[l]),p=void 0!==u,m=null===u,h=u==u,f=Qa(u);if(a)var v=i||h;else v=c?h&&(i||p):d?h&&p&&(i||!m):s?h&&p&&!m&&(i||!f):!m&&!f&&(i?u<=t:u<t);v?o=l+1:r=l}return cn(r,4294967294)}function Yi(e,t){for(var n=-1,i=e.length,o=0,r=[];++n<i;){var a=e[n],d=t?t(a):a;if(!n||!Ra(d,s)){var s=d;r[o++]=0===a?0:a}}return r}function $i(e){return"number"==typeof e?e:Qa(e)?NaN:+e}function Qi(e){if("string"==typeof e)return e;if(Ba(e))return pt(e,Qi)+"";if(Qa(e))return _n?_n.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function eo(e,t,n){var i=-1,o=lt,r=e.length,a=!0,d=[],s=d;if(n)a=!1,o=ut;else if(r>=200){var c=t?null:No(e);if(c)return Ht(c);a=!1,o=Mt,s=new Ln}else s=t?[]:d;e:for(;++i<r;){var l=e[i],u=t?t(l):l;if(l=n||0!==l?l:0,a&&u==u){for(var p=s.length;p--;)if(s[p]===u)continue e;t&&s.push(u),d.push(l)}else o(s,u,n)||(s!==d&&s.push(u),d.push(l))}return d}function to(e,t){return null==(e=yr(e,t=lo(t,e)))||delete e[xr(Ur(t))]}function no(e,t,n,i){return Hi(e,t,n(mi(e,t)),i)}function io(e,t,n,i){for(var o=e.length,r=i?o:-1;(i?r--:++r<o)&&t(e[r],r,e););return n?Gi(e,i?0:r,i?r+1:o):Gi(e,i?r+1:0,i?o:r)}function oo(e,t){var n=e;return n instanceof An&&(n=n.value()),ht(t,(function(e,t){return t.func.apply(t.thisArg,mt([e],t.args))}),n)}function ro(e,t,n){var i=e.length;if(i<2)return i?eo(e[0]):[];for(var o=-1,r=J(i);++o<i;)for(var a=e[o],d=-1;++d<i;)d!=o&&(r[o]=ti(r[o]||a,e[d],t,n));return eo(di(r,1),t,n)}function ao(e,t,n){for(var i=-1,o=e.length,r=t.length,a={};++i<o;){var d=i<r?t[i]:void 0;n(a,e[i],d)}return a}function so(e){return La(e)?e:[]}function co(e){return"function"==typeof e?e:Jd}function lo(e,t){return Ba(e)?e:ur(e,t)?[e]:Ir(cd(e))}var uo=Ni;function po(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:Gi(e,t,n)}var mo=Yt||function(e){return Ze.clearTimeout(e)};function ho(e,t){if(t)return e.slice();var n=e.length,i=We?We(n):new e.constructor(n);return e.copy(i),i}function fo(e){var t=new e.constructor(e.byteLength);return new Ue(t).set(new Ue(e)),t}function vo(e,t){var n=t?fo(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function go(e,t){if(e!==t){var n=void 0!==e,i=null===e,o=e==e,r=Qa(e),a=void 0!==t,d=null===t,s=t==t,c=Qa(t);if(!d&&!c&&!r&&e>t||r&&a&&s&&!d&&!c||i&&a&&s||!n&&s||!o)return 1;if(!i&&!r&&!c&&e<t||c&&n&&o&&!i&&!r||d&&n&&o||!a&&o||!s)return-1}return 0}function yo(e,t,n,i){for(var o=-1,r=e.length,a=n.length,d=-1,s=t.length,c=sn(r-a,0),l=J(s+c),u=!i;++d<s;)l[d]=t[d];for(;++o<a;)(u||o<r)&&(l[n[o]]=e[o]);for(;c--;)l[d++]=e[o++];return l}function Co(e,t,n,i){for(var o=-1,r=e.length,a=-1,d=n.length,s=-1,c=t.length,l=sn(r-d,0),u=J(l+c),p=!i;++o<l;)u[o]=e[o];for(var m=o;++s<c;)u[m+s]=t[s];for(;++a<d;)(p||o<r)&&(u[m+n[a]]=e[o++]);return u}function So(e,t){var n=-1,i=e.length;for(t||(t=J(i));++n<i;)t[n]=e[n];return t}function To(e,t,n,i){var o=!n;n||(n={});for(var r=-1,a=t.length;++r<a;){var d=t[r],s=i?i(n[d],e[d],d,n,e):void 0;void 0===s&&(s=e[d]),o?qn(n,d,s):Kn(n,d,s)}return n}function bo(e,t){return function(n,i){var o=Ba(n)?rt:Gn,r=t?t():{};return o(n,e,Qo(i,2),r)}}function wo(e){return Ni((function(t,n){var i=-1,o=n.length,r=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(r=e.length>3&&"function"==typeof r?(o--,r):void 0,a&&lr(n[0],n[1],a)&&(r=o<3?void 0:r,o=1),t=fe(t);++i<o;){var d=n[i];d&&e(t,d,i,r)}return t}))}function Po(e,t){return function(n,i){if(null==n)return n;if(!Fa(n))return e(n,i);for(var o=n.length,r=t?o:-1,a=fe(n);(t?r--:++r<o)&&!1!==i(a[r],r,a););return n}}function ko(e){return function(t,n,i){for(var o=-1,r=fe(t),a=i(t),d=a.length;d--;){var s=a[e?d:++o];if(!1===n(r[s],s,r))break}return t}}function Eo(e){return function(t){var n=Ot(t=cd(t))?Zt(t):void 0,i=n?n[0]:t.charAt(0),o=n?po(n,1).join(""):t.slice(1);return i[e]()+o}}function Io(e){return function(t){return ht(Vd(Ad(t).replace(Re,"")),e,"")}}function xo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Rn(e.prototype),i=e.apply(n,t);return Ka(i)?i:n}}function _o(e){return function(t,n,i){var o=fe(t);if(!Fa(t)){var r=Qo(n,3);t=bd(t),n=function(e){return r(o[e],e,o)}}var a=e(t,n,i);return a>-1?o[r?t[a]:a]:void 0}}function jo(e){return Go((function(t){var n=t.length,o=n,r=Dn.prototype.thru;for(e&&t.reverse();o--;){var a=t[o];if("function"!=typeof a)throw new ye(i);if(r&&!d&&"wrapper"==Yo(a))var d=new Dn([],!0)}for(o=d?o:n;++o<n;){var s=Yo(a=t[o]),c="wrapper"==s?Xo(a):void 0;d=c&&pr(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?d[Yo(c[0])].apply(d,c[3]):1==a.length&&pr(a)?d[s]():d.thru(a)}return function(){var e=arguments,i=e[0];if(d&&1==e.length&&Ba(i))return d.plant(i).value();for(var o=0,r=n?t[o].apply(this,e):i;++o<n;)r=t[o].call(this,r);return r}}))}function Ro(e,t,n,i,o,r,a,d,s,c){var l=128&t,u=1&t,p=2&t,m=24&t,h=512&t,f=p?void 0:xo(e);return function v(){for(var g=arguments.length,y=J(g),C=g;C--;)y[C]=arguments[C];if(m)var S=$o(v),T=Bt(y,S);if(i&&(y=yo(y,i,o,m)),r&&(y=Co(y,r,a,m)),g-=T,m&&g<c){var b=Vt(y,S);return Lo(e,t,Ro,v.placeholder,n,y,b,d,s,c-g)}var w=u?n:this,P=p?w[e]:e;return g=y.length,d?y=Cr(y,d):h&&g>1&&y.reverse(),l&&s<g&&(y.length=s),this&&this!==Ze&&this instanceof v&&(P=f||xo(P)),P.apply(w,y)}}function Mo(e,t){return function(n,i){return function(e,t,n,i){return li(e,(function(e,o,r){t(i,n(e),o,r)})),i}(n,e,t(i),{})}}function Do(e,t){return function(n,i){var o;if(void 0===n&&void 0===i)return t;if(void 0!==n&&(o=n),void 0!==i){if(void 0===o)return i;"string"==typeof n||"string"==typeof i?(n=Qi(n),i=Qi(i)):(n=$i(n),i=$i(i)),o=e(n,i)}return o}}function Ao(e){return Go((function(t){return t=pt(t,jt(Qo())),Ni((function(n){var i=this;return e(t,(function(e){return ot(e,i,n)}))}))}))}function Bo(e,t){var n=(t=void 0===t?" ":Qi(t)).length;if(n<2)return n?Oi(t,e):t;var i=Oi(t,en(e/Kt(t)));return Ot(t)?po(Zt(i),0,e).join(""):i.slice(0,e)}function zo(e){return function(t,n,i){return i&&"number"!=typeof i&&lr(t,n,i)&&(n=i=void 0),t=od(t),void 0===n?(n=t,t=0):n=od(n),function(e,t,n,i){for(var o=-1,r=sn(en((t-e)/(n||1)),0),a=J(r);r--;)a[i?r:++o]=e,e+=n;return a}(t,n,i=void 0===i?t<n?1:-1:od(i),e)}}function Fo(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=dd(t),n=dd(n)),e(t,n)}}function Lo(e,t,n,i,o,r,a,d,s,c){var l=8&t;t|=l?32:64,4&(t&=~(l?64:32))||(t&=-4);var u=[e,t,o,l?r:void 0,l?a:void 0,l?void 0:r,l?void 0:a,d,s,c],p=n.apply(void 0,u);return pr(e)&&Tr(p,u),p.placeholder=i,Pr(p,e,t)}function Oo(e){var t=he[e];return function(e,n){if(e=dd(e),(n=null==n?0:cn(rd(n),292))&&rn(e)){var i=(cd(e)+"e").split("e");return+((i=(cd(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var No=gn&&1/Ht(new gn([,-0]))[1]==1/0?function(e){return new gn(e)}:Qd;function Uo(e){return function(t){var n=rr(t);return n==m?Nt(t):n==g?Wt(t):function(e,t){return pt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Vo(e,t,n,r,a,d,s,c){var l=2&t;if(!l&&"function"!=typeof e)throw new ye(i);var u=r?r.length:0;if(u||(t&=-97,r=a=void 0),s=void 0===s?s:sn(rd(s),0),c=void 0===c?c:rd(c),u-=a?a.length:0,64&t){var p=r,m=a;r=a=void 0}var h=l?void 0:Xo(e),f=[e,t,n,r,a,p,m,d,s,c];if(h&&function(e,t){var n=e[1],i=t[1],r=n|i,a=r<131,d=128==i&&8==n||128==i&&256==n&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==n;if(!a&&!d)return e;1&i&&(e[2]=t[2],r|=1&n?0:4);var s=t[3];if(s){var c=e[3];e[3]=c?yo(c,s,t[4]):s,e[4]=c?Vt(e[3],o):t[4]}(s=t[5])&&(c=e[5],e[5]=c?Co(c,s,t[6]):s,e[6]=c?Vt(e[5],o):t[6]);(s=t[7])&&(e[7]=s);128&i&&(e[8]=null==e[8]?t[8]:cn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=r}(f,h),e=f[0],t=f[1],n=f[2],r=f[3],a=f[4],!(c=f[9]=void 0===f[9]?l?0:e.length:sn(f[9]-u,0))&&24&t&&(t&=-25),t&&1!=t)v=8==t||16==t?function(e,t,n){var i=xo(e);return function o(){for(var r=arguments.length,a=J(r),d=r,s=$o(o);d--;)a[d]=arguments[d];var c=r<3&&a[0]!==s&&a[r-1]!==s?[]:Vt(a,s);if((r-=c.length)<n)return Lo(e,t,Ro,o.placeholder,void 0,a,c,void 0,void 0,n-r);var l=this&&this!==Ze&&this instanceof o?i:e;return ot(l,this,a)}}(e,t,c):32!=t&&33!=t||a.length?Ro.apply(void 0,f):function(e,t,n,i){var o=1&t,r=xo(e);return function t(){for(var a=-1,d=arguments.length,s=-1,c=i.length,l=J(c+d),u=this&&this!==Ze&&this instanceof t?r:e;++s<c;)l[s]=i[s];for(;d--;)l[s++]=arguments[++a];return ot(u,o?n:this,l)}}(e,t,n,r);else var v=function(e,t,n){var i=1&t,o=xo(e);return function t(){var r=this&&this!==Ze&&this instanceof t?o:e;return r.apply(i?n:this,arguments)}}(e,t,n);return Pr((h?Wi:Tr)(v,f),e,t)}function Ho(e,t,n,i){return void 0===e||Ra(e,Te[n])&&!Pe.call(i,n)?t:e}function Wo(e,t,n,i,o,r){return Ka(e)&&Ka(t)&&(r.set(t,e),Mi(e,t,void 0,Wo,r),r.delete(t)),e}function Ko(e){return qa(e)?void 0:e}function Zo(e,t,n,i,o,r){var a=1&n,d=e.length,s=t.length;if(d!=s&&!(a&&s>d))return!1;var c=r.get(e),l=r.get(t);if(c&&l)return c==t&&l==e;var u=-1,p=!0,m=2&n?new Ln:void 0;for(r.set(e,t),r.set(t,e);++u<d;){var h=e[u],f=t[u];if(i)var v=a?i(f,h,u,t,e,r):i(h,f,u,e,t,r);if(void 0!==v){if(v)continue;p=!1;break}if(m){if(!vt(t,(function(e,t){if(!Mt(m,t)&&(h===e||o(h,e,n,i,r)))return m.push(t)}))){p=!1;break}}else if(h!==f&&!o(h,f,n,i,r)){p=!1;break}}return r.delete(e),r.delete(t),p}function Go(e){return wr(gr(e,void 0,zr),e+"")}function Jo(e){return hi(e,bd,ir)}function qo(e){return hi(e,wd,or)}var Xo=Sn?function(e){return Sn.get(e)}:Qd;function Yo(e){for(var t=e.name+"",n=Tn[t],i=Pe.call(Tn,t)?n.length:0;i--;){var o=n[i],r=o.func;if(null==r||r==e)return o.name}return t}function $o(e){return(Pe.call(jn,"placeholder")?jn:e).placeholder}function Qo(){var e=jn.iteratee||qd;return e=e===qd?ki:e,arguments.length?e(arguments[0],arguments[1]):e}function er(t,n){var i,o,r=t.__data__;return("string"==(o=e(i=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==i:null===i)?r["string"==typeof n?"string":"hash"]:r.map}function tr(e){for(var t=bd(e),n=t.length;n--;){var i=t[n],o=e[i];t[n]=[i,o,fr(o)]}return t}function nr(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Pi(n)?n:void 0}var ir=nn?function(e){return null==e?[]:(e=fe(e),ct(nn(e),(function(t){return Je.call(e,t)})))}:as,or=nn?function(e){for(var t=[];e;)mt(t,ir(e)),e=Ke(e);return t}:as,rr=fi;function ar(e,t,n){for(var i=-1,o=(t=lo(t,e)).length,r=!1;++i<o;){var a=xr(t[i]);if(!(r=null!=e&&n(e,a)))break;e=e[a]}return r||++i!=o?r:!!(o=null==e?0:e.length)&&Wa(o)&&cr(a,o)&&(Ba(e)||Aa(e))}function dr(e){return"function"!=typeof e.constructor||hr(e)?{}:Rn(Ke(e))}function sr(e){return Ba(e)||Aa(e)||!!(Ye&&e&&e[Ye])}function cr(t,n){var i=e(t);return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&de.test(t))&&t>-1&&t%1==0&&t<n}function lr(t,n,i){if(!Ka(i))return!1;var o=e(n);return!!("number"==o?Fa(i)&&cr(n,i.length):"string"==o&&n in i)&&Ra(i[n],t)}function ur(t,n){if(Ba(t))return!1;var i=e(t);return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!Qa(t))||(H.test(t)||!V.test(t)||null!=n&&t in fe(n))}function pr(e){var t=Yo(e),n=jn[t];if("function"!=typeof n||!(t in An.prototype))return!1;if(e===n)return!0;var i=Xo(n);return!!i&&e===i[0]}(hn&&rr(new hn(new ArrayBuffer(1)))!=w||fn&&rr(new fn)!=m||vn&&"[object Promise]"!=rr(vn.resolve())||gn&&rr(new gn)!=g||yn&&rr(new yn)!=T)&&(rr=function(e){var t=fi(e),n=t==f?e.constructor:void 0,i=n?_r(n):"";if(i)switch(i){case bn:return w;case wn:return m;case Pn:return"[object Promise]";case kn:return g;case En:return T}return t});var mr=be?Va:ds;function hr(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Te)}function fr(e){return e==e&&!Ka(e)}function vr(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in fe(n)))}}function gr(e,t,n){return t=sn(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,r=sn(i.length-t,0),a=J(r);++o<r;)a[o]=i[t+o];o=-1;for(var d=J(t+1);++o<t;)d[o]=i[o];return d[t]=n(a),ot(e,this,d)}}function yr(e,t){return t.length<2?e:mi(e,Gi(t,0,-1))}function Cr(e,t){for(var n=e.length,i=cn(t.length,n),o=So(e);i--;){var r=t[i];e[i]=cr(r,n)?o[r]:void 0}return e}function Sr(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Tr=kr(Wi),br=Qt||function(e,t){return Ze.setTimeout(e,t)},wr=kr(Ki);function Pr(e,t,n){var i=t+"";return wr(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(q,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return at(r,(function(n){var i="_."+n[0];t&n[1]&&!lt(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(X);return t?t[1].split(Y):[]}(i),n)))}function kr(e){var t=0,n=0;return function(){var i=ln(),o=16-(i-n);if(n=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Er(e,t){var n=-1,i=e.length,o=i-1;for(t=void 0===t?i:t;++n<t;){var r=Li(n,o),a=e[r];e[r]=e[n],e[n]=a}return e.length=t,e}var Ir=function(e){var t=ka(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(W,(function(e,n,i,o){t.push(i?o.replace(ee,"$1"):n||e)})),t}));function xr(e){if("string"==typeof e||Qa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function _r(e){if(null!=e){try{return we.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function jr(e){if(e instanceof An)return e.clone();var t=new Dn(e.__wrapped__,e.__chain__);return t.__actions__=So(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Rr=Ni((function(e,t){return La(e)?ti(e,di(t,1,La,!0)):[]})),Mr=Ni((function(e,t){var n=Ur(t);return La(n)&&(n=void 0),La(e)?ti(e,di(t,1,La,!0),Qo(n,2)):[]})),Dr=Ni((function(e,t){var n=Ur(t);return La(n)&&(n=void 0),La(e)?ti(e,di(t,1,La,!0),void 0,n):[]}));function Ar(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=null==n?0:rd(n);return o<0&&(o=sn(i+o,0)),Ct(e,Qo(t,3),o)}function Br(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return void 0!==n&&(o=rd(n),o=n<0?sn(i+o,0):cn(o,i-1)),Ct(e,Qo(t,3),o,!0)}function zr(e){return(null==e?0:e.length)?di(e,1):[]}function Fr(e){return e&&e.length?e[0]:void 0}var Lr=Ni((function(e){var t=pt(e,so);return t.length&&t[0]===e[0]?Ci(t):[]})),Or=Ni((function(e){var t=Ur(e),n=pt(e,so);return t===Ur(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?Ci(n,Qo(t,2)):[]})),Nr=Ni((function(e){var t=Ur(e),n=pt(e,so);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?Ci(n,void 0,t):[]}));function Ur(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Vr=Ni(Hr);function Hr(e,t){return e&&e.length&&t&&t.length?zi(e,t):e}var Wr=Go((function(e,t){var n=null==e?0:e.length,i=Xn(e,t);return Fi(e,pt(t,(function(e){return cr(e,n)?+e:e})).sort(go)),i}));function Kr(e){return null==e?e:mn.call(e)}var Zr=Ni((function(e){return eo(di(e,1,La,!0))})),Gr=Ni((function(e){var t=Ur(e);return La(t)&&(t=void 0),eo(di(e,1,La,!0),Qo(t,2))})),Jr=Ni((function(e){var t=Ur(e);return t="function"==typeof t?t:void 0,eo(di(e,1,La,!0),void 0,t)}));function qr(e){if(!e||!e.length)return[];var t=0;return e=ct(e,(function(e){if(La(e))return t=sn(e.length,t),!0})),xt(t,(function(t){return pt(e,Pt(t))}))}function Xr(e,t){if(!e||!e.length)return[];var n=qr(e);return null==t?n:pt(n,(function(e){return ot(t,void 0,e)}))}var Yr=Ni((function(e,t){return La(e)?ti(e,t):[]})),$r=Ni((function(e){return ro(ct(e,La))})),Qr=Ni((function(e){var t=Ur(e);return La(t)&&(t=void 0),ro(ct(e,La),Qo(t,2))})),ea=Ni((function(e){var t=Ur(e);return t="function"==typeof t?t:void 0,ro(ct(e,La),void 0,t)})),ta=Ni(qr);var na=Ni((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Xr(e,n)}));function ia(e){var t=jn(e);return t.__chain__=!0,t}function oa(e,t){return t(e)}var ra=Go((function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,o=function(t){return Xn(t,e)};return!(t>1||this.__actions__.length)&&i instanceof An&&cr(n)?((i=i.slice(n,+n+(t?1:0))).__actions__.push({func:oa,args:[o],thisArg:void 0}),new Dn(i,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(o)}));var aa=bo((function(e,t,n){Pe.call(e,n)?++e[n]:qn(e,n,1)}));var da=_o(Ar),sa=_o(Br);function ca(e,t){return(Ba(e)?at:ni)(e,Qo(t,3))}function la(e,t){return(Ba(e)?dt:ii)(e,Qo(t,3))}var ua=bo((function(e,t,n){Pe.call(e,n)?e[n].push(t):qn(e,n,[t])}));var pa=Ni((function(e,t,n){var i=-1,o="function"==typeof t,r=Fa(e)?J(e.length):[];return ni(e,(function(e){r[++i]=o?ot(t,e,n):Si(e,t,n)})),r})),ma=bo((function(e,t,n){qn(e,n,t)}));function ha(e,t){return(Ba(e)?pt:_i)(e,Qo(t,3))}var fa=bo((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var va=Ni((function(e,t){if(null==e)return[];var n=t.length;return n>1&&lr(e,t[0],t[1])?t=[]:n>2&&lr(t[0],t[1],t[2])&&(t=[t[0]]),Ai(e,di(t,1),[])})),ga=$t||function(){return Ze.Date.now()};function ya(e,t,n){return t=n?void 0:t,Vo(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function Ca(e,t){var n;if("function"!=typeof t)throw new ye(i);return e=rd(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var Sa=Ni((function(e,t,n){var i=1;if(n.length){var o=Vt(n,$o(Sa));i|=32}return Vo(e,i,t,n,o)})),Ta=Ni((function(e,t,n){var i=3;if(n.length){var o=Vt(n,$o(Ta));i|=32}return Vo(t,i,e,n,o)}));function ba(e,t,n){var o,r,a,d,s,c,l=0,u=!1,p=!1,m=!0;if("function"!=typeof e)throw new ye(i);function h(t){var n=o,i=r;return o=r=void 0,l=t,d=e.apply(i,n)}function f(e){return l=e,s=br(g,t),u?h(e):d}function v(e){var n=e-c;return void 0===c||n>=t||n<0||p&&e-l>=a}function g(){var e=ga();if(v(e))return y(e);s=br(g,function(e){var n=t-(e-c);return p?cn(n,a-(e-l)):n}(e))}function y(e){return s=void 0,m&&o?h(e):(o=r=void 0,d)}function C(){var e=ga(),n=v(e);if(o=arguments,r=this,c=e,n){if(void 0===s)return f(c);if(p)return mo(s),s=br(g,t),h(c)}return void 0===s&&(s=br(g,t)),d}return t=dd(t)||0,Ka(n)&&(u=!!n.leading,a=(p="maxWait"in n)?sn(dd(n.maxWait)||0,t):a,m="trailing"in n?!!n.trailing:m),C.cancel=function(){void 0!==s&&mo(s),l=0,o=c=r=s=void 0},C.flush=function(){return void 0===s?d:y(ga())},C}var wa=Ni((function(e,t){return ei(e,1,t)})),Pa=Ni((function(e,t,n){return ei(e,dd(t)||0,n)}));function ka(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ye(i);var n=function n(){var i=arguments,o=t?t.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var a=e.apply(this,i);return n.cache=r.set(o,a)||r,a};return n.cache=new(ka.Cache||Fn),n}function Ea(e){if("function"!=typeof e)throw new ye(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ka.Cache=Fn;var Ia=uo((function(e,t){var n=(t=1==t.length&&Ba(t[0])?pt(t[0],jt(Qo())):pt(di(t,1),jt(Qo()))).length;return Ni((function(i){for(var o=-1,r=cn(i.length,n);++o<r;)i[o]=t[o].call(this,i[o]);return ot(e,this,i)}))})),xa=Ni((function(e,t){return Vo(e,32,void 0,t,Vt(t,$o(xa)))})),_a=Ni((function(e,t){return Vo(e,64,void 0,t,Vt(t,$o(_a)))})),ja=Go((function(e,t){return Vo(e,256,void 0,void 0,void 0,t)}));function Ra(e,t){return e===t||e!=e&&t!=t}var Ma=Fo(vi),Da=Fo((function(e,t){return e>=t})),Aa=Ti(function(){return arguments}())?Ti:function(e){return Za(e)&&Pe.call(e,"callee")&&!Je.call(e,"callee")},Ba=J.isArray,za=$e?jt($e):function(e){return Za(e)&&fi(e)==b};function Fa(e){return null!=e&&Wa(e.length)&&!Va(e)}function La(e){return Za(e)&&Fa(e)}var Oa=on||ds,Na=Qe?jt(Qe):function(e){return Za(e)&&fi(e)==c};function Ua(e){if(!Za(e))return!1;var t=fi(e);return t==l||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!qa(e)}function Va(e){if(!Ka(e))return!1;var t=fi(e);return t==u||t==p||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ha(e){return"number"==typeof e&&e==rd(e)}function Wa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ka(t){var n=e(t);return null!=t&&("object"==n||"function"==n)}function Za(t){return null!=t&&"object"==e(t)}var Ga=et?jt(et):function(e){return Za(e)&&rr(e)==m};function Ja(e){return"number"==typeof e||Za(e)&&fi(e)==h}function qa(e){if(!Za(e)||fi(e)!=f)return!1;var t=Ke(e);if(null===t)return!0;var n=Pe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&we.call(n)==xe}var Xa=tt?jt(tt):function(e){return Za(e)&&fi(e)==v};var Ya=nt?jt(nt):function(e){return Za(e)&&rr(e)==g};function $a(e){return"string"==typeof e||!Ba(e)&&Za(e)&&fi(e)==y}function Qa(t){return"symbol"==e(t)||Za(t)&&fi(t)==S}var ed=it?jt(it):function(e){return Za(e)&&Wa(e.length)&&!!Oe[fi(e)]};var td=Fo(xi),nd=Fo((function(e,t){return e<=t}));function id(e){if(!e)return[];if(Fa(e))return $a(e)?Zt(e):So(e);if(gt&&e[gt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[gt]());var t=rr(e);return(t==m?Nt:t==g?Ht:Rd)(e)}function od(e){return e?(e=dd(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function rd(e){var t=od(e),n=t%1;return t==t?n?t-n:t:0}function ad(e){return e?Yn(rd(e),0,4294967295):0}function dd(e){if("number"==typeof e)return e;if(Qa(e))return NaN;if(Ka(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ka(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=_t(e);var n=oe.test(e);return n||ae.test(e)?He(e.slice(2),n?2:8):ie.test(e)?NaN:+e}function sd(e){return To(e,wd(e))}function cd(e){return null==e?"":Qi(e)}var ld=wo((function(e,t){if(hr(t)||Fa(t))To(t,bd(t),e);else for(var n in t)Pe.call(t,n)&&Kn(e,n,t[n])})),ud=wo((function(e,t){To(t,wd(t),e)})),pd=wo((function(e,t,n,i){To(t,wd(t),e,i)})),md=wo((function(e,t,n,i){To(t,bd(t),e,i)})),hd=Go(Xn);var fd=Ni((function(e,t){e=fe(e);var n=-1,i=t.length,o=i>2?t[2]:void 0;for(o&&lr(t[0],t[1],o)&&(i=1);++n<i;)for(var r=t[n],a=wd(r),d=-1,s=a.length;++d<s;){var c=a[d],l=e[c];(void 0===l||Ra(l,Te[c])&&!Pe.call(e,c))&&(e[c]=r[c])}return e})),vd=Ni((function(e){return e.push(void 0,Wo),ot(kd,void 0,e)}));function gd(e,t,n){var i=null==e?void 0:mi(e,t);return void 0===i?n:i}function yd(e,t){return null!=e&&ar(e,t,yi)}var Cd=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ie.call(t)),e[t]=n}),Kd(Jd)),Sd=Mo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ie.call(t)),Pe.call(e,t)?e[t].push(n):e[t]=[n]}),Qo),Td=Ni(Si);function bd(e){return Fa(e)?Nn(e):Ei(e)}function wd(e){return Fa(e)?Nn(e,!0):Ii(e)}var Pd=wo((function(e,t,n){Mi(e,t,n)})),kd=wo((function(e,t,n,i){Mi(e,t,n,i)})),Ed=Go((function(e,t){var n={};if(null==e)return n;var i=!1;t=pt(t,(function(t){return t=lo(t,e),i||(i=t.length>1),t})),To(e,qo(e),n),i&&(n=$n(n,7,Ko));for(var o=t.length;o--;)to(n,t[o]);return n}));var Id=Go((function(e,t){return null==e?{}:function(e,t){return Bi(e,t,(function(t,n){return yd(e,n)}))}(e,t)}));function xd(e,t){if(null==e)return{};var n=pt(qo(e),(function(e){return[e]}));return t=Qo(t),Bi(e,n,(function(e,n){return t(e,n[0])}))}var _d=Uo(bd),jd=Uo(wd);function Rd(e){return null==e?[]:Rt(e,bd(e))}var Md=Io((function(e,t,n){return t=t.toLowerCase(),e+(n?Dd(t):t)}));function Dd(e){return Ud(cd(e).toLowerCase())}function Ad(e){return(e=cd(e))&&e.replace(se,zt).replace(Me,"")}var Bd=Io((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),zd=Io((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Fd=Eo("toLowerCase");var Ld=Io((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Od=Io((function(e,t,n){return e+(n?" ":"")+Ud(t)}));var Nd=Io((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ud=Eo("toUpperCase");function Vd(e,t,n){return e=cd(e),void 0===(t=n?void 0:t)?function(e){return ze.test(e)}(e)?function(e){return e.match(Ae)||[]}(e):function(e){return e.match($)||[]}(e):e.match(t)||[]}var Hd=Ni((function(e,t){try{return ot(e,void 0,t)}catch(e){return Ua(e)?e:new pe(e)}})),Wd=Go((function(e,t){return at(t,(function(t){t=xr(t),qn(e,t,Sa(e[t],e))})),e}));function Kd(e){return function(){return e}}var Zd=jo(),Gd=jo(!0);function Jd(e){return e}function qd(e){return ki("function"==typeof e?e:$n(e,1))}var Xd=Ni((function(e,t){return function(n){return Si(n,e,t)}})),Yd=Ni((function(e,t){return function(n){return Si(e,n,t)}}));function $d(e,t,n){var i=bd(t),o=pi(t,i);null!=n||Ka(t)&&(o.length||!i.length)||(n=t,t=e,e=this,o=pi(t,bd(t)));var r=!(Ka(n)&&"chain"in n&&!n.chain),a=Va(e);return at(o,(function(n){var i=t[n];e[n]=i,a&&(e.prototype[n]=function(){var t=this.__chain__;if(r||t){var n=e(this.__wrapped__),o=n.__actions__=So(this.__actions__);return o.push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,mt([this.value()],arguments))})})),e}function Qd(){}var es=Ao(pt),ts=Ao(st),ns=Ao(vt);function is(e){return ur(e)?Pt(xr(e)):function(e){return function(t){return mi(t,e)}}(e)}var os=zo(),rs=zo(!0);function as(){return[]}function ds(){return!1}var ss=Do((function(e,t){return e+t}),0),cs=Oo("ceil"),ls=Do((function(e,t){return e/t}),1),us=Oo("floor");var ps,ms=Do((function(e,t){return e*t}),1),hs=Oo("round"),fs=Do((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new ye(i);return e=rd(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=ya,jn.assign=ld,jn.assignIn=ud,jn.assignInWith=pd,jn.assignWith=md,jn.at=hd,jn.before=Ca,jn.bind=Sa,jn.bindAll=Wd,jn.bindKey=Ta,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ba(e)?e:[e]},jn.chain=ia,jn.chunk=function(e,t,n){t=(n?lr(e,t,n):void 0===t)?1:sn(rd(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,r=0,a=J(en(i/t));o<i;)a[r++]=Gi(e,o,o+=t);return a},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,o=[];++t<n;){var r=e[t];r&&(o[i++]=r)}return o},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=J(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return mt(Ba(n)?So(n):[n],di(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=Qo();return e=t?pt(e,(function(e){if("function"!=typeof e[1])throw new ye(i);return[n(e[0]),e[1]]})):[],Ni((function(n){for(var i=-1;++i<t;){var o=e[i];if(ot(o[0],this,n))return ot(o[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=bd(e);return function(n){return Qn(n,e,t)}}($n(e,1))},jn.constant=Kd,jn.countBy=aa,jn.create=function(e,t){var n=Rn(e);return null==t?n:Jn(n,t)},jn.curry=function e(t,n,i){var o=Vo(t,8,void 0,void 0,void 0,void 0,void 0,n=i?void 0:n);return o.placeholder=e.placeholder,o},jn.curryRight=function e(t,n,i){var o=Vo(t,16,void 0,void 0,void 0,void 0,void 0,n=i?void 0:n);return o.placeholder=e.placeholder,o},jn.debounce=ba,jn.defaults=fd,jn.defaultsDeep=vd,jn.defer=wa,jn.delay=Pa,jn.difference=Rr,jn.differenceBy=Mr,jn.differenceWith=Dr,jn.drop=function(e,t,n){var i=null==e?0:e.length;return i?Gi(e,(t=n||void 0===t?1:rd(t))<0?0:t,i):[]},jn.dropRight=function(e,t,n){var i=null==e?0:e.length;return i?Gi(e,0,(t=i-(t=n||void 0===t?1:rd(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?io(e,Qo(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?io(e,Qo(t,3),!0):[]},jn.fill=function(e,t,n,i){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&lr(e,t,n)&&(n=0,i=o),function(e,t,n,i){var o=e.length;for((n=rd(n))<0&&(n=-n>o?0:o+n),(i=void 0===i||i>o?o:rd(i))<0&&(i+=o),i=n>i?0:ad(i);n<i;)e[n++]=t;return e}(e,t,n,i)):[]},jn.filter=function(e,t){return(Ba(e)?ct:ai)(e,Qo(t,3))},jn.flatMap=function(e,t){return di(ha(e,t),1)},jn.flatMapDeep=function(e,t){return di(ha(e,t),1/0)},jn.flatMapDepth=function(e,t,n){return n=void 0===n?1:rd(n),di(ha(e,t),n)},jn.flatten=zr,jn.flattenDeep=function(e){return(null==e?0:e.length)?di(e,1/0):[]},jn.flattenDepth=function(e,t){return(null==e?0:e.length)?di(e,t=void 0===t?1:rd(t)):[]},jn.flip=function(e){return Vo(e,512)},jn.flow=Zd,jn.flowRight=Gd,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var o=e[t];i[o[0]]=o[1]}return i},jn.functions=function(e){return null==e?[]:pi(e,bd(e))},jn.functionsIn=function(e){return null==e?[]:pi(e,wd(e))},jn.groupBy=ua,jn.initial=function(e){return(null==e?0:e.length)?Gi(e,0,-1):[]},jn.intersection=Lr,jn.intersectionBy=Or,jn.intersectionWith=Nr,jn.invert=Cd,jn.invertBy=Sd,jn.invokeMap=pa,jn.iteratee=qd,jn.keyBy=ma,jn.keys=bd,jn.keysIn=wd,jn.map=ha,jn.mapKeys=function(e,t){var n={};return t=Qo(t,3),li(e,(function(e,i,o){qn(n,t(e,i,o),e)})),n},jn.mapValues=function(e,t){var n={};return t=Qo(t,3),li(e,(function(e,i,o){qn(n,i,t(e,i,o))})),n},jn.matches=function(e){return ji($n(e,1))},jn.matchesProperty=function(e,t){return Ri(e,$n(t,1))},jn.memoize=ka,jn.merge=Pd,jn.mergeWith=kd,jn.method=Xd,jn.methodOf=Yd,jn.mixin=$d,jn.negate=Ea,jn.nthArg=function(e){return e=rd(e),Ni((function(t){return Di(t,e)}))},jn.omit=Ed,jn.omitBy=function(e,t){return xd(e,Ea(Qo(t)))},jn.once=function(e){return Ca(2,e)},jn.orderBy=function(e,t,n,i){return null==e?[]:(Ba(t)||(t=null==t?[]:[t]),Ba(n=i?void 0:n)||(n=null==n?[]:[n]),Ai(e,t,n))},jn.over=es,jn.overArgs=Ia,jn.overEvery=ts,jn.overSome=ns,jn.partial=xa,jn.partialRight=_a,jn.partition=fa,jn.pick=Id,jn.pickBy=xd,jn.property=is,jn.propertyOf=function(e){return function(t){return null==e?void 0:mi(e,t)}},jn.pull=Vr,jn.pullAll=Hr,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?zi(e,t,Qo(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?zi(e,t,void 0,n):e},jn.pullAt=Wr,jn.range=os,jn.rangeRight=rs,jn.rearg=ja,jn.reject=function(e,t){return(Ba(e)?ct:ai)(e,Ea(Qo(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,o=[],r=e.length;for(t=Qo(t,3);++i<r;){var a=e[i];t(a,i,e)&&(n.push(a),o.push(i))}return Fi(e,o),n},jn.rest=function(e,t){if("function"!=typeof e)throw new ye(i);return Ni(e,t=void 0===t?t:rd(t))},jn.reverse=Kr,jn.sampleSize=function(e,t,n){return t=(n?lr(e,t,n):void 0===t)?1:rd(t),(Ba(e)?Vn:Vi)(e,t)},jn.set=function(e,t,n){return null==e?e:Hi(e,t,n)},jn.setWith=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:Hi(e,t,n,i)},jn.shuffle=function(e){return(Ba(e)?Hn:Zi)(e)},jn.slice=function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&lr(e,t,n)?(t=0,n=i):(t=null==t?0:rd(t),n=void 0===n?i:rd(n)),Gi(e,t,n)):[]},jn.sortBy=va,jn.sortedUniq=function(e){return e&&e.length?Yi(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?Yi(e,Qo(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&lr(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=cd(e))&&("string"==typeof t||null!=t&&!Xa(t))&&!(t=Qi(t))&&Ot(e)?po(Zt(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new ye(i);return t=null==t?0:sn(rd(t),0),Ni((function(n){var i=n[t],o=po(n,0,t);return i&&mt(o,i),ot(e,this,o)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?Gi(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?Gi(e,0,(t=n||void 0===t?1:rd(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var i=null==e?0:e.length;return i?Gi(e,(t=i-(t=n||void 0===t?1:rd(t)))<0?0:t,i):[]},jn.takeRightWhile=function(e,t){return e&&e.length?io(e,Qo(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?io(e,Qo(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var o=!0,r=!0;if("function"!=typeof e)throw new ye(i);return Ka(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),ba(e,t,{leading:o,maxWait:t,trailing:r})},jn.thru=oa,jn.toArray=id,jn.toPairs=_d,jn.toPairsIn=jd,jn.toPath=function(e){return Ba(e)?pt(e,xr):Qa(e)?[e]:So(Ir(cd(e)))},jn.toPlainObject=sd,jn.transform=function(e,t,n){var i=Ba(e),o=i||Oa(e)||ed(e);if(t=Qo(t,4),null==n){var r=e&&e.constructor;n=o?i?new r:[]:Ka(e)&&Va(r)?Rn(Ke(e)):{}}return(o?at:li)(e,(function(e,i,o){return t(n,e,i,o)})),n},jn.unary=function(e){return ya(e,1)},jn.union=Zr,jn.unionBy=Gr,jn.unionWith=Jr,jn.uniq=function(e){return e&&e.length?eo(e):[]},jn.uniqBy=function(e,t){return e&&e.length?eo(e,Qo(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?eo(e,void 0,t):[]},jn.unset=function(e,t){return null==e||to(e,t)},jn.unzip=qr,jn.unzipWith=Xr,jn.update=function(e,t,n){return null==e?e:no(e,t,co(n))},jn.updateWith=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:no(e,t,co(n),i)},jn.values=Rd,jn.valuesIn=function(e){return null==e?[]:Rt(e,wd(e))},jn.without=Yr,jn.words=Vd,jn.wrap=function(e,t){return xa(co(t),e)},jn.xor=$r,jn.xorBy=Qr,jn.xorWith=ea,jn.zip=ta,jn.zipObject=function(e,t){return ao(e||[],t||[],Kn)},jn.zipObjectDeep=function(e,t){return ao(e||[],t||[],Hi)},jn.zipWith=na,jn.entries=_d,jn.entriesIn=jd,jn.extend=ud,jn.extendWith=pd,$d(jn,jn),jn.add=ss,jn.attempt=Hd,jn.camelCase=Md,jn.capitalize=Dd,jn.ceil=cs,jn.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=dd(n))==n?n:0),void 0!==t&&(t=(t=dd(t))==t?t:0),Yn(dd(e),t,n)},jn.clone=function(e){return $n(e,4)},jn.cloneDeep=function(e){return $n(e,5)},jn.cloneDeepWith=function(e,t){return $n(e,5,t="function"==typeof t?t:void 0)},jn.cloneWith=function(e,t){return $n(e,4,t="function"==typeof t?t:void 0)},jn.conformsTo=function(e,t){return null==t||Qn(e,t,bd(t))},jn.deburr=Ad,jn.defaultTo=function(e,t){return null==e||e!=e?t:e},jn.divide=ls,jn.endsWith=function(e,t,n){e=cd(e),t=Qi(t);var i=e.length,o=n=void 0===n?i:Yn(rd(n),0,i);return(n-=t.length)>=0&&e.slice(n,o)==t},jn.eq=Ra,jn.escape=function(e){return(e=cd(e))&&L.test(e)?e.replace(z,Ft):e},jn.escapeRegExp=function(e){return(e=cd(e))&&Z.test(e)?e.replace(K,"\\$&"):e},jn.every=function(e,t,n){var i=Ba(e)?st:oi;return n&&lr(e,t,n)&&(t=void 0),i(e,Qo(t,3))},jn.find=da,jn.findIndex=Ar,jn.findKey=function(e,t){return yt(e,Qo(t,3),li)},jn.findLast=sa,jn.findLastIndex=Br,jn.findLastKey=function(e,t){return yt(e,Qo(t,3),ui)},jn.floor=us,jn.forEach=ca,jn.forEachRight=la,jn.forIn=function(e,t){return null==e?e:si(e,Qo(t,3),wd)},jn.forInRight=function(e,t){return null==e?e:ci(e,Qo(t,3),wd)},jn.forOwn=function(e,t){return e&&li(e,Qo(t,3))},jn.forOwnRight=function(e,t){return e&&ui(e,Qo(t,3))},jn.get=gd,jn.gt=Ma,jn.gte=Da,jn.has=function(e,t){return null!=e&&ar(e,t,gi)},jn.hasIn=yd,jn.head=Fr,jn.identity=Jd,jn.includes=function(e,t,n,i){e=Fa(e)?e:Rd(e),n=n&&!i?rd(n):0;var o=e.length;return n<0&&(n=sn(o+n,0)),$a(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&St(e,t,n)>-1},jn.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=null==n?0:rd(n);return o<0&&(o=sn(i+o,0)),St(e,t,o)},jn.inRange=function(e,t,n){return t=od(t),void 0===n?(n=t,t=0):n=od(n),function(e,t,n){return e>=cn(t,n)&&e<sn(t,n)}(e=dd(e),t,n)},jn.invoke=Td,jn.isArguments=Aa,jn.isArray=Ba,jn.isArrayBuffer=za,jn.isArrayLike=Fa,jn.isArrayLikeObject=La,jn.isBoolean=function(e){return!0===e||!1===e||Za(e)&&fi(e)==s},jn.isBuffer=Oa,jn.isDate=Na,jn.isElement=function(e){return Za(e)&&1===e.nodeType&&!qa(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Fa(e)&&(Ba(e)||"string"==typeof e||"function"==typeof e.splice||Oa(e)||ed(e)||Aa(e)))return!e.length;var t=rr(e);if(t==m||t==g)return!e.size;if(hr(e))return!Ei(e).length;for(var n in e)if(Pe.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return bi(e,t)},jn.isEqualWith=function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?bi(e,t,void 0,n):!!i},jn.isError=Ua,jn.isFinite=function(e){return"number"==typeof e&&rn(e)},jn.isFunction=Va,jn.isInteger=Ha,jn.isLength=Wa,jn.isMap=Ga,jn.isMatch=function(e,t){return e===t||wi(e,t,tr(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,wi(e,t,tr(t),n)},jn.isNaN=function(e){return Ja(e)&&e!=+e},jn.isNative=function(e){if(mr(e))throw new pe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Pi(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=Ja,jn.isObject=Ka,jn.isObjectLike=Za,jn.isPlainObject=qa,jn.isRegExp=Xa,jn.isSafeInteger=function(e){return Ha(e)&&e>=-9007199254740991&&e<=9007199254740991},jn.isSet=Ya,jn.isString=$a,jn.isSymbol=Qa,jn.isTypedArray=ed,jn.isUndefined=function(e){return void 0===e},jn.isWeakMap=function(e){return Za(e)&&rr(e)==T},jn.isWeakSet=function(e){return Za(e)&&"[object WeakSet]"==fi(e)},jn.join=function(e,t){return null==e?"":an.call(e,t)},jn.kebabCase=Bd,jn.last=Ur,jn.lastIndexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i;return void 0!==n&&(o=(o=rd(n))<0?sn(i+o,0):cn(o,i-1)),t==t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,o):Ct(e,bt,o,!0)},jn.lowerCase=zd,jn.lowerFirst=Fd,jn.lt=td,jn.lte=nd,jn.max=function(e){return e&&e.length?ri(e,Jd,vi):void 0},jn.maxBy=function(e,t){return e&&e.length?ri(e,Qo(t,2),vi):void 0},jn.mean=function(e){return wt(e,Jd)},jn.meanBy=function(e,t){return wt(e,Qo(t,2))},jn.min=function(e){return e&&e.length?ri(e,Jd,xi):void 0},jn.minBy=function(e,t){return e&&e.length?ri(e,Qo(t,2),xi):void 0},jn.stubArray=as,jn.stubFalse=ds,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=ms,jn.nth=function(e,t){return e&&e.length?Di(e,rd(t)):void 0},jn.noConflict=function(){return Ze._===this&&(Ze._=_e),this},jn.noop=Qd,jn.now=ga,jn.pad=function(e,t,n){e=cd(e);var i=(t=rd(t))?Kt(e):0;if(!t||i>=t)return e;var o=(t-i)/2;return Bo(tn(o),n)+e+Bo(en(o),n)},jn.padEnd=function(e,t,n){e=cd(e);var i=(t=rd(t))?Kt(e):0;return t&&i<t?e+Bo(t-i,n):e},jn.padStart=function(e,t,n){e=cd(e);var i=(t=rd(t))?Kt(e):0;return t&&i<t?Bo(t-i,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),un(cd(e).replace(G,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&lr(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=od(e),void 0===t?(t=e,e=0):t=od(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var o=pn();return cn(e+o*(t-e+Ve("1e-"+((o+"").length-1))),t)}return Li(e,t)},jn.reduce=function(e,t,n){var i=Ba(e)?ht:Et,o=arguments.length<3;return i(e,Qo(t,4),n,o,ni)},jn.reduceRight=function(e,t,n){var i=Ba(e)?ft:Et,o=arguments.length<3;return i(e,Qo(t,4),n,o,ii)},jn.repeat=function(e,t,n){return t=(n?lr(e,t,n):void 0===t)?1:rd(t),Oi(cd(e),t)},jn.replace=function(){var e=arguments,t=cd(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var i=-1,o=(t=lo(t,e)).length;for(o||(o=1,e=void 0);++i<o;){var r=null==e?void 0:e[xr(t[i])];void 0===r&&(i=o,r=n),e=Va(r)?r.call(e):r}return e},jn.round=hs,jn.runInContext=t,jn.sample=function(e){return(Ba(e)?Un:Ui)(e)},jn.size=function(e){if(null==e)return 0;if(Fa(e))return $a(e)?Kt(e):e.length;var t=rr(e);return t==m||t==g?e.size:Ei(e).length},jn.snakeCase=Ld,jn.some=function(e,t,n){var i=Ba(e)?vt:Ji;return n&&lr(e,t,n)&&(t=void 0),i(e,Qo(t,3))},jn.sortedIndex=function(e,t){return qi(e,t)},jn.sortedIndexBy=function(e,t,n){return Xi(e,t,Qo(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=qi(e,t);if(i<n&&Ra(e[i],t))return i}return-1},jn.sortedLastIndex=function(e,t){return qi(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return Xi(e,t,Qo(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=qi(e,t,!0)-1;if(Ra(e[n],t))return n}return-1},jn.startCase=Od,jn.startsWith=function(e,t,n){return e=cd(e),n=null==n?0:Yn(rd(n),0,e.length),t=Qi(t),e.slice(n,n+t.length)==t},jn.subtract=fs,jn.sum=function(e){return e&&e.length?It(e,Jd):0},jn.sumBy=function(e,t){return e&&e.length?It(e,Qo(t,2)):0},jn.template=function(e,t,n){var i=jn.templateSettings;n&&lr(e,t,n)&&(t=void 0),e=cd(e),t=pd({},t,i,Ho);var o,r,a=pd({},t.imports,i.imports,Ho),d=bd(a),s=Rt(a,d),c=0,l=t.interpolate||ce,u="__p += '",p=ve((t.escape||ce).source+"|"+l.source+"|"+(l===U?te:ce).source+"|"+(t.evaluate||ce).source+"|$","g"),m="//# sourceURL="+(Pe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Le+"]")+"\n";e.replace(p,(function(t,n,i,a,d,s){return i||(i=a),u+=e.slice(c,s).replace(le,Lt),n&&(o=!0,u+="' +\n__e("+n+") +\n'"),d&&(r=!0,u+="';\n"+d+";\n__p += '"),i&&(u+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=s+t.length,t})),u+="';\n";var h=Pe.call(t,"variable")&&t.variable;if(h){if(Q.test(h))throw new pe("Invalid `variable` option passed into `_.template`")}else u="with (obj) {\n"+u+"\n}\n";u=(r?u.replace(M,""):u).replace(D,"$1").replace(A,"$1;"),u="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}";var f=Hd((function(){return me(d,m+"return "+u).apply(void 0,s)}));if(f.source=u,Ua(f))throw f;return f},jn.times=function(e,t){if((e=rd(e))<1||e>9007199254740991)return[];var n=4294967295,i=cn(e,4294967295);e-=4294967295;for(var o=xt(i,t=Qo(t));++n<e;)t(n);return o},jn.toFinite=od,jn.toInteger=rd,jn.toLength=ad,jn.toLower=function(e){return cd(e).toLowerCase()},jn.toNumber=dd,jn.toSafeInteger=function(e){return e?Yn(rd(e),-9007199254740991,9007199254740991):0===e?e:0},jn.toString=cd,jn.toUpper=function(e){return cd(e).toUpperCase()},jn.trim=function(e,t,n){if((e=cd(e))&&(n||void 0===t))return _t(e);if(!e||!(t=Qi(t)))return e;var i=Zt(e),o=Zt(t);return po(i,Dt(i,o),At(i,o)+1).join("")},jn.trimEnd=function(e,t,n){if((e=cd(e))&&(n||void 0===t))return e.slice(0,Gt(e)+1);if(!e||!(t=Qi(t)))return e;var i=Zt(e);return po(i,0,At(i,Zt(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=cd(e))&&(n||void 0===t))return e.replace(G,"");if(!e||!(t=Qi(t)))return e;var i=Zt(e);return po(i,Dt(i,Zt(t))).join("")},jn.truncate=function(e,t){var n=30,i="...";if(Ka(t)){var o="separator"in t?t.separator:o;n="length"in t?rd(t.length):n,i="omission"in t?Qi(t.omission):i}var r=(e=cd(e)).length;if(Ot(e)){var a=Zt(e);r=a.length}if(n>=r)return e;var d=n-Kt(i);if(d<1)return i;var s=a?po(a,0,d).join(""):e.slice(0,d);if(void 0===o)return s+i;if(a&&(d+=s.length-d),Xa(o)){if(e.slice(d).search(o)){var c,l=s;for(o.global||(o=ve(o.source,cd(ne.exec(o))+"g")),o.lastIndex=0;c=o.exec(l);)var u=c.index;s=s.slice(0,void 0===u?d:u)}}else if(e.indexOf(Qi(o),d)!=d){var p=s.lastIndexOf(o);p>-1&&(s=s.slice(0,p))}return s+i},jn.unescape=function(e){return(e=cd(e))&&F.test(e)?e.replace(B,Jt):e},jn.uniqueId=function(e){var t=++ke;return cd(e)+t},jn.upperCase=Nd,jn.upperFirst=Ud,jn.each=ca,jn.eachRight=la,jn.first=Fr,$d(jn,(ps={},li(jn,(function(e,t){Pe.call(jn.prototype,t)||(ps[t]=e)})),ps),{chain:!1}),jn.VERSION="4.17.21",at(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),at(["drop","take"],(function(e,t){An.prototype[e]=function(n){n=void 0===n?1:sn(rd(n),0);var i=this.__filtered__&&!t?new An(this):this.clone();return i.__filtered__?i.__takeCount__=cn(n,i.__takeCount__):i.__views__.push({size:cn(n,4294967295),type:e+(i.__dir__<0?"Right":"")}),i},An.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),at(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;An.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Qo(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}})),at(["head","last"],(function(e,t){var n="take"+(t?"Right":"");An.prototype[e]=function(){return this[n](1).value()[0]}})),at(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");An.prototype[e]=function(){return this.__filtered__?new An(this):this[n](1)}})),An.prototype.compact=function(){return this.filter(Jd)},An.prototype.find=function(e){return this.filter(e).head()},An.prototype.findLast=function(e){return this.reverse().find(e)},An.prototype.invokeMap=Ni((function(e,t){return"function"==typeof e?new An(this):this.map((function(n){return Si(n,e,t)}))})),An.prototype.reject=function(e){return this.filter(Ea(Qo(e)))},An.prototype.slice=function(e,t){e=rd(e);var n=this;return n.__filtered__&&(e>0||t<0)?new An(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=rd(t))<0?n.dropRight(-t):n.take(t-e)),n)},An.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},An.prototype.toArray=function(){return this.take(4294967295)},li(An.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=jn[i?"take"+("last"==t?"Right":""):t],r=i||/^find/.test(t);o&&(jn.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,d=t instanceof An,s=a[0],c=d||Ba(t),l=function(e){var t=o.apply(jn,mt([e],a));return i&&u?t[0]:t};c&&n&&"function"==typeof s&&1!=s.length&&(d=c=!1);var u=this.__chain__,p=!!this.__actions__.length,m=r&&!u,h=d&&!p;if(!r&&c){t=h?t:new An(this);var f=e.apply(t,a);return f.__actions__.push({func:oa,args:[l],thisArg:void 0}),new Dn(f,u)}return m&&h?e.apply(this,a):(f=this.thru(l),m?i?f.value()[0]:f.value():f)})})),at(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ce[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var o=this.value();return t.apply(Ba(o)?o:[],e)}return this[n]((function(n){return t.apply(Ba(n)?n:[],e)}))}})),li(An.prototype,(function(e,t){var n=jn[t];if(n){var i=n.name+"";Pe.call(Tn,i)||(Tn[i]=[]),Tn[i].push({name:t,func:n})}})),Tn[Ro(void 0,2).name]=[{name:"wrapper",func:void 0}],An.prototype.clone=function(){var e=new An(this.__wrapped__);return e.__actions__=So(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=So(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=So(this.__views__),e},An.prototype.reverse=function(){if(this.__filtered__){var e=new An(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},An.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ba(e),i=t<0,o=n?e.length:0,r=function(e,t,n){var i=-1,o=n.length;for(;++i<o;){var r=n[i],a=r.size;switch(r.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=cn(t,e+a);break;case"takeRight":e=sn(e,t-a)}}return{start:e,end:t}}(0,o,this.__views__),a=r.start,d=r.end,s=d-a,c=i?d:a-1,l=this.__iteratees__,u=l.length,p=0,m=cn(s,this.__takeCount__);if(!n||!i&&o==s&&m==s)return oo(e,this.__actions__);var h=[];e:for(;s--&&p<m;){for(var f=-1,v=e[c+=t];++f<u;){var g=l[f],y=g.iteratee,C=g.type,S=y(v);if(2==C)v=S;else if(!S){if(1==C)continue e;break e}}h[p++]=v}return h},jn.prototype.at=ra,jn.prototype.chain=function(){return ia(this)},jn.prototype.commit=function(){return new Dn(this.value(),this.__chain__)},jn.prototype.next=function(){void 0===this.__values__&&(this.__values__=id(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof Mn;){var i=jr(n);i.__index__=0,i.__values__=void 0,t?o.__wrapped__=i:t=i;var o=i;n=n.__wrapped__}return o.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof An){var t=e;return this.__actions__.length&&(t=new An(this)),(t=t.reverse()).__actions__.push({func:oa,args:[Kr],thisArg:void 0}),new Dn(t,this.__chain__)}return this.thru(Kr)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return oo(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,gt&&(jn.prototype[gt]=function(){return this}),jn}();Je?((Je.exports=qt)._=qt,Ge._=qt):Ze._=qt}).call(C)}));var T=function(){function e(t,i){n(this,e),this.id=i,this.jSPlugin=t,this.state={play:!1,loading:!1}}return o(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"setPlayStatus",value:function(e){this.state=Object.assign(this.state,e)}},{key:"loadingStart",value:function(e){var t=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(t),t.innerHTML="@keyframes antRotate {to {transform: rotate(400deg);transform-origin:50% 50%;}} .loading {display: inline-block;z-index: 1000;-webkit-animation: antRotate 1s infinite linear;animation: antRotate 1s infinite linear;}";var n=e,i=document.getElementById(n),o=i.offsetWidth,r=i.offsetHeight,a=i.offsetLeft;document.getElementById("".concat(e,"-loading-id-0"))&&document.getElementById("".concat(e,"-loading-id-0")).parentNode.removeChild(document.getElementById("".concat(e,"-loading-id-0")));var d=document.createElement("div");d.setAttribute("id","".concat(e,"-loading-id-0"));var s,c,l,u="position:absolute;outline:none;pointer-events:none;";console.log("this.jSPlugin",this.jSPlugin),u+="width: 100%;background-size: cover; background-repeat:no-repeat;",u+="height: 100%;",u+="top:0;",u+="left:"+a+"px;",d.setAttribute("style",u),d.style.height=r,d.setAttribute("class","loading-container"),s=d,(l=(c=i).parentNode).lastChild==c?l.appendChild(s):l.insertBefore(s,c.nextSibling);var p=document.createElement("div"),m=document.createElement("div");p.setAttribute("class","loading-item"),p.setAttribute("id","".concat(e,"-loading-item-0"));u="display:inline-flex;pointer-events:none;flex-direction:column;justify-content:center;align-items: center;width:100%;height:"+r+"px;outline:none;vertical-align: top;position:absolute;";function h(e,t,n,i){return{top:parseInt(i/n,10)*(e/n),left:i%n*(t/n)}}u+="left:"+h(r,o,1,0).left+"px;",u+="top:"+h(r,o,1,0).top+"px;",p.setAttribute("style",u);var f=document.createElement("div");m.innerHTML="",m.style.color="#fff",f.setAttribute("class","loading");f.innerHTML='<svg t="1567069979438" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2399" width="32" height="32"><path d="M538.5344 266.4448a133.12 133.12 0 1 1 133.12-133.12 133.4272 133.4272 0 0 1-133.12 133.12zM255.0144 372.1984a121.6768 121.6768 0 1 1 121.6768-121.6768 121.856 121.856 0 0 1-121.6768 121.6768zM134.72 647.424a107.3664 107.3664 0 1 1 107.3664-107.264A107.52 107.52 0 0 1 134.72 647.424z m120.32 272.4608a90.9824 90.9824 0 1 1 90.9824-90.9824A91.1616 91.1616 0 0 1 255.04 919.8848zM538.5344 1024a79.36 79.36 0 1 1 79.36-79.36 79.36 79.36 0 0 1-79.36 79.36z m287.6928-134.144a64.1792 64.1792 0 1 1 64.1792-64.1792 64.3584 64.3584 0 0 1-64.1792 64.1792z m117.76-296.704a52.6336 52.6336 0 1 1 52.6592-52.6336 52.608 52.608 0 0 1-52.6336 52.6336z m-158.72-338.7136a40.96 40.96 0 1 1 12.0064 28.8512 40.5248 40.5248 0 0 1-12.0064-28.8512z" fill="#ffffff" p-id="2400"></path></svg>',p.appendChild(f),p.appendChild(m),d.appendChild(p)}},{key:"loadingSetText",value:function(e){if(this.loadingClearText(),document.getElementById("".concat(this.id,"-loading-item-0"))){var t=document.getElementById("".concat(this.id,"-loading-item-0")).childNodes[1];if(!t){var n=document.getElementById("".concat(this.id,"-loading-item-0"));(t=document.createElement("div")).innerHTML=e.text,n.appendChild(t)}t.innerHTML=e.text,t.style.fontSize="14px",t.style.color=e.color||"#FFFFFF"}}},{key:"loadingClearText",value:function(){if(document.getElementById("".concat(this.id,"-loading-item-0"))){var e=document.getElementById("".concat(this.id,"-loading-item-0")).childNodes;e.length>1?e[1].parentNode.removeChild(e[1]):e[0]&&e[0].parentNode.removeChild(e[0])}}},{key:"loadingClear",value:function(){if(document.getElementById("".concat(this.id,"-loading-item-0"))){for(var e=document.getElementById("".concat(this.id,"-loading-item-0")).childNodes,t=e.length-1;t>=0;t--)e[t].parentNode.removeChild(e[t]);document.getElementById("".concat(this.id,"-loading-id-0"))&&(document.getElementById("".concat(this.id,"-loading-id-0")).style.background="none")}}},{key:"loadingEnd",value:function(){var e=document.getElementById("".concat(this.id,"-loading-item-0"));if(e){e.parentNode.removeChild(e);var t=document.getElementById("".concat(this.id,"-loading-id-0"));t&&0===t.children.length&&t.parentNode.removeChild(t)}document.getElementById("".concat(this.id,"-loading-item-0")).style.background="none"}}]),e}(),b=function(){function e(t,i){n(this,e),this.id=i,this.jSPlugin=t,this.timer=null,this.state={play:!1,loading:!1}}return o(e,[{key:"default",value:function(e){var t=this;document.getElementById("".concat(this.id,"-").concat("msgId"))&&document.getElementById("".concat(this.id,"-wrap")).removeChild(document.getElementById("".concat(this.id,"-").concat("msgId")));var n=document.createElement("div");n.id="".concat(this.id,"-").concat("msgId"),n.style="position: absolute;top: 50%;left:calc(50% - ".concat(14*e.length/2,"px);padding: 4px 16px;background: #00000080;color: #FFFFFF;font-size: 14px"),n.innerHTML=e,document.getElementById("".concat(this.id,"-wrap")).appendChild(n),this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){document.getElementById("".concat(t.id,"-wrap")).removeChild(document.getElementById("".concat(t.id,"-").concat("msgId")))}),2e3)}}]),e}(),w={data:[{moduleCode:"",detailCode:"405984",description:"",solution:"",updateTime:1559564188e3},{moduleCode:"",detailCode:"10035",description:"获取子账户AccessToken异常,子账户不存在或子账户不属于该开发者",solution:"",updateTime:1559551958e3},{moduleCode:"",detailCode:"1052674",description:"获取本地录像失败",solution:"",updateTime:1558579653e3},{moduleCode:"",detailCode:"395547",description:"",solution:"",updateTime:1557367296e3},{moduleCode:"",detailCode:"12",description:"",solution:"",updateTime:1557229476e3},{moduleCode:"",detailCode:"10052",description:"余额不足",solution:"",updateTime:1557121463e3},{moduleCode:"",detailCode:"20108",description:"当前用户和所添加用户不是好友关系",solution:"",updateTime:1556541725e3},{moduleCode:"",detailCode:"10009",description:"",solution:"",updateTime:1556422452e3},{moduleCode:"",detailCode:"320001",description:"通道不存在",solution:"请检查录像机的关联状态是否正常，没有摄像头的通道无法播放",updateTime:1556419044e3},{moduleCode:"",detailCode:"120001",description:"通道不存在",solution:"请检查录像机的关联状态是否正常，没有摄像头的通道无法播放",updateTime:155641903e4},{moduleCode:"",detailCode:"320049",description:"",solution:"",updateTime:1556272984e3},{moduleCode:"",detailCode:"380227",description:"",solution:"",updateTime:1556264379e3},{moduleCode:"",detailCode:"10033",description:"policy参数信息异常",solution:"",updateTime:1555922124e3},{moduleCode:"",detailCode:"10065",description:"weakAppKey 不属于accessToken对应的用户",solution:"",updateTime:1555497522e3},{moduleCode:"",detailCode:"395416",description:"设备达到最大连接数，无法建立连接",solution:"请升级设备固件版本",updateTime:1555394722e3},{moduleCode:"",detailCode:"100001",description:"",solution:"",updateTime:1555141776e3},{moduleCode:"",detailCode:"395558",description:"",solution:"",updateTime:1554987121e3},{moduleCode:"",detailCode:"70001",description:"智能家居买断用户设备受到限制,建议合理选择pagestart和pageSize",solution:"",updateTime:1554691023e3},{moduleCode:"",detailCode:"170001",description:"",solution:"",updateTime:1554691023e3},{moduleCode:"",detailCode:"1012",description:"重置失败",solution:"",updateTime:1554645841e3},{moduleCode:"",detailCode:"1043",description:"重置失败",solution:"",updateTime:1554645834e3},{moduleCode:"",detailCode:"60060",description:"直播功能未开通",solution:"通道未开通直播功能，请先开通直播",updateTime:1554346018e3},{moduleCode:"",detailCode:"380203",description:"",solution:"",updateTime:1554093666e3},{moduleCode:"",detailCode:"399048",description:"免费版并发数达到上限，请升级企业版使用多并发能力",solution:"升级成为企业版套餐即可取消并发数限制",updateTime:1553839878e3},{moduleCode:"",detailCode:"60007",description:"预置点个数超过最大值",solution:"",updateTime:1553671316e3},{moduleCode:"",detailCode:"1005",description:"",solution:"",updateTime:1553513701e3},{moduleCode:"",detailCode:"20605",description:"其他用户正在认证中",solution:"",updateTime:1552976317e3},{moduleCode:"",detailCode:"90004",description:"当前型号设备暂时不支持AI任务：CS-C3W-3B1WFR-YGL",solution:"",updateTime:1552898525e3},{moduleCode:"",detailCode:"60046",description:"添加的设备的IP和本设备的IP冲突",solution:"",updateTime:1552872372e3},{moduleCode:"",detailCode:"3",description:"修改视频清晰度失败!",solution:"",updateTime:1552440229e3},{moduleCode:"",detailCode:"1013",description:"",solution:"",updateTime:1552035069e3},{moduleCode:"",detailCode:"370007",description:"",solution:"",updateTime:1551852327e3},{moduleCode:"",detailCode:"-1",description:"",solution:"",updateTime:1551752889e3},{moduleCode:"",detailCode:"30005",description:"弱账户不存在",solution:"",updateTime:1551422358e3},{moduleCode:"",detailCode:"90006",description:"用户操作AI任务受限",solution:"",updateTime:155107332e4},{moduleCode:"",detailCode:"60203",description:"未开通相关服务",solution:"",updateTime:155062307e4},{moduleCode:"",detailCode:"10002",description:"accessToken过期或异常",solution:"",updateTime:1550300346e3},{moduleCode:"",detailCode:"380339",description:"",solution:"",updateTime:1549889458e3},{moduleCode:"",detailCode:"90002",description:"AI任务设备配置数达到上限：3",solution:"",updateTime:1549071664e3},{moduleCode:"",detailCode:"380008",description:"",solution:"",updateTime:1549005979e3},{moduleCode:"",detailCode:"320227",description:"",solution:"",updateTime:1548739731e3},{moduleCode:"",detailCode:"60059",description:"ezopen地址均不可用",solution:"",updateTime:154839535e4},{moduleCode:"",detailCode:"10005",description:"appKey异常",solution:"",updateTime:1548317858e3},{moduleCode:"",detailCode:"60045",description:"添加的设备的IP和其他通道的IP冲突",solution:"",updateTime:1548155085e3},{moduleCode:"",detailCode:"60047",description:"码流类型不支持",solution:"",updateTime:1547962108e3},{moduleCode:"",detailCode:"60041",description:"添加的设备被其他设备关联或响应超时",solution:"",updateTime:154796098e4},{moduleCode:"",detailCode:"110029",description:"个人用户接口调用频率超限",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1547606859e3},{moduleCode:"",detailCode:"380355",description:"设备直连推流异常结束",solution:"",updateTime:1547106294e3},{moduleCode:"",detailCode:"320081",description:"",solution:"",updateTime:1547106279e3},{moduleCode:"",detailCode:"60035",description:"购买云存储服务失败",solution:"",updateTime:1547026959e3},{moduleCode:"",detailCode:"90005",description:"设备已存在：C75714141",solution:"",updateTime:1546940622e3},{moduleCode:"",detailCode:"1053445",description:"该时间段没有录像片段",solution:"",updateTime:1546935727e3},{moduleCode:"",detailCode:"90007",description:"设备未加入到AI任务",solution:"",updateTime:1546932948e3},{moduleCode:"",detailCode:"326000",description:"",solution:"",updateTime:1546823143e3},{moduleCode:"",detailCode:"1021",description:"重置失败",solution:"",updateTime:1546781152e3},{moduleCode:"",detailCode:"2001",description:"删除设备失败!",solution:"",updateTime:1546422886e3},{moduleCode:"",detailCode:"380425",description:"",solution:"",updateTime:1546407694e3},{moduleCode:"",detailCode:"120097",description:"",solution:"",updateTime:1546085995e3},{moduleCode:"",detailCode:"10059",description:"requestId已存在",solution:"",updateTime:1545824509e3},{moduleCode:"",detailCode:"1154723",description:"",solution:"",updateTime:1545795209e3},{moduleCode:"",detailCode:"60043",description:"添加的设备超出最大数量",solution:"",updateTime:1545493607e3},{moduleCode:"",detailCode:"1152677",description:"",solution:"",updateTime:1545313404e3},{moduleCode:"",detailCode:"20097",description:"设备添加异常,设备验证码为ABCDEF或设备被N1，R1关联",solution:"",updateTime:1545310795e3},{moduleCode:"",detailCode:"10060",description:"设备不支持该云存储类型",solution:"",updateTime:1545309064e3},{moduleCode:"",detailCode:"20102",description:"无相应邀请信息，无法接受邀请",solution:"",updateTime:1545204966e3},{moduleCode:"",detailCode:"10053",description:"云存储开通中",solution:"",updateTime:1545100293e3},{moduleCode:"",detailCode:"20401",description:"用户云空间信息不存在",solution:"",updateTime:154501788e4},{moduleCode:"",detailCode:"20600",description:"临时密码数已达上限",solution:"",updateTime:1544873457e3},{moduleCode:"",detailCode:"901",description:"",solution:"",updateTime:1544693519e3},{moduleCode:"",detailCode:"60210",description:"图片数据错误",solution:"",updateTime:1544604457e3},{moduleCode:"",detailCode:"10013",description:"您的应用没有权限调用",solution:"",updateTime:1544416237e3},{moduleCode:"",detailCode:"70007",description:"授权码不存在",solution:"",updateTime:1544179533e3},{moduleCode:"",detailCode:"10015",description:"授权地址不存在",solution:"",updateTime:154416324e4},{moduleCode:"",detailCode:"320423",description:"",solution:"",updateTime:1544100685e3},{moduleCode:"",detailCode:"370009",description:"",solution:"",updateTime:1544077151e3},{moduleCode:"",detailCode:"10031",description:"子账户或萤石用户没有权限",solution:"",updateTime:1543990462e3},{moduleCode:"",detailCode:"10055",description:"设备不支持试用云存储服务",solution:"",updateTime:1543986292e3},{moduleCode:"",detailCode:"60042",description:"添加的设备密码错误",solution:"",updateTime:1543710913e3},{moduleCode:"",detailCode:"60082",description:"设备正在响应本次声源定位",solution:"",updateTime:1543647426e3},{moduleCode:"",detailCode:"10056",description:"设备不支持云存储服务转出",solution:"",updateTime:1543558342e3},{moduleCode:"",detailCode:"20104",description:"好友不存在",solution:"",updateTime:1543492403e3},{moduleCode:"",detailCode:"20111",description:"好友不是等待验证状态，无法接受邀请",solution:"",updateTime:1543492365e3},{moduleCode:"",detailCode:"20107",description:"不能添加自己为好友",solution:"",updateTime:1543480986e3},{moduleCode:"",detailCode:"1",description:"设备返回其他错误",solution:"",updateTime:1543459921e3},{moduleCode:"",detailCode:"60084",description:"当前正在关闭隐私遮蔽",solution:"",updateTime:1543456515e3},{moduleCode:"",detailCode:"380255",description:"",solution:"",updateTime:1543411652e3},{moduleCode:"",detailCode:"20015",description:"设备不支持",solution:"",updateTime:1543390936e3},{moduleCode:"",detailCode:"30003",description:"手机验证码错误",solution:"",updateTime:1543389137e3},{moduleCode:"",detailCode:"20615",description:"锁用户已存在",solution:"",updateTime:1543388325e3},{moduleCode:"",detailCode:"60061",description:"账户流量已超出或未购买，限制开通",solution:"",updateTime:1543372581e3},{moduleCode:"",detailCode:"60020",description:"设备不支持该信令",solution:"",updateTime:1543321636e3},{moduleCode:"",detailCode:"320146",description:"",solution:"",updateTime:1543318472e3},{moduleCode:"",detailCode:"60018",description:"设备升级失败",solution:"",updateTime:1543304928e3},{moduleCode:"",detailCode:"60044",description:"添加的设备网络不可达超时",solution:"",updateTime:1543304102e3},{moduleCode:"",detailCode:"20619",description:"主用户无法删除",solution:"",updateTime:1543290219e3},{moduleCode:"",detailCode:"20608",description:"锁用户不存在",solution:"",updateTime:154328195e4},{moduleCode:"",detailCode:"20609",description:"设备响应超时,门锁通信故障或者电量不足,请重试.",solution:"",updateTime:1543281601e3},{moduleCode:"",detailCode:"1049954",description:"升级设备失败",solution:"",updateTime:1543279264e3},{moduleCode:"",detailCode:"60009",description:"正在调用预置点",solution:"",updateTime:1543238114e3},{moduleCode:"",detailCode:"1052677",description:"获取本地录像失败",solution:"",updateTime:1543207604e3},{moduleCode:"",detailCode:"327000",description:"",solution:"",updateTime:1543196609e3},{moduleCode:"",detailCode:"20021",description:"设备在线，未被用户添加",solution:"",updateTime:1543193436e3},{moduleCode:"",detailCode:"20202",description:"操作留言信息失败",solution:"",updateTime:1543191562e3},{moduleCode:"",detailCode:"1052678",description:"获取本地录像失败",solution:"",updateTime:1543132218e3},{moduleCode:"",detailCode:"1054723",description:"格式化设备失败",solution:"",updateTime:1543129833e3},{moduleCode:"",detailCode:"20109",description:"对应分享不存在",solution:"",updateTime:1543129111e3},{moduleCode:"",detailCode:"60026",description:"设备处于隐私遮蔽状态",solution:"",updateTime:1543110403e3},{moduleCode:"",detailCode:"60083",description:"当前正在开启隐私遮蔽",solution:"",updateTime:1543071148e3},{moduleCode:"",detailCode:"60001",description:"用户无云台控制权限",solution:"",updateTime:1543059167e3},{moduleCode:"",detailCode:"2003",description:"设备不在线",solution:"",updateTime:1543051046e3},{moduleCode:"",detailCode:"-24",description:"设置设备enable错误",solution:"",updateTime:1543042701e3},{moduleCode:"",detailCode:"10018",description:"",solution:"",updateTime:1543041564e3},{moduleCode:"",detailCode:"20103",description:"好友已存在",solution:"",updateTime:154303843e4},{moduleCode:"",detailCode:"70010",description:"授权异常请重试",solution:"",updateTime:154303559e4},{moduleCode:"",detailCode:"60056",description:"删除设备失败",solution:"",updateTime:1543031275e3},{moduleCode:"",detailCode:"60040",description:"添加的设备不在同一局域网",solution:"",updateTime:154303121e4},{moduleCode:"",detailCode:"60019",description:"加密已开启",solution:"",updateTime:1543029931e3},{moduleCode:"",detailCode:"1054722",description:"格式化设备失败",solution:"",updateTime:1543028537e3},{moduleCode:"",detailCode:"20016",description:"当前设备正在格式化",solution:"",updateTime:1543028537e3},{moduleCode:"",detailCode:"10024",description:"透明通道权限校验不通过",solution:"",updateTime:154302554e4},{moduleCode:"",detailCode:"6002",description:"删除设备失败!",solution:"",updateTime:1543025026e3},{moduleCode:"",detailCode:"1011",description:"验证码错误！",solution:"",updateTime:1543016865e3},{moduleCode:"",detailCode:"60032",description:"卡密已使用",solution:"",updateTime:1543006668e3},{moduleCode:"",detailCode:"10034",description:"子账号已存在",solution:"",updateTime:1542989194e3},{moduleCode:"",detailCode:"20301",description:"根据uuid查询联动信息不存在",solution:"",updateTime:1542988651e3},{moduleCode:"",detailCode:"1041",description:"获取验证码过于频繁",solution:"",updateTime:1542980953e3},{moduleCode:"",detailCode:"10012",description:"该appkey下已绑定重复的phone！",solution:"",updateTime:15429808e5},{moduleCode:"",detailCode:"1008",description:"phone不合法！",solution:"",updateTime:1542979812e3},{moduleCode:"",detailCode:"60023",description:"订阅操作失败",solution:"",updateTime:1542979006e3},{moduleCode:"",detailCode:"5",description:"设备返回其他错误",solution:"",updateTime:1542977828e3},{moduleCode:"",detailCode:"60006",description:"云台当前操作失败",solution:"",updateTime:1542977598e3},{moduleCode:"",detailCode:"131",description:"修改视频清晰度失败!",solution:"",updateTime:1542977246e3},{moduleCode:"",detailCode:"10019",description:"密码错误",solution:"",updateTime:1542976628e3},{moduleCode:"",detailCode:"10004",description:"用户不存在",solution:"",updateTime:1542976268e3},{moduleCode:"",detailCode:"20201",description:"操作报警信息失败",solution:"",updateTime:1542975906e3},{moduleCode:"",detailCode:"20024",description:"设备不在线，已经被别的用户添加",solution:"",updateTime:1542975858e3},{moduleCode:"",detailCode:"60004",description:"设备云台旋转达到左限位",solution:"",updateTime:1542975207e3},{moduleCode:"",detailCode:"1052679",description:"修改视频清晰度失败!",solution:"",updateTime:1542974886e3},{moduleCode:"",detailCode:"20031",description:"请在萤石客户端关闭终端绑定",solution:"",updateTime:1542974756e3},{moduleCode:"",detailCode:"1053825",description:"获取本地录像失败",solution:"",updateTime:1542974692e3},{moduleCode:"",detailCode:"60011",description:"预置点不存在",solution:"",updateTime:1542974414e3},{moduleCode:"",detailCode:"1052936",description:"修改视频清晰度失败!",solution:"",updateTime:154297439e4},{moduleCode:"",detailCode:"1016",description:"",solution:"",updateTime:1542974273e3},{moduleCode:"",detailCode:"10032",description:"子账号不存在",solution:"",updateTime:1542973906e3},{moduleCode:"",detailCode:"20013",description:"设备已被别人添加",solution:"",updateTime:1542973817e3},{moduleCode:"",detailCode:"50000",description:"服务器错误!",solution:"",updateTime:1542973801e3},{moduleCode:"",detailCode:"60010",description:"该预置点已经是当前位置",solution:"",updateTime:15429738e5},{moduleCode:"",detailCode:"60003",description:"设备云台旋转达到下限位",solution:"",updateTime:154297377e4},{moduleCode:"",detailCode:"4",description:"设备返回其他错误",solution:"",updateTime:1542973755e3},{moduleCode:"",detailCode:"60016",description:"加密未开启，无需关闭",solution:"",updateTime:1542973753e3},{moduleCode:"",detailCode:"60002",description:"设备云台旋转达到上限位",solution:"",updateTime:1542973742e3},{moduleCode:"",detailCode:"20023",description:"设备不在线，未被用户添加",solution:"",updateTime:1542973685e3},{moduleCode:"",detailCode:"10008",description:"",solution:"",updateTime:1542973676e3},{moduleCode:"",detailCode:"20010",description:"设备验证码错误",solution:"",updateTime:1542973658e3},{moduleCode:"",detailCode:"60005",description:"设备云台旋转达到右限位",solution:"",updateTime:1542973657e3},{moduleCode:"",detailCode:"20017",description:"设备已经被自己添加",solution:"",updateTime:1542973648e3},{moduleCode:"",detailCode:"20020",description:"设备在线，已经被自己添加",solution:"",updateTime:1542973533e3},{moduleCode:"",detailCode:"20029",description:"设备不在线，已经被自己添加",solution:"",updateTime:154297353e4},{moduleCode:"",detailCode:"10014",description:"APPKEY下对应的第三方userId和phone未绑定！",solution:"",updateTime:1542973499e3},{moduleCode:"",detailCode:"20002",description:"设备不存在",solution:"",updateTime:1542973499e3},{moduleCode:"",detailCode:"10030",description:"appkey和appsecret不匹配",solution:"",updateTime:154297349e4},{moduleCode:"",detailCode:"20022",description:"设备在线，已经被别的用户添加",solution:"",updateTime:1542973486e3},{moduleCode:"",detailCode:"20008",description:"设备响应超时",solution:"",updateTime:1542973484e3},{moduleCode:"",detailCode:"20032",description:"该用户下通道不存在",solution:"",updateTime:1542973481e3},{moduleCode:"",detailCode:"20006",description:"网络异常",solution:"",updateTime:1542973475e3},{moduleCode:"",detailCode:"20014",description:"deviceSerial不合法!",solution:"",updateTime:1542973454e3},{moduleCode:"",detailCode:"20007",description:"设备不在线",solution:"",updateTime:1542973454e3},{moduleCode:"",detailCode:"20018",description:"该用户不拥有该设备",solution:"",updateTime:1542973453e3},{moduleCode:"",detailCode:"10010",description:"",solution:"",updateTime:1542973453e3},{moduleCode:"",detailCode:"10011",description:"未绑定！",solution:"",updateTime:1542973453e3},{moduleCode:"",detailCode:"20001",description:"通道不存在!",solution:"",updateTime:1542973452e3},{moduleCode:"",detailCode:"10017",description:"appKey不存在",solution:"",updateTime:1542973451e3},{moduleCode:"",detailCode:"400259",description:"",solution:"",updateTime:1542875643e3},{moduleCode:"",detailCode:"400004",description:"",solution:"",updateTime:1542873364e3},{moduleCode:"",detailCode:"3840",description:"",solution:"",updateTime:154186e7},{moduleCode:"",detailCode:"-1017",description:"",solution:"",updateTime:1541733663e3},{moduleCode:"",detailCode:"320025",description:"",solution:"",updateTime:1541078281e3},{moduleCode:"",detailCode:"320024",description:"",solution:"",updateTime:1540801374e3},{moduleCode:"",detailCode:"321002",description:"",solution:"",updateTime:1540631734e3},{moduleCode:"",detailCode:"321000",description:"",solution:"",updateTime:1540609178e3},{moduleCode:"",detailCode:"321022",description:"",solution:"",updateTime:1540548345e3},{moduleCode:"",detailCode:"321016",description:"",solution:"",updateTime:1540287187e3},{moduleCode:"",detailCode:"320023",description:"",solution:"",updateTime:1539825993e3},{moduleCode:"",detailCode:"-1016",description:"",solution:"",updateTime:1539584931e3},{moduleCode:"",detailCode:"8",description:"",solution:"",updateTime:1539391812e3},{moduleCode:"",detailCode:"1075127593",description:"",solution:"",updateTime:1538959251e3},{moduleCode:"",detailCode:"380421",description:"",solution:"",updateTime:1537288465e3},{moduleCode:"",detailCode:"322000",description:"麦克风权限未开启",solution:"",updateTime:1536820136e3},{moduleCode:"",detailCode:"1152678",description:"",solution:"",updateTime:1536738348e3},{moduleCode:"",detailCode:"320047",description:"",solution:"",updateTime:1536664472e3},{moduleCode:"",detailCode:"327006",description:"",solution:"",updateTime:153613612e4},{moduleCode:"",detailCode:"1074807593",description:"",solution:"",updateTime:1536135035e3},{moduleCode:"",detailCode:"320291",description:"",solution:"",updateTime:1536110836e3},{moduleCode:"",detailCode:"320045",description:"",solution:"",updateTime:1535963775e3},{moduleCode:"",detailCode:"370004",description:"",solution:"",updateTime:1535883699e3},{moduleCode:"",detailCode:"1149954",description:"",solution:"",updateTime:1535700674e3},{moduleCode:"",detailCode:"320053",description:"",solution:"",updateTime:1535681079e3},{moduleCode:"",detailCode:"400000",description:"",solution:"",updateTime:1535532332e3},{moduleCode:"",detailCode:"110028",description:"个人版抓图接口日调用次数超出限制",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1535348756e3},{moduleCode:"",detailCode:"110027",description:"个人版帐号数量超出安全限制，无法调用",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1535348734e3},{moduleCode:"",detailCode:"110026",description:"设备数量超出个人版限制，当前设备无法操作",solution:"请升级企业版：https://open.ys7.com/price.html",updateTime:1535348588e3},{moduleCode:"",detailCode:"100000",description:"",solution:"",updateTime:1534980008e3},{moduleCode:"",detailCode:"324004",description:"",solution:"",updateTime:1534927762e3},{moduleCode:"",detailCode:"360104",description:"",solution:"",updateTime:1534761006e3},{moduleCode:"",detailCode:"320204",description:"",solution:"",updateTime:1534584221e3},{moduleCode:"",detailCode:"380001",description:"",solution:"",updateTime:1534404715e3},{moduleCode:"",detailCode:"380204",description:"",solution:"",updateTime:1534401682e3},{moduleCode:"",detailCode:"328006",description:"",solution:"",updateTime:1534144407e3},{moduleCode:"",detailCode:"321703",description:"",solution:"",updateTime:1534127274e3},{moduleCode:"",detailCode:"321510",description:"",solution:"",updateTime:1533428892e3},{moduleCode:"",detailCode:"321006",description:"",solution:"",updateTime:1533036916e3},{moduleCode:"",detailCode:"50009",description:"",solution:"",updateTime:1532078548e3},{moduleCode:"",detailCode:"50007",description:"",solution:"",updateTime:153199172e4},{moduleCode:"",detailCode:"50018",description:"",solution:"",updateTime:1531912829e3},{moduleCode:"",detailCode:"380451",description:"",solution:"",updateTime:15316157e5},{moduleCode:"",detailCode:"380336",description:"",solution:"",updateTime:1531231721e3},{moduleCode:"",detailCode:"360020",description:"",solution:"",updateTime:1531117554e3},{moduleCode:"",detailCode:"380418",description:"",solution:"",updateTime:153110707e4},{moduleCode:"",detailCode:"1153445",description:"设备在该时间段内没有录像",solution:"",updateTime:1530944007e3},{moduleCode:"",detailCode:"110007",description:"调用接口总次数达到上限",solution:"请升级企业版，获取更高能力",updateTime:1530935584e3},{moduleCode:"",detailCode:"360019",description:"",solution:"",updateTime:1530869771e3},{moduleCode:"",detailCode:"360100",description:"",solution:"",updateTime:1530786188e3},{moduleCode:"",detailCode:"380042",description:"",solution:"",updateTime:1530775199e3},{moduleCode:"",detailCode:"320355",description:"",solution:"",updateTime:1530716074e3},{moduleCode:"",detailCode:"100003",description:"",solution:"",updateTime:1530232541e3},{moduleCode:"",detailCode:"371026",description:"",solution:"",updateTime:15301926e5},{moduleCode:"",detailCode:"102",description:"",solution:"",updateTime:1529895641e3},{moduleCode:"",detailCode:"380201",description:"",solution:"",updateTime:1529740929e3},{moduleCode:"",detailCode:"320054",description:"",solution:"",updateTime:1529544875e3},{moduleCode:"",detailCode:"500101",description:"",solution:"",updateTime:1529485953e3},{moduleCode:"",detailCode:"321001",description:"",solution:"",updateTime:1529411048e3},{moduleCode:"",detailCode:"321508",description:"",solution:"",updateTime:1529393279e3},{moduleCode:"",detailCode:"405991",description:"",solution:"",updateTime:1529380238e3},{moduleCode:"",detailCode:"380461",description:"",solution:"",updateTime:1529130941e3},{moduleCode:"",detailCode:"-1019",description:"",solution:"",updateTime:1529057245e3},{moduleCode:"",detailCode:"322009",description:"",solution:"",updateTime:1528965717e3},{moduleCode:"",detailCode:"324005",description:"",solution:"",updateTime:1528950153e3},{moduleCode:"",detailCode:"325000",description:"",solution:"",updateTime:1528947143e3},{moduleCode:"",detailCode:"326032",description:"",solution:"",updateTime:1528872971e3},{moduleCode:"",detailCode:"325032",description:"",solution:"",updateTime:1528863189e3},{moduleCode:"",detailCode:"328000",description:"",solution:"",updateTime:1528794505e3},{moduleCode:"",detailCode:"53",description:"",solution:"",updateTime:1528693249e3},{moduleCode:"",detailCode:"-1020",description:"",solution:"",updateTime:152849944e4},{moduleCode:"",detailCode:"329032",description:"",solution:"",updateTime:1528446301e3},{moduleCode:"",detailCode:"-1202",description:"",solution:"",updateTime:152843982e4},{moduleCode:"",detailCode:"2",description:"",solution:"",updateTime:1528434175e3},{moduleCode:"",detailCode:"1152936",description:"",solution:"",updateTime:1528345986e3},{moduleCode:"",detailCode:"328011",description:"",solution:"",updateTime:15283386e5},{moduleCode:"",detailCode:"28",description:"",solution:"",updateTime:152833753e4},{moduleCode:"",detailCode:"320356",description:"",solution:"",updateTime:1528188693e3},{moduleCode:"",detailCode:"320357",description:"",solution:"",updateTime:1528188517e3},{moduleCode:"",detailCode:"405800",description:"",solution:"",updateTime:1528168732e3},{moduleCode:"",detailCode:"405996",description:"",solution:"",updateTime:1528168686e3},{moduleCode:"",detailCode:"380357",description:"",solution:"",updateTime:1528011565e3},{moduleCode:"",detailCode:"328022",description:"",solution:"",updateTime:1527929065e3},{moduleCode:"",detailCode:"380003",description:"",solution:"",updateTime:1527927819e3},{moduleCode:"",detailCode:"50004",description:"",solution:"",updateTime:1527770643e3},{moduleCode:"",detailCode:"50011",description:"",solution:"",updateTime:1527770635e3},{moduleCode:"",detailCode:"370017",description:"",solution:"",updateTime:1527739514e3},{moduleCode:"",detailCode:"327032",description:"",solution:"",updateTime:1527726704e3},{moduleCode:"",detailCode:"324001",description:"",solution:"",updateTime:1527681892e3},{moduleCode:"",detailCode:"405997",description:"",solution:"",updateTime:1527653408e3},{moduleCode:"",detailCode:"405995",description:"",solution:"",updateTime:1527647283e3},{moduleCode:"",detailCode:"1153825",description:"",solution:"",updateTime:1527601747e3},{moduleCode:"",detailCode:"328002",description:"",solution:"",updateTime:1527495292e3},{moduleCode:"",detailCode:"1152679",description:"",solution:"",updateTime:1527486665e3},{moduleCode:"",detailCode:"380356",description:"",solution:"",updateTime:1527125669e3},{moduleCode:"",detailCode:"328032",description:"",solution:"",updateTime:1527069382e3},{moduleCode:"",detailCode:"22",description:"",solution:"",updateTime:1527049826e3},{moduleCode:"",detailCode:"9",description:"",solution:"",updateTime:1527006778e3},{moduleCode:"",detailCode:"89",description:"",solution:"",updateTime:1526622784e3},{moduleCode:"",detailCode:"328016",description:"",solution:"",updateTime:1526452365e3},{moduleCode:"",detailCode:"368005",description:"",solution:"",updateTime:1525921264e3},{moduleCode:"",detailCode:"0",description:"",solution:"",updateTime:1525920242e3},{moduleCode:"",detailCode:"380006",description:"",solution:"",updateTime:1525918868e3},{moduleCode:"",detailCode:"310",description:"",solution:"",updateTime:1525834436e3},{moduleCode:"",detailCode:"360011",description:"",solution:"",updateTime:1525681552e3},{moduleCode:"",detailCode:"170005",description:"",solution:"",updateTime:15254339e5},{moduleCode:"",detailCode:"50023",description:"",solution:"",updateTime:1525403338e3},{moduleCode:"",detailCode:"100131",description:"",solution:"",updateTime:1525229691e3},{moduleCode:"",detailCode:"-1018",description:"",solution:"",updateTime:1525142341e3},{moduleCode:"",detailCode:"362026",description:"",solution:"",updateTime:1524882677e3},{moduleCode:"",detailCode:"368007",description:"",solution:"",updateTime:1524832269e3},{moduleCode:"",detailCode:"54",description:"",solution:"",updateTime:1524793646e3},{moduleCode:"",detailCode:"1154722",description:"",solution:"",updateTime:1524620807e3},{moduleCode:"",detailCode:"320229",description:"",solution:"",updateTime:1524551682e3},{moduleCode:"",detailCode:"360012",description:"",solution:"",updateTime:1524472094e3},{moduleCode:"",detailCode:"380229",description:"",solution:"",updateTime:1524110755e3},{moduleCode:"",detailCode:"360016",description:"",solution:"",updateTime:1523933518e3},{moduleCode:"",detailCode:"-1003",description:"",solution:"",updateTime:1523584804e3},{moduleCode:"",detailCode:"410026",description:"",solution:"",updateTime:152351743e4},{moduleCode:"",detailCode:"360102",description:"TTS初始化失败",solution:"",updateTime:1523503528e3},{moduleCode:"",detailCode:"360013",description:"设备开启了隐私保护",solution:"",updateTime:1523503507e3},{moduleCode:"",detailCode:"360010",description:"设备正在对讲中",solution:"",updateTime:1523503491e3},{moduleCode:"",detailCode:"360007",description:"TTS关闭了与客户端的连接",solution:"",updateTime:1523503475e3},{moduleCode:"",detailCode:"360006",description:"客户端接收发生错误",solution:"",updateTime:1523503457e3},{moduleCode:"",detailCode:"360005",description:"客户端发送的消息错误",solution:"",updateTime:1523503437e3},{moduleCode:"",detailCode:"360004",description:"TTS内部发生错误",solution:"",updateTime:1523503421e3},{moduleCode:"",detailCode:"360003",description:"TTS的设备端发生错误",solution:"",updateTime:1523503397e3},{moduleCode:"",detailCode:"360002",description:"对讲发起超时",solution:"",updateTime:1523503376e3},{moduleCode:"",detailCode:"360001",description:"客户端请求超时",solution:"",updateTime:1523503357e3},{moduleCode:"",detailCode:"320077",description:"",solution:"",updateTime:1523444274e3},{moduleCode:"",detailCode:"370047",description:"",solution:"",updateTime:152344048e4},{moduleCode:"",detailCode:"100002",description:"",solution:"",updateTime:1523413964e3},{moduleCode:"",detailCode:"-1004",description:"",solution:"",updateTime:1523336653e3},{moduleCode:"",detailCode:"380000",description:"",solution:"",updateTime:1523180856e3},{moduleCode:"",detailCode:"380213",description:"",solution:"",updateTime:1523180623e3},{moduleCode:"",detailCode:"380101",description:"",solution:"",updateTime:1522834231e3},{moduleCode:"",detailCode:"50047",description:"",solution:"",updateTime:1522833243e3},{moduleCode:"",detailCode:"-999",description:"",solution:"",updateTime:1522831034e3},{moduleCode:"",detailCode:"320418",description:"",solution:"",updateTime:1522829072e3},{moduleCode:"",detailCode:"-1009",description:"",solution:"",updateTime:1522746247e3},{moduleCode:"",detailCode:"320209",description:"",solution:"",updateTime:1522744395e3},{moduleCode:"",detailCode:"368006",description:"",solution:"",updateTime:15227443e5},{moduleCode:"",detailCode:"369003",description:"",solution:"",updateTime:1522736355e3},{moduleCode:"",detailCode:"405989",description:"",solution:"",updateTime:1522726571e3},{moduleCode:"",detailCode:"-1012",description:"",solution:"",updateTime:1522726203e3},{moduleCode:"",detailCode:"322016",description:"",solution:"",updateTime:1522722918e3},{moduleCode:"",detailCode:"500103",description:"",solution:"",updateTime:1522655556e3},{moduleCode:"",detailCode:"405999",description:"",solution:"",updateTime:1522654716e3},{moduleCode:"",detailCode:"321032",description:"",solution:"",updateTime:1522647732e3},{moduleCode:"",detailCode:"381101",description:"",solution:"",updateTime:1522392414e3},{moduleCode:"",detailCode:"399999",description:"",solution:"",updateTime:1522379834e3},{moduleCode:"",detailCode:"380103",description:"",solution:"",updateTime:1522312724e3},{moduleCode:"",detailCode:"360014",description:"",solution:"",updateTime:1522304341e3},{moduleCode:"",detailCode:"-1005",description:"",solution:"",updateTime:1522288195e3},{moduleCode:"",detailCode:"395454",description:"",solution:"",updateTime:152222018e4},{moduleCode:"",detailCode:"100005",description:"",solution:"",updateTime:1522218849e3},{moduleCode:"",detailCode:"100004",description:"",solution:"",updateTime:1522209053e3},{moduleCode:"",detailCode:"106002",description:"",solution:"",updateTime:15222062e5},{moduleCode:"",detailCode:"410030",description:"",solution:"",updateTime:1522162252e3},{moduleCode:"",detailCode:"-1002",description:"",solution:"",updateTime:152215069e4},{moduleCode:"",detailCode:"-1200",description:"",solution:"",updateTime:1522139025e3},{moduleCode:"",detailCode:"-1001",description:"",solution:"",updateTime:1522046436e3},{moduleCode:"",detailCode:"-1011",description:"",solution:"",updateTime:1522045931e3},{moduleCode:"",detailCode:"381102",description:"",solution:"",updateTime:1522044953e3},{moduleCode:"",detailCode:"381103",description:"",solution:"",updateTime:1522044953e3},{moduleCode:"",detailCode:"391205",description:"vtdu解析服务器ip失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391206",description:"vtdu描述符select失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391207",description:"vtdu文件描述符不在可读中",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391208",description:"vtdu网络发生错误getsockopt",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"391209",description:"vtdu描述符select超时",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395000",description:"cas回复信令，发现内存已经释放（和设备之间异常断开）",solution:"检查设备网络；刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395400",description:"私有化协议vtm检测私有化协议中码流类型小于0或者设备序列号为空等非法参数场景返回(app不重试取流)",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395402",description:"回放找不到录像文件",solution:"检查是否有存储卡并且接触良好",updateTime:1522034841e3},{moduleCode:"",detailCode:"395403",description:"操作码或信令密钥与设备不匹配",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395404",description:"设备不在线",solution:"检查设备网络；重启设备接入萤石云",updateTime:1522034841e3},{moduleCode:"",detailCode:"395405",description:"流媒体向设备发送或接受信令超时/cas响应超时",solution:"检查设备网络；重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"395406",description:"token失效",solution:"刷新重试或者重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"395407",description:"客户端的URL格式错误",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395409",description:"预览开启隐私保护",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395410",description:"设备达到最大连接数",solution:"请升级设备固件版本",updateTime:1522034841e3},{moduleCode:"",detailCode:"395411",description:"token无权限",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395412",description:"session不存在 ",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395413",description:"验证token的他异常（不具体） ",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395415",description:"设备通道错",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395451",description:"设备不支持的码流类型",solution:"刷新重试或者切换到高清模式",updateTime:1522034841e3},{moduleCode:"",detailCode:"395452",description:"设备链接流媒体服务器失败 ",solution:"检查设备网络，重启设备，刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395500",description:"服务器处理失败 ",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395501",description:"流媒体vtdu达到最大负载，请扩容",solution:"服务器负载达到上限，请稍后重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395503",description:"vtm返回分配vtdu失败",solution:"服务器负载达到上限，请稍后重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395544",description:"设备返回无视频源 ",solution:"设备是否接触良好；",updateTime:1522034841e3},{moduleCode:"",detailCode:"395545",description:"视频分享时间已经结束",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395546",description:"vtdu返回达到取流并发路数限制",solution:"请升级为企业版，放开并发限制",updateTime:1522034841e3},{moduleCode:"",detailCode:"395560",description:"蚁兵代理不支持的用户取流类型，会重定向到vtdu取流",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395557",description:"回放服务器等待流头超时",solution:"刷新重试，检测设备网络，重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"395600",description:"分享设备不在分享时间内",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395601",description:"群组分享用户没权限",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395602",description:"群组分享权限变更",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395556",description:"ticket取流验证失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"395530",description:"机房故障不可用",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"395701",description:"cas信令返回格式错误",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396001",description:"客户端参数出错",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396099",description:"客户端默认错误",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396101",description:"不支持的命令",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396102",description:"设备流头发送失败",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396103",description:"cas/设备返回错误1",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396104",description:"cas/设备返回错误-1",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396105",description:"设备返回错误码3",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396106",description:"设备返回错误码4",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396107",description:"设备返回错误码5",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396108",description:"cas信令回应重复",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396109",description:"视频广场取消分享",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396110",description:"设备信令默认错误",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396501",description:"设备数据链路和实际链路不匹配",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396502",description:"设备数据链路重复建立连接",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396503",description:"设备数据链路端口不匹配",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396504",description:"缓存设备数据链路失败(内存块不足)",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396505",description:"设备发送确认头消息重复",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396506",description:"设备数据先于确定头部到达",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396508",description:"设备数据头部长度非法",solution:"刷新重试，或者重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"396509",description:"索引找不到设备数据管理块",solution:"刷新重试",updateTime:1522034841e3},{moduleCode:"",detailCode:"396510",description:"设备数据链路vtdu内存块协议状态不匹配",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396511",description:"设备数据头部没有streamkey错误",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396512",description:"设备数据头部非法(较笼统)",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396513",description:"设备数据长度过小",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396514",description:"设备老协议推流头部没有streamkey错误",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396515",description:"设备老协议推流数据非法",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396516",description:"设备老协议索引找不到内存管理块",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396517",description:"设备老协议推流数据非法",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396518",description:"设备数据包过大",solution:"刷新重试，或者重启设备",updateTime:1522034841e3},{moduleCode:"",detailCode:"396519",description:"设备推流链路网络不稳定",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"396520",description:"设备推流链路网络不稳定(默认)",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"170003",description:"refreshToken不存在",solution:"建议用户重新调用logout接口，然后调用openLoginPage接口重新启动登录页面登录",updateTime:1522034841e3},{moduleCode:"",detailCode:"170004",description:"refreshToken已过期",solution:"建议用户重新调用logout接口，然后调用openLoginPage接口重新启动登录页面登录",updateTime:1522034841e3},{moduleCode:"",detailCode:"380011",description:"设备隐私保护中",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380045",description:"设备直连取流连接数量过大",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380047",description:"设备不支持该命令",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380077",description:"设备正在对讲中",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380102",description:"数据接收异常",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380205",description:"设备检测入参异常",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380209",description:"网络连接超时",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"380212",description:"设备端网络连接超时",solution:"",updateTime:1522034841e3},{moduleCode:"",detailCode:"101007",description:"手机号未注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120503",description:"正在响铃",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390016",description:"vtdu成功响应未携带流头",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101008",description:"手机号码不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120504",description:"室内机正在通话",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390017",description:"无数据流，尚未使用",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101009",description:"用户名与手机不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120505",description:"设备操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390018",description:"信令消息体PB解析失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101010",description:"获取验证码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120506",description:"非法命令",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390019",description:"信令消息体PB封装失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101011",description:"验证码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120507",description:"智能锁密码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390020",description:"申请系统内存资源失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101012",description:"验证码失效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120508",description:"开关锁失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390021",description:"vtdu地址尚未获取到",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101013",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120509",description:"开关锁超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390022",description:"客户端尚未支持",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101014",description:"密码不正确或者appKey不正确",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120510",description:"智能锁设备繁忙",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390023",description:"获取系统socket资源失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101015",description:"用户被锁住",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120511",description:"远程开锁功能未打开",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390024",description:"上层填充的StreamSsnId不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101021",description:"验证参数异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120600",description:"临时密码数已达上限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390025",description:"链接服务器失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101026",description:"邮箱已经被注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120601",description:"添加临时密码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390026",description:"客户端请求未收到服务端应答",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101031",description:"邮箱未注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120602",description:"删除临时密码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390027",description:"链路断开",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101032",description:"邮箱不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120603",description:"该临时密码不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390028",description:"没有取流链接",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101041",description:"获取验证码过于频繁",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120604",description:"指纹锁射频通信失败,请稍后再试",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390029",description:"流成功停止",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101043",description:"手机验证码输入错误超过规定次数",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120605",description:"其他用户正在认证中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390030",description:"客户端防串流校验失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102000",description:"设备不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120606",description:"验证已启动,请在120s内进行本地验证和调用添加设备接口",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390031",description:"应用层tcp粘包处理缓冲区满",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102001",description:"摄像机不存在",solution:"摄像机未注册到萤石云平台，请仔细检查摄像机的网络配置，确保连接到网络",updateTime:152203484e4},{moduleCode:"",detailCode:"120607",description:"删除用户失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390032",description:"无效状态迁移",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102003",description:"设备不在线",solution:"参考服务中心排查方法",updateTime:152203484e4},{moduleCode:"",detailCode:"120608",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390033",description:"无效客户端状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102004",description:"设备异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120609",description:"设备响应超时,门锁通信故障或者电量不足,请重试.",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390034",description:"向vtm取流流媒体信息请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102007",description:"设备序列号不正确",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120610",description:"获取临时密码列表失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390035",description:"向代理取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"102009",description:"设备请求响应超时异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130001",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390036",description:"向代理保活取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"105000",description:"设备已被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130002",description:"手机号码已经注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390037",description:"向vtdu取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"105001",description:"设备已被别人添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130003",description:"手机验证码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390038",description:"向vtdu保活取流请求超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"105002",description:"设备验证码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"130004",description:"终端绑定操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391001",description:"vtm地址或端口非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107001",description:"邀请不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"149999",description:"数据异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391002",description:"vtm生成文件描述符失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107002",description:"邀请验证失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"150000",description:"服务器异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391003",description:"vtm设置文件描述符非阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107003",description:"邀请用户不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160000",description:"设备不支持云台控制",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391004",description:"vtm设置文件描述符阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107004",description:"云存储连接失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160001",description:"用户无云台控制权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391005",description:"vtm解析服务器ip失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"7005",description:"VTDU主动断开连接",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107005",description:"VTDU主动断开连接",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160002",description:"设备云台旋转达到上限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391006",description:"vtm描述符select失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107006",description:"不能邀请自己",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160003",description:"设备云台旋转达到下限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391007",description:"vtm文件描述符不在可读中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"107007",description:"重复邀请",solution:"分享和删除分享必须全部由接口形式操作，如果与萤石客户端混用会造成这个问题，解决办法：在萤石客户端清空所有相关分享数据并重新添加设备，再通过接口操作即可",updateTime:152203484e4},{moduleCode:"",detailCode:"160004",description:"设备云台旋转达到左限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391008",description:"vtm网络发生错误getsockopt",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110001",description:"参数错误",solution:"参数为空或者格式不对",updateTime:152203484e4},{moduleCode:"",detailCode:"160005",description:"设备云台旋转达到右限位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391009",description:"vtm描述符select超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110002",description:"accessToken异常或过期",solution:"accessToken有效期为七天，建议在accessToken即将过期或者出现10002错误码的时候重新获取accessToken",updateTime:152203484e4},{moduleCode:"",detailCode:"160006",description:"云台当前操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391101",description:"proxy地址或端口非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110004",description:"用户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160007",description:"预置点个数超过最大值",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391102",description:"proxy生成文件描述符失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110005",description:"appKey异常",solution:"确认appKey状态，不通过或者冻结状态会返回该错误码",updateTime:152203484e4},{moduleCode:"",detailCode:"160009",description:"正在调用预置点",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391103",description:"proxy设置文件描述符非阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110006",description:"ip受限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160010",description:"该预置点已经是当前位置",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391104",description:"proxy设置文件描述符阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160011",description:"预置点不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391105",description:"proxy解析服务器ip失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110008",description:"签名错误",solution:"①获取签名方式详见apidemo及[旧]API文档 ②注意编码格式为UTF-8",updateTime:152203484e4},{moduleCode:"",detailCode:"160013",description:"设备版本已是最新",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391106",description:"proxy描述符select失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110009",description:"签名参数错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160014",description:"设备正在升级",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391107",description:"proxy文件描述符不在可读中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110010",description:"签名超时",solution:"请调用同步服务器时间接口进行校时",updateTime:152203484e4},{moduleCode:"",detailCode:"160015",description:"设备正在重启",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391108",description:"proxy网络发生错误getsockopt",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110011",description:"未开通萤石云服务",solution:"参照绑定流程",updateTime:152203484e4},{moduleCode:"",detailCode:"160016",description:"加密未开启，无须关闭",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391109",description:"proxy描述符select超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110012",description:"第三方账户与萤石账号已经绑定",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160017",description:"设备抓图失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391201",description:"vtdu地址或端口非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110013",description:"应用没有权限调用此接口",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160018",description:"设备升级失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391202",description:"vtdu生成文件描述符失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110014",description:"APPKEY下对应的第三方userId和phone未绑定",solution:"获取AccessToken时所用appKey与SDK所用appKey不一致",updateTime:152203484e4},{moduleCode:"",detailCode:"160019",description:"加密已开启",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"391203",description:"vtdu设置文件描述符非阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110017",description:"appKey不存在",solution:"请填写在官网申请的应用秘钥",updateTime:152203484e4},{moduleCode:"",detailCode:"160020",description:"不支持该命令",solution:"请确认设备是否支持该命令",updateTime:152203484e4},{moduleCode:"",detailCode:"391204",description:"vtdu设置文件描述符阻塞失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110018",description:"AccessToken与Appkey不匹配",solution:"请检查获取accessToken对应的appKey和SDK中设置的appKey是否一致",updateTime:152203484e4},{moduleCode:"",detailCode:"160023",description:"订阅操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110019",description:"密码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160024",description:"取消订阅操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110020",description:"请求方法为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160025",description:"客流统计配置失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110021",description:"ticket校验失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160026",description:"设备处于隐私遮蔽状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110022",description:"透传目的地非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160027",description:"设备正在镜像操作",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110024",description:"无透传权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160028",description:"设备正在键控动作",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110025",description:"appKey被禁止使用通明通道",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160029",description:"设备处于语音对讲状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160030",description:"卡密输入错误次数过多，24小时后再输入",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160031",description:"卡密信息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160032",description:"卡密状态不对或已过期",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160033",description:"卡密非卖品，只能开通对应的绑定设备",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110030",description:"appKey和appSecret不匹配",solution:"请检查appKey和appSecret是否对应",updateTime:152203484e4},{moduleCode:"",detailCode:"160035",description:"购买云存储服务失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110031",description:"子账户或萤石用户没有权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160040",description:"添加的设备不在同一局域网",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110032",description:"子账户不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160041",description:"添加的设备被其他设备关联或响应超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110033",description:"子账户未设置授权策略",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160042",description:"添加的设备密码错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110034",description:"子账户已存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160043",description:"添加的设备超出最大数量",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110035",description:"获取子账户AccessToken异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160044",description:"添加的设备网络不可达超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110036",description:"子账户被禁用",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160045",description:"添加的设备的IP和其他通道的IP冲突",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"110051",description:"无权限进行抓图",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160046",description:"添加的设备的IP和本设备的IP冲突",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160047",description:"码流类型不支持",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120002",description:"设备不存在",solution:"①设备没有注册到萤石云平台，请检查下设备网络参数，确保能正常连接网络②设备序列号不存在",updateTime:152203484e4},{moduleCode:"",detailCode:"160048",description:"带宽超出系统接入带宽",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120003",description:"参数异常，SDK版本过低",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160049",description:"IP或者端口不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120004",description:"参数异常，SDK版本过低",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160050",description:"添加的设备版本不支持需要升级才能接入",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120005",description:"安全认证失败，需进行SDK安全认证",solution:"已去掉安全验证",updateTime:152203484e4},{moduleCode:"",detailCode:"160051",description:"添加的设备不支持接入",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120006",description:"网络异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160052",description:"添加的设备通道号出错",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120007",description:"设备不在线",solution:"参考服务中心排查方法",updateTime:152203484e4},{moduleCode:"",detailCode:"160053",description:"添加的设备分辨率不支持",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120008",description:"设备响应超时",solution:"设备响应超时，请检测设备网络或重试",updateTime:152203484e4},{moduleCode:"",detailCode:"160054",description:"添加的设备账号被锁定",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120009",description:"子账号不能添加设备",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160055",description:"添加的设备取码流出错",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120010",description:"设备验证码错误",solution:"验证码在设备标签上，六位大写字母，注意大小写",updateTime:152203484e4},{moduleCode:"",detailCode:"160056",description:"删除设备失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120012",description:"设备添加失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160057",description:"删除的设备未关联",solution:"检查IPC与NVR是否有关联关系",updateTime:152203484e4},{moduleCode:"",detailCode:"120013",description:"设备已被别人添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160060",description:"地址未绑定",solution:"请前往官网设置直播",updateTime:152203484e4},{moduleCode:"",detailCode:"120014",description:"设备序列号不正确",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160061",description:"账户流量已超出或未购买，限制开通",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120015",description:"设备不支持该功能",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160062",description:"该通道直播已开通",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120016",description:"当前设备正在格式化",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160063",description:"直播未使用或直播已关闭",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120017",description:"设备已被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160070",description:"设备不能转移给自己",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120018",description:"该用户不拥有该设备",solution:"确认设备是否属于用户",updateTime:152203484e4},{moduleCode:"",detailCode:"160071",description:"设备不能转移，设备与其他设备存在关联关系",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400001",description:"参数为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120019",description:"设备不支持云存储服务",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160072",description:"设备不能转移，通道被分享给其他用户或者分享到视频广场",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400002",description:"参数错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120020",description:"设备在线，被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160073",description:"云存储转移失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400025",description:"设备不支持对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120021",description:"设备在线，但是未被用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160080",description:"当前正在声源定位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400029",description:"没有初始化或资源被释放",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120022",description:"设备在线，但是已经被别的用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160081",description:"当前正在轨迹巡航",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400030",description:"json解析异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120023",description:"设备不在线，未被用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160082",description:"设备正在响应本次声源定位",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400031",description:"网络异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120024",description:"设备不在线，但是已经被别的用户添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"160083",description:"当前正在开启隐私遮蔽",solution:"设备正在操作隐私遮蔽，无法进行当前操作",updateTime:152203484e4},{moduleCode:"",detailCode:"400032",description:"设备信息异常为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120025",description:"重复申请分享",solution:"确认设备是否由添加过该设备且申请过分享的账户下是否还存在分享记录",updateTime:152203484e4},{moduleCode:"",detailCode:"160084",description:"当前正在关闭隐私遮蔽",solution:"设备正在操作隐私遮蔽，无法进行当前操作",updateTime:152203484e4},{moduleCode:"",detailCode:"400034",description:"取流超时",solution:"一般是由于网络状况不好导致，可以尝试下让用户重新播放",updateTime:152203484e4},{moduleCode:"",detailCode:"120026",description:"视频广场不存在该视频",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"380290",description:"　连接CAS服务器失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400035",description:"设备已加密，需要输入验证码",solution:"收到此错误码，需要让用户输入验证码后，调用EZPlayer.setPlayKey传入验证码，并重新调用播放函数",updateTime:152203484e4},{moduleCode:"",detailCode:"120027",description:"视频转码失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361001",description:"对讲服务端排队超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400036",description:"播放验证码错误",solution:"收到此错误码，需要让用户输入验证码后，调用EZPlayer.setPlayKey传入验证码，并重新调用播放函数",updateTime:152203484e4},{moduleCode:"",detailCode:"120028",description:"设备固件升级包不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361002",description:"对讲服务端处理超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400037",description:"surfacehold错误",solution:"请检查是否是播放之前销毁了surface，收到此错误也可以重新建立surface后播放",updateTime:152203484e4},{moduleCode:"",detailCode:"120029",description:"设备不在线，但是已经被自己添加",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361003",description:"设备链接对讲服务器超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400100",description:"未知错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120030",description:"该用户不拥有该视频广场视频",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361004",description:"服务器内部错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400200",description:"player sdk出错，这种错误一般开发者也是无法解决，不具体分类传出，传一个统一的inner错误码出去",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120031",description:"开启终端绑定，硬件特征码验证失败",solution:"请在萤石客户端关闭终端绑定，参考此步骤",updateTime:152203484e4},{moduleCode:"",detailCode:"361005",description:"解析消息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400300",description:"内存溢出",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120032",description:"该用户下通道不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361006",description:"请求重定向--需要向其他服务申请对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400901",description:"设备不在线，可以提示用户",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120033",description:"无法收藏自己分享的视频",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361007",description:"请求url非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400902",description:"accesstoken异常或失效，需要重新获取accesstoken，并传入到sdk",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120034",description:"该用户下无设备",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361008",description:"token失效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400903",description:"当前账号开启了终端绑定，只允许指定设备登录操作，提示用户登录i.ys7.com解除终端绑定",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120090",description:"用户反馈失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361009",description:"设备验证码或者通信秘钥不匹配",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400904",description:"设备正在对讲中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120095",description:"APP包下载失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361010",description:"设备已经在对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"400905",description:"设备开启了隐私保护，不允许预览、对讲等",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120096",description:"APP包信息删除失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361011",description:"设备10s响应超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120101",description:"视频不支持分享给本人",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361012",description:"设备不在线",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320002",description:"参数无效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120102",description:"无相应邀请信息",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361013",description:"设备开启隐私保护拒绝对讲",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320003",description:"暂不支持此操作",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120103",description:"好友已存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361014",description:"token无权限",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320004",description:"内存溢出",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120104",description:"好友不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361015",description:"设备返回session不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320005",description:"创建CAS session失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120105",description:"好友状态错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361016",description:"验证token其他异常错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320006",description:"创建cloud session失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120106",description:"对应群组不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361017",description:"服务端监听设备建立端口超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320007",description:"token失效",solution:"重新设置token后再重试",updateTime:152203484e4},{moduleCode:"",detailCode:"120107",description:"不能添加自己为好友",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361018",description:"设备链路异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320008",description:"token池里面没有token,请传入token",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120108",description:"当前用户和所添加用户不是好友关系",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361019",description:"对讲服务端不支持的信令消息",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320009",description:"传入新的INIT_PARAM并reset(保留，目前未用)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120109",description:"对应分享不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361020",description:"对讲服务端解析对讲请求未携带会话描述能力集",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320010",description:"请重试",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120110",description:"好友群组不属于当前用户",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361021",description:"对讲服务端优先能力集结果为空",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320011",description:"500毫秒后请重试",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120111",description:"好友不是等待验证状态",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361022",description:"cas链路异常",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320012",description:"token池已满",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120112",description:"添加应用下的用户为好友失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361023",description:"对讲服务端分配对讲会话资源失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320013",description:"P2P client超过限制",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120201",description:"操作报警信息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"361024",description:"对讲服务端解析信令消息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320014",description:"sdk未初始化",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120202",description:"操作留言信息失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390001",description:"通用错误返回",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320015",description:"超时",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120301",description:"根据UUID查询报警消息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390002",description:"入参为空指针",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320016",description:"正在打洞中",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120302",description:"根据UUID查询图片不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390003",description:"入参值无效",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320017",description:"没有视频文件头(播放器层面产生和处理此错误)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120303",description:"根据FID查询图片不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390004",description:"信令消息解析非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320018",description:"解码错误/超时(播放器层面产生和处理此错误)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120305",description:"设备ip解析错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390005",description:"内存资源不足",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320019",description:"取消(保留，用户不用处理)",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120401",description:"用户云空间信息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390006",description:"协议格式不对或者消息体长度超过STREAM_MAX_MSGBODY_LEN",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320020",description:"播放过程中预连接被用户清除预操作信息",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120402",description:"云空间操作失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390007",description:"设备序列号长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320021",description:"流加密码不对",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120403",description:"用户目录不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390008",description:"取流url长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"320022",description:"未传入播放窗口",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120404",description:"要操作的目标目录不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390009",description:"解析vtm返回vtdu地址不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"100200",description:"操作成功",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120405",description:"要删除的文件信息不存在",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390010",description:"解析vtm返回级联vtdu地址不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101001",description:"用户名不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120406",description:"已开通云存储",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390011",description:"解析vtm返回会话标识长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101002",description:"用户名已被占用",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120407",description:"开通记录失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390012",description:"vtdu返回流头长度不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101003",description:"密码不合法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120500",description:"获取数据错误",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390013",description:"vtdu会话长度非法",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101004",description:"密码为同一字符",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120501",description:"开锁失败",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390014",description:"回调函数未注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"101006",description:"手机号码已经被注册",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"120502",description:"室内机未收到呼叫",solution:"",updateTime:152203484e4},{moduleCode:"",detailCode:"390015",description:"vtdu成功响应未携带会话标识",solution:"",updateTime:152203484e4}],code:"200",msg:"操作成功!"},P=function(){function e(t,i){n(this,e),this.coreX=t,this.coreY=i,console.log("ErrorCode",w)}return o(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"matchErrorInfo",value:function(e){return w.data.find((function(t){return t.detailCode.substr(-4)==e}))}}]),e}(),k={color:"red",backgroundColor:"red",activeColor:"red",btnList:[{btnKey:"ade5d065a113432e8091a1c5bc819c57-934f270c08b14e928bf0c2ae8e1a937d-header-0",iconId:"deviceID",part:"left",defaultActive:1,isrender:1,themeId:"934f270c08b14e928bf0c2ae8e1a937d"},{btnKey:"ade5d065a113432e8091a1c5bc819c57-934f270c08b14e928bf0c2ae8e1a937d-header-1",iconId:"deviceName",part:"left",defaultActive:1,isrender:1,themeId:"934f270c08b14e928bf0c2ae8e1a937d"}]},E={color:"blue",backgroundColor:"blue",activeColor:"blue",btnList:[{btnKey:"ade5d065a113432e8091a1c5bc819c57-934f270c08b14e928bf0c2ae8e1a937d-footer-0",iconId:"play",part:"left",defaultActive:0,isrender:0,themeId:"934f270c08b14e928bf0c2ae8e1a937d"}]},I=function e(t){this.jsPlugin=t;var n={isMouseDown:!1,isOver:!1,mousePosition:null,oldTime:null,nowTime:null,moved:null,hoverTime:"2018-12-07 12:00:00",hoverLeft:0,timeTipShow:!1,randomNum:123,timeWidthTbls:[60,1800,3600,86400],timeUnits:["范围: 1分钟; 单位: 秒","范围: 30分钟; 单位: 分钟","范围: 1小时; 单位: 分钟","范围: 1天; 单位: 小时","范围: 3天; 单位: 小时"],drawPen:null,timeSection:[],canvasWidth:null,canvasHeight:null,timeTips:null},i=this;Object.keys(n).forEach((function(e){i[e]=n[e]})),this.options={width:this.canvasWidth,height:48,time:(new Date).getTime(),timeSection:[],timeWidth:0},e.prototype.subTime=function(e){return e<10?"0"+e:e},e.prototype.tranTime=function(e){var t=e;if(e){var n=new Date(e);t=n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+this.subTime(n.getHours())+":"+this.subTime(n.getMinutes())+":"+this.subTime(n.getSeconds())}return t},e.prototype.init=function(e){e.width&&document.getElementById(e.id).setAttribute("width",parseInt(e.width,10)+"px");var t=this,n=this.options;t.randomNum=(Math.random()+"").split(".").join(""),t.timeWidthTblIndex=n.timeWidth;var i=document.querySelector("#".concat(this.jsPlugin.id,"-canvas"));t.drawPen=i.getContext("2d"),t.nowTime=n.time||Date.now(),t.timeSection=n.timeSection||[],t.canvasWidth=i.offsetWidth,t.canvasHeight=i.offsetHeight,t.updata(),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mousemove",(function(e){t.options.readOnly||t.mousemove(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mouseover",(function(e){t.options.readOnly||t.mouseover(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mouseleave",(function(e){t.options.readOnly||t.mouseleave(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mousedown",(function(e){t.options.readOnly||t.mousedown(e)})),document.getElementById("".concat(this.jsPlugin.id,"-canvas")).addEventListener("mouseup",(function(n){if(!t.options.readOnly){var i=e.onChange;t.mouseUpFn(n,i)}}))},e.prototype.mousemove=function(e){if(this.isMouseDown&&this.isOver){var t=this.mousePosition-e.pageX;if(0===t)return;var n=0;switch(this.timeWidth){case 60:n=.1;break;case 1800:case 3600:n=3;break;case 86400:n=120}var i=new Date(this.oldTime).getTime()+t*n*1e3;this.updata({time:i}),this.moved=!0}else{var o=parseInt(document.getElementById("".concat(this.jsPlugin.id,"-canvas-container")).offsetLeft,10);this.mousePosition=e.pageX-o,this.updata()}},e.prototype.mousedown=function(e){this.isMouseDown=!0,this.mousePosition=e.pageX,this.oldTime=this.nowTime},e.prototype.mouseover=function(e){this.isOver=!0},e.prototype.mouseleave=function(e){this.isOver=!1,this.isMouseDown=!1,this.updata()},e.prototype.changeSize=function(e){console.log("changeSize",e),this.options.timeWidth=e,this.updata({timeWidth:e})},e.prototype.mouseUpFn=function(e,t){if(this.isMouseDown&&(this.isMouseDown=!1,this.moved)){this.moved=!1;var n=this.subTime(new Date(this.nowTime).getHours())+":"+this.subTime(new Date(this.nowTime).getMinutes())+":"+this.subTime(new Date(this.nowTime).getSeconds()),i=new Date(this.oldTime).getFullYear()+"/"+(new Date(this.oldTime).getMonth()+1)+"/"+new Date(this.oldTime).getDate();this.nowTime=new Date("".concat(i," ").concat(n)),this.updata({time:this.nowTime}),this.oldTime=this.nowTime,console.log("nowTime",new Date(this.nowTime),"".concat(i," ").concat(n)),t(this.nowTime)}},e.prototype.readOnly=function(e){console.log("更改为只读"),this.options.readOnly=!0,document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.cursor="not-allowed"},e.prototype.unReadOnly=function(e){console.log("更改为只读"),this.options.readOnly=!1,document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.cursor="pointer"},e.prototype.run=function(e){this.isMouseDown||this.updata(e)},e.prototype.getTime=function(e){console.log("this",this),console.log("当前时间",new Date(this.nowTime))},e.prototype.updata=function(e){e=e||{},this.nowTime=e.time||this.nowTime,this.timeSection=e.timeSection||this.timeSection,this.timeWidthTblIndex=e.timeWidth||this.timeWidthTblIndex,this.timeWidth=this.timeWidthTbls[e.timeWidth||this.timeWidthTblIndex],this.timeUnit=this.timeUnits[e.timeWidth||this.timeWidthTblIndex],0===e.timeWidth&&(this.timeWidthTblIndex=0,this.timeWidth=this.timeWidthTbls[0],this.timeUnit=this.timeUnits[0]),this.drawPen.fillStyle="#000000",this.drawPen.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.drawScale(),this.drawRecord(),this.drawOtherMsg(),document.getElementById("".concat(this.jsPlugin.id,"-canvas-container")).style.width=this.options.width+"px",document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.width=this.options.width+"px",document.getElementById("".concat(this.jsPlugin.id,"-canvas-container")).style.height=this.options.height+"px",document.getElementById("".concat(this.jsPlugin.id,"-canvas")).style.height=this.options.height+"px"},e.prototype.drawSolidLine=function(e,t,n,i,o,r){this.drawPen.save(),this.drawPen.strokeStyle=r,this.drawPen.lineWidth=o,this.drawPen.beginPath(),this.drawPen.moveTo(e,t),this.drawPen.lineTo(n,i),this.drawPen.stroke(),this.drawPen.restore()},e.prototype.drawString=function(e,t,n,i,o){this.drawPen.font="12px serif",this.drawPen.fillStyle="#ffffff",this.drawPen.textAlign=i||"left",this.drawPen.fillText(e,t,n+10)},e.prototype.drawScale=function(){var e="rgba(255,255,255)",t=new Date(this.nowTime),n=t.getFullYear(),i=t.getSeconds(),o=t.getMinutes(),r=t.getHours(),a=t.getDate(),d=0;switch(this.timeWidth){case 60:var s=parseInt(this.canvasWidth/10);t.setSeconds(t.getSeconds()-parseInt(s/2,10)),a=t.getDate(),r=t.getHours(),o=t.getMinutes(),i=t.getSeconds();for(var c=0;c<s;c++){if(d=i+c,t.setSeconds(d),d%10==0){this.drawSolidLine(c*this.canvasWidth/s,8,c*this.canvasWidth/s,this.canvasHeight/5+8,1,e);var l=this.subTime(t.getHours())+":"+this.subTime(t.getMinutes())+":"+this.subTime(t.getSeconds());this.drawString(l,c*this.canvasWidth/s,this.canvasHeight/5*2.5,"center","rgba(255,255,255,0.3)")}else this.drawSolidLine(c*this.canvasWidth/s,8,c*this.canvasWidth/s,this.canvasHeight/5*.5+8,1,e);t.setDate(a),t.setHours(r),t.setMinutes(o)}break;case 1800:s=parseInt(this.canvasWidth/20);t.setMinutes(t.getMinutes()-parseInt(s/2,10)),r=t.getHours(),o=t.getMinutes();for(c=0;c<=s;c++){if(d=o+c,t.setMinutes(d),d%5==0){this.drawSolidLine(c*this.canvasWidth/s,8,c*this.canvasWidth/s,this.canvasHeight/5*1.5+8,1,e);l=this.subTime(t.getHours())+":"+this.subTime(t.getMinutes());this.drawString(l,c*this.canvasWidth/s,this.canvasHeight/5*2.5,"center","rgba(255,255,255,0.3)")}else this.drawSolidLine(c*this.canvasWidth/s,8,c*this.canvasWidth/s,this.canvasHeight/5*.5+8,1,e);t.setHours(r)}break;case 3600:s=parseInt(this.canvasWidth/20);t.setMinutes(t.getMinutes()-parseInt(s/2,10)),r=t.getHours(),o=t.getMinutes();for(c=0;c<=s;c++){if(d=o+c,t.setMinutes(d),d%10==0){this.drawSolidLine(c*this.canvasWidth/s,8,c*this.canvasWidth/s,this.canvasHeight/5*1.5+8,1,e);l=this.subTime(t.getHours())+":"+this.subTime(t.getMinutes());this.drawString(l,c*this.canvasWidth/s,this.canvasHeight/5*2.5,"center","rgba(255,255,255,0.3)")}else this.drawSolidLine(c*this.canvasWidth/s,8,c*this.canvasWidth/s,this.canvasHeight/5*.5+8,1,e);t.setHours(r)}break;case 86400:s=parseInt(this.canvasWidth/30);t.setHours(t.getHours()-parseInt(s/2,10)),i=t.getSeconds(),o=t.getMinutes(),r=t.getHours(),a=t.getDate(),n=t.getFullYear();for(c=0;c<=s;c++){d=r+c,t.setHours(d),l=this.subTime(t.getHours())+":00",this.drawSolidLine(c*this.canvasWidth/s,8,c*this.canvasWidth/s,this.canvasHeight/5*.5+8,1,e),d%2==0&&this.drawString(l,c*this.canvasWidth/s,this.canvasHeight/5*2,"center","rgba(255,255,255,0.3)"),t.setFullYear(n),t.setDate(a),t.setHours(r)}}},e.prototype.getRecord=function(e,t,n){this.timeSection=e,this.drawRecord()},e.prototype.drawRecord=function(){for(var e=this.timeSection||[],t=this,n=t.drawPen,i=0;i<e.length;i++){var o=a(e[i].startTime),r=a(e[i].endTime);n.fillStyle="#1890ff80",n.fillRect(o,0,r-o,48)}function a(e){var n=10;switch(t.timeWidth){case 60:n=10;break;case 1800:case 3600:n=20/60;break;case 86400:n=20/60/60}var i=t.canvasWidth/2+(e-t.nowTime)/1e3*n;return i>t.canvasWidth&&(i=t.canvasWidth),i<=0&&(i=0),i}},e.prototype.drawOtherMsg=function(){this.drawSolidLine(this.canvasWidth/2,0,this.canvasWidth/2,this.canvasHeight,2,"#1890FF"),this.drawPen.shadowBlur=0,this.isOver&&!this.isMouseDown?(this.mouseTime=this.mousePosition/this.canvasWidth*this.timeWidth*1e3+this.nowTime-this.timeWidth/2*1e3,this.mouseString=this.tranTime(this.mouseTime),this.hoverTime=this.mouseString,this.hoverLeft=this.mousePosition-60,this.timeTipShow=!0):this.timeTipShow=!1}},x=function(){function e(t){var i=this;if(n(this,e),this.jSPlugin=t,!document.getElementById("".concat(this.jSPlugin.id,"-audioControls")))return!1;this.currentTimeWidth=1,this.timer=null,this.date=new Date,this.datepickerVisible=!1,this.seekTimer=null,this.disabled=!1,this.seekFrequency=2e3,this.jSPlugin.params&&this.jSPlugin.params.seekFrequency&&(this.seekFrequency=this.jSPlugin.params.seekFrequency);var o=parseInt(getComputedStyle(document.getElementById(t.id)).width,10)-100,r=document.createElement("div");r.style="display:inline-block;height:48px;",r.id=this.jSPlugin.id+"-canvas-container";var a=document.createElement("canvas");a.id=this.jSPlugin.id+"-canvas",a.className="time-line-body",a.height="48",a.width=o,a.style="display:inline-block;",a.innerHTML="该浏览器不支持canvas",r.appendChild(a),u(r,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")));var c=document.createElement("div");c.className="timeline-controls",c.style="display:flex;width:100px;height:48px;text-align:center;line-height: 48px;vertical-align: top;background: #000000;";var p='\n<div class="timeline-controls-scale" style="display: inline-flex;flex-direction: column;justify-content: center;vertical-align: top;padding: 0 20px;">\n  <span style="vertical-Align: middle;line-height: 14px;height: 18px; width: 18px;cursor:pointer;" id="'.concat(this.jSPlugin.id,'-timeline-scale-add">\n    <svg fill="#2C2C2C" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20"\n      viewBox="0 0 20 20">\n      <title>add</title>\n      <g>\n        <polygon points="0.1,0.5 15,0.5 15,15.4 0.1,15.4 \t" />\n      </g>\n      <g>\n        <path\n          fill="#FFFFFF";\n          d="M7.6,12.4c-0.3,0-0.5-0.2-0.5-0.5v-8c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v8C8.1,12.2,7.9,12.4,7.6,12.4z" />\n      </g>\n      <g>\n        <path\n          fill="#FFFFFF";\n          d="M11.6,8.4h-8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h8c0.3,0,0.5,0.2,0.5,0.5S11.8,8.4,11.6,8.4z" />\n      </g>\n    </svg>\n  </span>\n  <span style="vertical-Align: middle;line-height: 14px;height: 18px; width: 18px;cursor:pointer;" id="').concat(this.jSPlugin.id,'-timeline-scale-sub">\n    <svg fill="#2C2C2C" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20"\n      viewBox="0 0 20 20">\n      <title>reduce</title>\n      <g>\n        <polygon class="st0" points="1,0.8 15.2,0.8 15.2,15 1,15 \t" />\n      </g>\n      <g>\n        <path class="st1"\n          fill="#FFFFFF";\n          d="M12.1,8.4h-8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h8c0.3,0,0.5,0.2,0.5,0.5S12.4,8.4,12.1,8.4z" />\n      </g>\n    </svg>\n  </span>\n</div>\n<label for="').concat(this.jSPlugin.id,'-datepicker">\n  <div class="timeline-controls-date">\n    <span>\n      <svg fill="#2C2C2C" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20"\n        viewBox="0 0 20 20">\n        <title>ifttt</title>\n        <g id="Rectangle">\n          <rect x="0.6" y="0.9" class="st0" width="20" height="20" />\n        </g>\n        <g id="Stroke-1">\n          <path fill="#FFFFFF"; class="st1"\n            d="M14,7.2c-0.3,0-0.5-0.2-0.5-0.5V3.4c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v3.3C14.5,7,14.2,7.2,14,7.2z" />\n        </g>\n        <g id="Stroke-3">\n          <path fill="#FFFFFF"; class="st1"\n            d="M7.3,7.2C7,7.2,6.8,7,6.8,6.7V3.4c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v3.3C7.8,7,7.6,7.2,7.3,7.2z" />\n        </g>\n        <g id="Stroke-5">\n          <path fill="#FFFFFF"; class="st1"\n            d="M18.1,9.7h-15c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h15c0.3,0,0.5,0.2,0.5,0.5S18.4,9.7,18.1,9.7z" />\n        </g>\n        <g id="Stroke-7">\n          <path fill="#FFFFFF"; class="st1" d="M16.5,19.7H4.8c-1.2,0-2.2-1-2.2-2.2V6.7c0-1.2,1-2.2,2.2-2.2h11.7c1.2,0,2.2,1,2.2,2.2v10.8\nC18.6,18.8,17.7,19.7,16.5,19.7z M4.8,5.6c-0.6,0-1.2,0.5-1.2,1.2v10.8c0,0.6,0.5,1.2,1.2,1.2h11.7c0.6,0,1.2-0.5,1.2-1.2V6.7\nc0-0.6-0.5-1.2-1.2-1.2H4.8z" />\n        </g>\n        <g id="Stroke-9">\n          <path fill="#FFFFFF"; class="st1" d="M10.6,13.3c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5s0.3-0.2,0.5-0.2h0h0c0.4,0,0.7,0.3,0.7,0.7\nS11,13.3,10.6,13.3z" />\n        </g>\n        <g id="Stroke-11">\n          <path fill="#FFFFFF"; class="st1" d="M14.8,13.3c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5c0.1-0.1,0.3-0.2,0.5-0.2c0.4,0,0.7,0.3,0.7,0.7\nS15.2,13.3,14.8,13.3z M14.8,12.3c-0.2,0-0.3,0.1-0.3,0.3c0,0.2,0.3,0.4,0.5,0.2c0.1-0.1,0.1-0.1,0.1-0.2\nC15.1,12.4,15,12.3,14.8,12.3z" />\n        </g>\n        <g id="Stroke-13">\n          <path fill="#FFFFFF"; class="st1" d="M6.5,16.6c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5c0.1-0.1,0.3-0.2,0.5-0.2h0h0c0.4,0,0.7,0.3,0.7,0.7\nC7.2,16.3,6.9,16.6,6.5,16.6z" />\n        </g>\n        <g id="Stroke-15">\n          <path fill="#FFFFFF"; class="st1" d="M10.6,16.6c-0.4,0-0.7-0.3-0.7-0.7c0-0.2,0.1-0.4,0.2-0.5c0.1-0.1,0.3-0.2,0.5-0.2h0h0c0.4,0,0.7,0.3,0.7,0.7\nC11.4,16.3,11,16.6,10.6,16.6z" />\n        </g>\n      </svg>\n    </span>\n  </div>\n</label>\n<input data-toggle="').concat(this.jSPlugin.id,'-datepicker" id="').concat(this.jSPlugin.id,'-datepicker" name="').concat(this.jSPlugin.id,'-datepicker" style="opacity:0;width:24px;margin-left:-24px;cursor:pointer;" />\n');c.innerHTML=p,u(c,r),this.timeLine=new I(this.jSPlugin),this.timeLine.init({id:this.jSPlugin.id+"-canvas",width:o,onChange:function(e){console.log("time",e,new Date(e).Format("yyyyMMddhhmmss"));var t=new Date(e).Format("yyyyMMddhhmmss");if("cloud.rec"===f(i.jSPlugin.url).type){var n=function(){i.jSPlugin.seek(t.substr(8,6),"235959"),i.unSyncTimeLine(),setTimeout((function(){i.syncTimeLine()}),6e3)};i.seekTimer?clearTimeout(i.seekTimer):n(),i.seekTimer=setTimeout((function(){n(),clearTimeout(i.seekTimer),i.seekTimer=null}),i.seekFrequency)}else{var o=function(){setTimeout((function(){i.disabled=!1}),i.seekFrequency)},r=function(e){i.disabled=!0,i.jSPlugin.pause().then((function(){console.log("暂停成功"),i.jSPlugin.resume(t).then((function(t){console.log("恢复成功"),i.jSPlugin.Theme&&i.jSPlugin.Theme.setDecoderState({play:!0}),e&&e()})).catch((function(e){console.log("恢复失败",e)}))})).catch((function(){console.log("暂停失败"),i.jSPlugin.resume(t).then((function(t){console.log("恢复成功"),i.jSPlugin.Theme&&i.jSPlugin.Theme.setDecoderState({play:!0}),e&&e()})).catch((function(e){console.log("恢复失败",e)}))}))};i.disabled?(console.log("操作频繁，等待2秒后执行"),i.seekTimer&&clearTimeout(i.seekTimer),i.seekTimer=setTimeout((function(){r(o)}),i.seekFrequency)):r(o)}}}),this.syncTimeLine(),s("".concat(this.jSPlugin.staticPath,"/rec/datepicker.min.css")),d("".concat(this.jSPlugin.staticPath,"/rec/jquery.min.js"),(function(){d("".concat(i.jSPlugin.staticPath,"/rec/datepicker.js"),(function(){d("".concat(i.jSPlugin.staticPath,"/rec/datepicker.zh-CN.js"),(function(){document.getElementsByClassName("datepicker-container")[0]||$("#".concat(i.jSPlugin.id,"-datepicker")).datepicker({autoShow:!1,autoHide:!0,autoPick:!0,language:"zh-CN",defaultDate:new Date,format:"yyyy-mm-dd",endDate:new Date,inline:!0,container:document.getElementById("".concat(i.jSPlugin.id,"-wrap"))}),document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="none"),i.datepickerVisible=!1,$("#".concat(i.jSPlugin.id,"-datepicker")).on("pick.datepicker",(function(e){console.log("重新选择日期",e.date,new Date(e.date).Format("yyyyMMdd"),new Date(document.getElementById("".concat(i.jSPlugin.id,"-datepicker")).value).Format("yyyyMMdd")),e.date>new Date||new Date(e.date).Format("yyyyMMdd")===new Date(document.getElementById("".concat(i.jSPlugin.id,"-datepicker")).value).Format("yyyyMMdd")?e.preventDefault():(i.renderRec(e.date),i.jSPlugin.changePlayUrl({begin:new Date(e.date).Format("yyyyMMdd")})),document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="none"),i.datepickerVisible=!1})),$("#".concat(i.jSPlugin.id,"-datepicker")).off("click").on("click",(function(e){console.log("点击日期"),i.datepickerVisible?document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="none"):document.getElementsByClassName("datepicker-container")[0]&&(document.getElementsByClassName("datepicker-container")[0].style.display="inline"),i.datepickerVisible=!i.datepickerVisible}))}))}))})),document.getElementById("".concat(this.jSPlugin.id,"-timeline-scale-add")).onclick=function(){i.currentTimeWidth<3&&i.timeLine.changeSize(++i.currentTimeWidth)},document.getElementById("".concat(this.jSPlugin.id,"-timeline-scale-sub")).onclick=function(){i.currentTimeWidth>0&&i.timeLine.changeSize(--i.currentTimeWidth)};var m=l("begin",this.jSPlugin.url)||(new Date).Format("yyyyMMdd");this.renderRec("".concat(m.slice(0,4),"-").concat(m.slice(4,6),"-").concat(m.slice(6,8))),this.observer=new MutationObserver((function(e,t){i.recAutoSize()}));var h=document.getElementById("".concat(this.jSPlugin.id));this.observer.observe(h,{attributes:!0,attributeOldValue:!0,attributeFilter:["style"]})}return o(e,[{key:"recAutoSize",value:function(){var e=this;if(document.getElementById("".concat(this.jSPlugin.id,"-canvas"))){var t=parseInt(getComputedStyle(document.getElementById(this.jSPlugin.id)).width,10)-100;t!==parseInt(document.getElementById("".concat(this.jSPlugin.id,"-canvas")).width)&&(document.getElementById("".concat(this.jSPlugin.id,"-canvas")).width=t,this.timeLine.init({id:"".concat(this.jSPlugin.id,"-canvas"),width:t,onChange:function(t){console.log("time",t,new Date(t).Format("yyyyMMddhhmmss")),console.log("jSPlugin",e.jSPlugin);var n=new Date(t).Format("yyyyMMddhhmmss");e.jSPlugin.changePlayUrl({begin:n})}}),this.renderRec(this.date))}}},{key:"renderRec",value:function(e){var t=this;this.date=e;var n=new Date(new Date(e).Format("yyyy-MM-dd 00:00:00").replace(/-/g,"/")).getTime(),i=new Date(new Date(e).Format("yyyy-MM-dd 23:59:59").replace(/-/g,"/")).getTime();this.timeLine.getRecord([],n,i);var o={accessToken:this.jSPlugin.accessToken,recType:"cloud.rec"===f(this.jSPlugin.url).type?1:2,deviceSerial:f(this.jSPlugin.url).deviceSerial,channelNo:f(this.jSPlugin.url).channelNo,startTime:n,endTime:i,version:"2.0"},r=this.jSPlugin.env.domain+"/api/lapp/video/by/time";v(r,"POST",o,0,(function(e){if(e.data&&e.data.files&&e.data.files.length>0){var r=e.data.files,a=(new Date).getTime();if(e.data.isAll)t.timeLine.getRecord(r,n,i);else{!function e(){o.startTime=a,v(this.jSPlugin.env.domain+"/api/lapp/video/by/time","POST",o,0,(function(t){t.data&&t.data.files&&t.data.files.length>0?0==t.data.isAll?(t.data.files&&(r=r.concat(t.data.files)),a=t.data.nextFileTime>0?t.data.nextFileTime:(new Date).getTime(),e()):(console.log("云存储执行渲染片段"),this.timeLine.getRecord(r,n,i)):this.timeLine.getRecord(r,n,i)}))}()}t.timeLine.run({time:new Date(n)})}else e.data&&e.data.length>0&&(console.log("获取本地录像片段成功",e),t.timeLine.getRecord(e.data,n,i),t.timeLine.run({time:new Date(n)}))}))}},{key:"syncTimeLine",value:function(){var e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){e.jSPlugin.getOSDTime().then((function(t){var n=t.data;-1===n?console.log("获取播放时间错误"):n>0&&e.timeLine.run({time:new Date(n>1e12?n:1e3*n)})})).catch((function(e){}))}),1e3)}},{key:"unSyncTimeLine",value:function(){this.timer&&clearInterval(this.timer)}}]),e}(),_=function(e){console.log("执行TimeLine - params",e),this.state={id:e.id,start:"00:00:00",end:"24:00:00",current:0,timelag:30,timeArr:[],availTimeLine:[],scrollTop:0,index:0,date:"",noTimeLineTxt:"",disabled:!1};var t=this;this.setState=function(e){Object.keys(e).forEach((function(n){t.state[n]=e[n],"scrollTop"===n&&document.getElementById("time-line-item").parentNode.scrollTo(0,e[n]),"current"===n&&(document.getElementById("time-line-current").innerHTML=e[n])}))},this.setDisabled=function(e){this.setState({disabled:e}),document.getElementById("time-line-item").parentNode.style.overflowY=e?"hidden":"scroll"},this.timeToSecond=function(e){var t=e.split(":"),n=Number(t[0]),i=Number(t[1]),o=Number(t[2]);return 60*n*60+60*i+(o||0)},this.minuteToTime=function(e){var t=Math.floor(e/60),n=e%60;return(t>9?t:"0"+t)+":"+(n>9?n:"0"+n)},this.timeToMinute=function(e){var t=e.split(":");return 60*Number(t[0])+Number(t[1])},this.getPalyParam=e.getPalyParam,document.getElementById("time-line-item").parentNode.ontouchstart=function(){if(t.state.disabled)return!1;e.ontouchstart()},document.getElementById("time-line-item").parentNode.ontouchmove=function(){if(t.state.disabled)return!1;e.ontouchmove()},document.getElementById("time-line-item").parentNode.ontouchend=function(){if(t.state.disabled)return!1;var n;new Promise((function(e,t){var i=-1;n=setInterval((function(){var t=document.getElementById("time-line-item").parentNode.scrollTop;t!==i?(console.log("scolling",t,i),i=t):(console.log("scoll stop",t,i),clearInterval(n),e(t))}),100)})).then((function(e){console.log("scollPromise: then",e,t),t.rectTopTotime(e),console.log("页面滚动实际高度",e,t.state),t.getPalyParam({current:t.state.current})})),e.ontouchend()},this.matchTimeDot()};_.prototype.changeScale=function(e){this.setState({timelag:e}),this.matchTimeDot()},_.prototype.setDateLine=function(e,t){e.length>0?(void 0===t&&(t=e.length-1),this.setState({availTimeLine:e,start:e[t].st,end:e[t].et,current:e[t].st}),console.log("this.state",this.state),this.matchRecTimeDot(),this.primaryOffsetH()):(this.setState({availTimeLine:[]}),console.log("this.state",this.state),this.matchRecTimeDot())},_.prototype.matchTimeDot=function(){var e=this.state,t=e.start,n=e.end,i=e.timelag;e.availTimeLine,console.log("start",t,"end",n);for(var o=[],r=this.timeToMinute(n),a=r=Math.floor(r/i)*i;a>=0;){var d=0,s=0;a==r&&(d=70),0==a&&(s=230);var c=this.minuteToTime(a);o.push({id:a,current:c,label:"a"+a,marginTop:d,marginBottom:s,recArr:[]}),a-=i}this.setState({timeArr:o}),this.renderDateLine()},_.prototype.matchRecTimeDot=function(){var e=this.state,t=e.start,n=e.end,i=e.timelag,o=e.availTimeLine,r=e.timeArr;console.log("start",t,"end",n);var a=[],d=o.length;if(0===d)for(var s=0;s<r.length;s++)r[s].recArr=[];else for(var c=0;c<d;c++){var l,u,p,m,h=o[c],f=this.timeToSecond(h.st),v=this.timeToSecond(h.et);p=(f-60*(l=Math.floor(f/(60*i))*i))/i,m=(v-60*(u=Math.floor(v/(60*i))*i))/i,a[c]={st:l,et:u,stAvailPercent:p,etAvailPercent:m};for(s=0;s<r.length;s++)if(r[s].id==l&&r[s].id==u){var g=m-p,y=60-m;r[s].recArr.push({height:g,top:y})}else r[s].id==l?r[s].recArr.push({height:60-p,top:0}):r[s].id==u?r[s].recArr.push({height:m,top:60-m}):r[s].id>l&&r[s].id<u&&r[s].recArr.push({height:60,top:0})}console.log("availArr: ",a),this.setState({timeArr:r}),console.log("timeArr:",this.state),this.renderDateLine()},_.prototype.renderDateLine=function(){var e=this.state,t=e.id,n=e.timeArr;console.log("id,timeArr",t,n);var i=document.getElementById("time-line-item");i.innerHTML="",n.forEach((function(e,t){var n=document.createElement("div");n.setAttribute("class","time-item"),n.style="margin-top: ".concat(e.marginTop,"px; margin-bottom: ").concat(e.marginBottom,"px; border-right-color: ").concat(e.borderColor,";"),document.createElement("div").setAttribute("class","scale");var o='<div class="scale"></div><div class="scale"></div><div class="scale"></div><div class="scale"></div><div class="scale"></div><div class="scale" style="width:10px"></div>';e.recArr.forEach((function(e,t){o+='<div class="item-unavail" style="height: '.concat(e.height,"px;background-color:#A8B9ED; top: ").concat(e.top,'px"></div>')})),o+="<div id=".concat(e.label,' style="position: relative; top: 51px; left: 40%"> ').concat(e.current,"</div>"),n.innerHTML=o,i.appendChild(n)}))},_.prototype.primaryOffsetH=function(){var e=this.state,t=e.start,n=e.timelag,i=e.timeArr[0].current,o=this.timeToSecond(i)-this.timeToSecond(t),r=Math.ceil(o/n)+60;this.setState({scrollTop:r}),console.log("起始偏移量",r)},_.prototype.currentOffsetH=function(){var e=this.state,t=e.current,n=e.timelag,i=e.timeArr[0].current,o=this.timeToSecond(i)-this.timeToSecond(t),r=Math.ceil(o/n)+60;this.setState({scrollTop:r})},_.prototype.rectTopTotime=function(e){var t,n,i=this.state.timelag,o=Math.floor(e/60),r=e-60*o;if(console.log("index：",o,"offsetH:",r),0==r)t=this.state.timeArr[o-1].current,n=0;else{var a=this.state.timeArr[o].current,d=this.timeToMinute(a),s=(60-r)*i,c=Math.floor(s/60)+d,l=60*Math.floor(s/60);n=Math.ceil(s-l),t=this.minuteToTime(c)}this.setState({current:t+":"+(n>9?n:"0"+n),scrollTop:e})},_.prototype.stepScrollTimeLine=function(e){this.setState({current:e}),this.currentOffsetH()},_.prototype.secondCountDown=function(e){var t=this.state.current.split(":"),n=60*Number(t[0])*60+60*Number(t[1])+Number(t[2])+1,i=Math.floor(n/3600),o=Math.floor((n-3600*i)/60),r=n-3600*i-60*o;this.setState({current:(i>9?i:"0"+i)+":"+(o>9?o:"0"+o)+":"+(r>9?r:"0"+r)})};var j=_;function R(e){var t=new Date(e),n=t.getHours(),i=t.getMinutes(),o=t.getSeconds();return(n>9?n:"0"+n)+":"+(i>9?i:"0"+i)+":"+(o>9?o:"0"+o)}Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var M=function(){function e(t){var i=this;n(this,e),this.jSPlugin=t,this.timer=null,this.date=(new Date).Format("yyyy-MM-dd"),this.begin=((new Date).Format("yyyy-MM-dd")+" 00:00:00").replace(/-/g,"/"),this.end=((new Date).Format("yyyy-MM-dd")+" 23:59:59").replace(/-/g,"/"),this.initBegin=null,this.initEnd=null,this.type=f(this.jSPlugin.url).type,this.operating=!1,this.seekTimer=null,this.disabled=!1,this.seekFrequency=2e3,this.jSPlugin.params&&this.jSPlugin.params.seekFrequency&&(this.seekFrequency=this.jSPlugin.params.seekFrequency);var o=document.createElement("style");if(o.innerHTML='\n    body{\n      padding: 0;\n      margin: 0;\n    }\n    .time-line-container {\n      text-align: left;\n      height: 300px;\n      /* outline: 1px solid red; */\n      /* background: gray; */\n      position: relative;\n      /* padding-top: 60px; */\n      margin-top: 20px;\n    }\n\n    .time-line-container .time-line-item-container {\n      display: inline-block;\n      /* height: 400px; */\n      width: 30%;\n      /* background: indianred; */\n      overflow-y: scroll;\n      overflow-x: hidden;\n      /* padding-top: 60px; */\n      height: 300px;\n      box-sizing: border-box;\n      white-space: nowrap;\n      position: relative;\n    }\n\n    .time-line-container .time-line-item-container::-webkit-scrollbar {\n      width: 0px;\n      /*滚动条宽度*/\n      height: 0px;\n      /*滚动条高度*/\n    }\n\n    .time-line-item .time-item {\n      position: relative;\n      box-sizing: border-box;\n      height: 60px;\n      font-size: 12px;\n      color: rgb(150, 150, 150);\n      border-right: 6px solid;\n      border-right-color: #ddd;\n    }\n\n    .time-line-item .time-item .scale {\n      width: 6px;\n      height: 9px;\n      border-bottom: 1px solid #ccc;\n      float: right;\n      clear: both;\n    }\n\n    .time-line-item .time-item .item-unavail {\n      width: 6px;\n      position: absolute;\n      left: 100%;\n      background-color: #ddd;\n    }\n\n    .time-line-container .current-time {\n      position: absolute;\n      left: 0;\n      top: 40px;\n      height: 29px;\n      /* line-height: 58px; */\n      border-bottom: 1px solid #648FFC;\n      width: 60%;\n      margin-left: 26%;\n    }\n\n    .time-line-container .current-time .current-time-bg {\n      position: relative;\n      top: 15px;\n      width: 100px;\n      height: 29px;\n      line-height: 29px;\n      left: -70px;\n      font-size: 12px;\n      color: #2C2C2C;\n    }\n\n    .time-line-container .current-time .current-time-bg::before {\n      content: \'\';\n      display: inline-block;\n      width: 6px;\n      height: 6px;\n      border-radius: 100%;\n      background: #648FFC;\n      top: 11px;\n      position: absolute;\n      right: 30px;\n    }\n\n    .date-switch-container {\n      height: 40px;\n      position: relative;\n      text-align: center;\n      margin: 20px 10px;\n    }\n\n    .date-switch-container .current-date {\n      line-height: 40px;\n      height: 22px;\n      font-size: 16px;\n      color: #2C2C2C;\n      text-align: center;\n      font-weight: bold;\n    }\n\n    .date-container {\n      width: 40px;\n      height: 40px;\n      position: absolute;\n      right: 0;\n      top: 0;\n    }\n\n    .rec-type-container {\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .rec-type-container .rec-type-text {\n      padding: 0 15px;\n      font-size: 12px;\n      color: #2C2C2C;\n    }\n\n    .rec-type-container .rec-type-switch {\n      padding: 0 20px;\n    }\n\n    .date-container input {\n      position: absolute;\n      opacity: 0;\n      display: inline-block;\n      width: 40px;\n      height: 40px;\n      z-index: 10;\n      left: 0;\n    }\n\n    .date-container label {\n      position: absolute;\n      left: 0;\n      top: 0;\n      /* display: none; */\n      z-index: 0;\n    }\n\n    .date-icon {\n      display: inline-block;\n      width: 40px;\n      height: 40px;\n      background: url(\'https://resource.eziot.com/group2/M00/00/6A/CtwQF2F6VieAQrU9AAABP-_Nsqo949.png\') no-repeat 100% 100%;\n    }\n    .select-container {\n      padding: 10px;\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .advice {\n      height: 24px;\n      width: 70px;\n      display: flex;\n      justify-content: space-between;\n      line-height: 24px;\n      background: #F8F8F8;\n      border-radius: 8px;\n    }\n\n    .advice span {\n      width: 40px;\n      display: inline-block;\n    }\n\n    input[type="checkbox"]:not(:checked)+.advice span:first-child {\n      box-shadow: 0px 2px 5px 0px rgb(23 45 101 / 20%);\n      border-radius: 8px;\n      text-align: center;\n\n    }\n\n    input[type="checkbox"]:checked+.advice span:last-child {\n      box-shadow: 0px 2px 5px 0px rgb(23 45 101 / 20%);\n      border-radius: 8px;\n      text-align: center;\n    }\n\n    input[type="checkbox"]:not(:checked)+.advice span:first-child svg {\n      fill: #648FFC !important;\n    }\n\n    input[type="checkbox"]:checked+.advice span:last-child svg {\n      fill: #648FFC !important;\n    }',document.getElementsByTagName("head")[0].appendChild(o),l("begin",this.jSPlugin.url)){var r=l("begin",this.jSPlugin.url);this.date=r.slice(0,4)+"/"+r.slice(4,6)+"/"+r.slice(6,8),this.begin=this.date+" ".concat(r.slice(8,10)||"00",":").concat(r.slice(10,12)||"00",":").concat(r.slice(12,14)||"00"),this.end=this.date+" 23:59:59",this.initBegin=this.begin}if(l("end",this.jSPlugin.url)){var a=l("end",this.jSPlugin.url);this.end=this.date+" ".concat(a.slice(8,10)||"23",":").concat(a.slice(10,12)||"59",":").concat(a.slice(12,14)||"59"),this.initEnd=this.end}var d=document.createElement("div");d.id="date-switch-container-wrap",d.className="date-switch-container-wrap",d.style="",d.innerHTML='\n      <div class="date-switch-container">\n      <div class="current-date" id="current-date">今日录像</div>\n      <div class="date-container">\n        <label for="date">\n          <div class="date-icon"></div>\n        </label>\n        <input type="date" name="date" id="date" />\n      </div>\n    </div>\n        ',u(d,document.getElementById("".concat(this.jSPlugin.id,"-wrap")));var s=document.createElement("div");s.id="rec-type-container-wrap",s.className="rec-type-container-wrap",s.style="",s.innerHTML='\n    <div class="rec-type-container">\n    <div class="rec-type-text">共个<span id="recCount">0</span>录像</div>\n    <div class="rec-type-switch">\n      <label>\n        <input type="checkbox" name="type" id="cloudType" value="1" hidden />\n        <label for="cloudType" class="advice">\n          <span>\n          <svg fill="#CCCCCC" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="2 0 20 20">\n            <path class="st0" d="M12.6,5c-2.3,0.1-4.3,1.4-5.3,3.3L7.2,8.6c-2.4,0.5-4.1,2.5-4.1,4.9c0,2.8,2.4,5,5.2,5h9.9\n            c2.4,0,4.3-1.9,4.3-4.2l0-0.2c-0.1-2-1.6-3.5-3.5-3.9l-0.1,0l0-0.2c-0.4-2.8-3-5-6.1-5L12.6,5z"/>\n          </svg>\n        </span>\n        <span>\n          <svg fill="#CCCCCC" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="2 0 20 20">\n            <path id="形状结合" class="st0" d="M14.3,4c0.6,0,1.2,0.2,1.7,0.7l0,0L18.3,7C18.7,7.4,19,8,19,8.6l0,0v9c0,1.3-1.1,2.3-2.4,2.3\n\tl0,0H8.4C7.1,20,6,19,6,17.7l0,0V6.3C6,5,7.1,4,8.4,4l0,0H14.3z M9.7,7.2C9.3,7.2,8.9,7.6,8.9,8l0,0v2.5l0,0.1\n\tc0,0.4,0.4,0.6,0.7,0.6c0.4,0,0.8-0.3,0.8-0.8l0,0V8l0-0.1C10.4,7.5,10,7.2,9.7,7.2z M12.2,7.2c-0.4,0-0.8,0.3-0.8,0.8l0,0v2.5\n\tl0,0.1c0,0.4,0.4,0.6,0.7,0.6c0.4,0,0.8-0.3,0.8-0.8l0,0V8l0-0.1C12.9,7.5,12.5,7.2,12.2,7.2z M14.7,7.2c-0.4,0-0.8,0.3-0.8,0.8l0,0\n\tv2.5l0,0.1c0,0.4,0.4,0.6,0.7,0.6c0.4,0,0.8-0.3,0.8-0.8l0,0V8l0-0.1C15.4,7.5,15,7.2,14.7,7.2z"/>\n          </svg>\n        </span>\n        </label>\n      </label>\n    </div>\n  </div>\n        ',u(s,d);var c=document.createElement("div");c.id="mobile-rec-wrap",c.className="mobileRec-wrap",c.style="",c.innerHTML='\n    <div class="time-line-container">\n    <div class="current-time">\n      <div class="current-time-bg" id="time-line-current">2020-01-01 00:00:00</div>\n    </div>\n    <div class="time-line-item-container">\n      <div class="time-line-item" id="time-line-item">\n      </div>\n    </div>\n    </div>\n      ',u(c,s);this.TimeLineOBJ=new j({id:"time-line-item",getPalyParam:function(e){console.log("子组件传值到父组件",e,e.current);var t=e.current,n=new Date(i.date).Format("yyyyMMdd").substr(0,8)+(e.current?t.replace(/:/g,""):e.current.replace(/:/g,""));if(i.initBegin&&new Date("".concat(i.date," ").concat(e.current)).getTime()<new Date(i.initBegin).getTime()&&(console.log("超过限制最低值"),n=new Date(i.initBegin).Format("yyyyMMddhhmmss")),i.initEnd&&new Date("".concat(i.date," ").concat(e.current)).getTime()>new Date(i.initEnd).getTime()&&(console.log("超过限制最高值"),n=new Date(i.initBegin).Format("yyyyMMddhhmmss")),"cloud.rec"===i.type){var o=function(){i.jSPlugin.seek(n.substr(8,6),"235959"),setTimeout((function(){i.syncTimeLine()}),6e3)};i.seekTimer?clearTimeout(i.seekTimer):o(),console.log("this.jsPlug",i.jSPlugin.params),i.seekTimer=setTimeout((function(){o(),clearTimeout(i.seekTimer),i.seekTimer=null}),i.seekFrequency)}else{var r=function(){setTimeout((function(){i.disabled=!1}),i.seekFrequency)},a=function(e){i.disabled=!0,i.jSPlugin.pause().then((function(){console.log("暂停成功"),i.jSPlugin.resume(n).then((function(t){console.log("恢复成功"),i.jSPlugin.Theme&&i.jSPlugin.Theme.setDecoderState({play:!0}),i.syncTimeLine(),e&&e()}))})).catch((function(){console.log("暂停失败"),i.jSPlugin.resume(n).then((function(t){console.log("恢复成功"),i.jSPlugin.Theme&&i.jSPlugin.Theme.setDecoderState({play:!0}),i.syncTimeLine(),e&&e()}))}))};i.disabled?(console.log("操作频繁，等待2秒后执行"),i.seekTimer&&clearTimeout(i.seekTimer),i.seekTimer=setTimeout((function(){a(r)}),i.seekFrequency)):a(r)}},ontouchstart:function(){i.operating=!0,i.unSyncTimeLine()},ontouchmove:function(){},ontouchend:function(){i.operating=!1,console.log("ontouchend")}}),this.fetchDeviceRec(),document.getElementById("date").addEventListener("change",(function(e){if(console.log("日期变化",e.target.value),i.initBegin||i.initEnd)return console.log("您开启了时间限制，无法切换日期"),!1;i.date=new Date(e.target.value).Format("yyyy/MM/dd"),i.begin=i.date+" 00:00:00",i.end=i.date+" 23:59:59",i.fetchDeviceRec(),i.jSPlugin.changePlayUrl({type:i.type,begin:"".concat(new Date(i.date).Format("yyyyMMdd"),"000000")})})),document.getElementById("cloudType").checked="rec"===this.type,document.getElementById("cloudType").addEventListener("change",(function(e){var t=e.target.checked?2:1;i.type=e.target.checked?"rec":"cloud.rec",console.log("recType",t),i.fetchDeviceRec(),i.jSPlugin.changePlayUrl({type:i.type,begin:"".concat(new Date(i.date).Format("yyyyMMdd"),"000000")}).then((function(){console.log("切换类型成功"),i.syncTimeLine()}),(function(e){console.log("err",e)})).catch((function(e){console.log(e)}))})),this.syncTimeLine()}return o(e,[{key:"fetchDeviceRec",value:function(){var e=this,t=function(t){var n=t.length;document.getElementById("recCount").innerHTML=n;for(var i=[],o=n-1;o>=0;o--){var r=t[o],a=R(r.endTime),d=R(r.startTime);i.push({st:d,et:a})}e.TimeLineOBJ.setDateLine(i)},n=new FormData;n.append("deviceSerial",f(this.jSPlugin.url).deviceSerial),n.append("channelNo",f(this.jSPlugin.url).channelNo),n.append("accessToken",this.jSPlugin.accessToken),n.append("recType","cloud.rec"===this.type?1:2),n.append("startTime",new Date(this.begin).getTime()),n.append("endTime",new Date(this.end).getTime()),fetch(this.jSPlugin.env.domain+"/api/lapp/video/by/time",{method:"POST",body:n}).then((function(e){return e.json()})).then((function(e){if(200==e.code&&e.data){var n;n=e.data,t(n)}else t([])}))}},{key:"syncTimeLine",value:function(){var e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){if(e.operating)return console.log("操作中"),!1;e.jSPlugin.getOSDTime().then((function(t){var n,i,o,r,a;t.data>0?e.TimeLineOBJ.stepScrollTimeLine((n=1e3*t.data,i=new Date(n),o=i.getHours(),r=i.getMinutes(),a=i.getSeconds(),(o>9?o:"0"+o)+":"+(r>9?r:"0"+r)+":"+(a>9?a:"0"+a))):console.log("未找到当前获取播放时间，等待中...")})).catch((function(e){console.log("未找到当前获取播放时间，等待中...")}))}),1e3)}},{key:"unSyncTimeLine",value:function(){this.timer&&clearInterval(this.timer)}}]),e}(),D=function(){function e(t){var i=this;if(n(this,e),this.jSPlugin=t,console.log("云台初始化"),document.getElementById(this.jSPlugin.id+"-ez-ptz-item"))return!1;var o=document.createElement("div");o.id=this.jSPlugin.id+"-ez-ptz-item",o.className="ez-ptz-wrap",o.style="display:none";var r=document.createElement("style");r.innerHTML="\n    .ez-ptz-container {\n      position: relative;\n      width: 80px;\n      height: 80px;\n      background: rgba(255, 255, 255, 0.80);\n      box-shadow: 0px 0px 33px 4px rgb(0 0 0 / 15%);\n      border: 1px solid rgba(255, 255, 255, 0.80);\n      border-radius: 100%;\n      cursor: pointer;\n      overflow: hidden;\n      user-select: none;\n    }\n    .ez-ptz-container .ez-ptz-icon.top {\n      width: 0;\n      height: 0;\n      border-left: 3px solid transparent;\n      border-right: 3px solid transparent;\n      border-bottom: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 3px);\n      top: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.top.active {\n      border-bottom-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.bottom {\n      width: 0;\n      height: 0;\n      border-left: 3px solid transparent;\n      border-right: 3px solid transparent;\n      border-top: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 3px);\n      bottom: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.bottom.active {\n      border-top-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.right {\n      width: 0;\n      height: 0;\n      border-top: 3px solid transparent;\n      border-bottom: 3px solid transparent;\n      border-left: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 3px);\n      right: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.right.active {\n      border-left-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.left {\n      width: 0;\n      height: 0;\n      border-top: 3px solid transparent;\n      border-bottom: 3px solid transparent;\n      border-right: 6px solid #333333;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 3px);\n      left: 2px;\n    }\n\n    .ez-ptz-container .ez-ptz-icon.left.active {\n      border-right-color: #1890FF;\n    }\n\n    .ez-ptz-container .ez-ptz-main.center {\n      width: 23px;\n      height: 23px;\n      background: #1890FF;\n      border-radius: 100%;\n      top: calc(50% - 12.3px);\n      left: calc(50% - 12.3px);\n      position: absolute;\n    }\n\n    .ez-ptz-wrap {\n      position: absolute;\n      right: 20px;\n      top: calc(50% - 50px);\n      width: 100px;\n      height: 100px;\n      z-index: 999;\n    }\n\n    .ez-ptz-close {\n      position: absolute;\n      color: #FFFFFF;\n      top: 0;\n      right: 0px;\n    }",document.getElementsByTagName("head")[0].appendChild(r),o.innerHTML='\n      <div class="ez-ptz-container" id="'.concat(this.jSPlugin.id,'-ez-ptz-container" style="position: relative;width: 80px;height: 80px;background: rgba(255, 255, 255, 0.80);box-shadow: 0px 0px 33px 4px rgba(0, 0, 0, 0.15);border: 1px solid rgba(255, 255, 255, 0.80);border-radius: 100%;cursor: pointer;overflow: hidden;user-select: none;">\n        <div class="ez-ptz-main center"></div>\n        <div class="ez-ptz-icon top active"></div>\n        <div class="ez-ptz-icon left active"></div>\n        <div class="ez-ptz-icon bottom active"></div>\n        <div class="ez-ptz-icon right active"></div>\n      '),document.getElementById("".concat(t.id,"-wrap")).appendChild(o),document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).onmousedown=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).onmouseup=function(e){e.preventDefault(),console.log("触摸结束"),i._handlePtzTouch(e,"stop")},document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).ontouchstart=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).ontouchend=function(e){e.preventDefault(),console.log("触摸结束",e),i._handlePtzTouch(e,"stop")}}return o(e,[{key:"show",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-item")).style="display: inline-block"}},{key:"hide",value:function(){document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-item")).style="display: none"}},{key:"_handlePtzTouch",value:function(e,t){var n=this,i=document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).getBoundingClientRect(),o=i.left+41,r=i.top+41,a=(e.x||e.changedTouches[0].clientX)-o,d=(e.y||e.changedTouches[0].clientY)-r,s=0,c=this.jSPlugin.env.domain+"/api/lapp/device/ptz/start";if(s=Math.abs(a)>Math.abs(d)?a>0?3:2:d>0?1:0,/^rotate\(90/.test(document.getElementById("".concat(this.jSPlugin.id,"-wrap")).style.transform))switch(s){case 0:s=2;break;case 1:s=3;break;case 2:s=1;break;case 3:s=0}document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).style="background-image:linear-gradient(".concat(0===s?180:1===s?0:2===s?90:270,"deg, #1d8dd8 0%, rgba(100,143,252,0.00) 30%)"),"stop"===t&&(c=this.jSPlugin.env.domain+"/api/lapp/device/ptz/stop",document.getElementById("".concat(this.jSPlugin.id,"-ez-ptz-container")).style="");var l=new FormData;l.append("deviceSerial",f(this.jSPlugin.url).deviceSerial),l.append("channelNo",f(this.jSPlugin.url).channelNo),l.append("speed",1),l.append("direction",s),l.append("accessToken",this.jSPlugin.accessToken),fetch(c,{method:"POST",body:l}).then((function(e){return e.json()})).then((function(e){200==e.code||60005!=e.code&&60002!=e.code&&60003!=e.code&&60004!=e.code||(document.getElementById("".concat(n.jSPlugin.id,"-ez-ptz-container")).style="background-image:linear-gradient(".concat(0===s?180:1===s?0:2===s?90:270,"deg, #f45656 0%, rgba(100,143,252,0.00) 30%)"))})).catch((function(e){console.log("云台调用异常",e)}))}}]),e}();!function(e){if("object"===("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}}((function(){return function e(t,n,i){function o(a,d){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!d&&s)return s(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){return o(t[a][1][e]||e)}),l,l.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){var i=(0,e("./adapter_factory.js").adapterFactory)({window:window});window.adapter=i,t.exports=i},{"./adapter_factory.js":2}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},c=i.log,l=i.detectBrowser(t),u={browserDetails:l,commonShim:s,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(l.browser){case"chrome":if(!o||!o.shimPeerConnection||!n.shimChrome)return c("Chrome shim is not included in this adapter release."),u;c("adapter.js shimming chrome."),u.browserShim=o,o.shimGetUserMedia(t),o.shimMediaStream(t),o.shimPeerConnection(t),o.shimOnTrack(t),o.shimAddTrackRemoveTrack(t),o.shimGetSendersWithDtmf(t),o.shimGetStats(t),o.shimSenderReceiverGetStats(t),o.fixNegotiationNeeded(t),s.shimRTCIceCandidate(t),s.shimConnectionState(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t),s.removeAllowExtmapMixed(t);break;case"firefox":if(!a||!a.shimPeerConnection||!n.shimFirefox)return c("Firefox shim is not included in this adapter release."),u;c("adapter.js shimming firefox."),u.browserShim=a,a.shimGetUserMedia(t),a.shimPeerConnection(t),a.shimOnTrack(t),a.shimRemoveStream(t),a.shimSenderGetStats(t),a.shimReceiverGetStats(t),a.shimRTCDataChannel(t),a.shimAddTransceiver(t),a.shimCreateOffer(t),a.shimCreateAnswer(t),s.shimRTCIceCandidate(t),s.shimConnectionState(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t);break;case"edge":if(!r||!r.shimPeerConnection||!n.shimEdge)return c("MS edge shim is not included in this adapter release."),u;c("adapter.js shimming edge."),u.browserShim=r,r.shimGetUserMedia(t),r.shimGetDisplayMedia(t),r.shimPeerConnection(t),r.shimReplaceTrack(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t);break;case"safari":if(!d||!n.shimSafari)return c("Safari shim is not included in this adapter release."),u;c("adapter.js shimming safari."),u.browserShim=d,d.shimRTCIceServerUrls(t),d.shimCreateOfferLegacy(t),d.shimCallbacksAPI(t),d.shimLocalStreamsAPI(t),d.shimRemoteStreamsAPI(t),d.shimTrackEventTransceiver(t),d.shimGetUserMedia(t),s.shimRTCIceCandidate(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t),s.removeAllowExtmapMixed(t);break;default:c("Unsupported browser!")}return u};var i=c(e("./utils")),o=c(e("./chrome/chrome_shim")),r=c(e("./edge/edge_shim")),a=c(e("./firefox/firefox_shim")),d=c(e("./safari/safari_shim")),s=c(e("./common_shim"));function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},r=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),i.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},i.shimOnTrack=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(i){var o=void 0;o=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.track.id})):{track:i.track};var r=new Event("track");r.track=i.track,r.receiver=o,r.transceiver={receiver:o},r.streams=[t.stream],n.dispatchEvent(r)})),t.stream.getTracks().forEach((function(i){var o=void 0;o=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.id})):{track:i};var r=new Event("track");r.track=i,r.receiver=o,r.transceiver={receiver:o},r.streams=[t.stream],n.dispatchEvent(r)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else d.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},i.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){var o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var d=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=d.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},i.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),i=n[0],o=n[1],r=n[2];if(arguments.length>0&&"function"==typeof i)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof i))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},d=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var s=function(e){o(d(a(e)))};return t.apply(this,[s,i])}return new Promise((function(n,i){t.apply(e,[function(e){n(d(a(e)))},i])})).then(o,r)}},i.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return d.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),d.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return d.filterStats(t,e.track,!1)}))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;var r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],n=void 0,i=void 0,o=void 0;return this.getSenders().forEach((function(e){e.track===t&&(n?o=!0:n=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(i?o=!0:i=e),e.track===t})),o||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}},i.shimAddTrackRemoveTrackWithNative=c,i.shimAddTrackRemoveTrack=function(e){if(!e.RTCPeerConnection)return;var t=d.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return c(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var o=new e.MediaStream(t.getTracks());this._streams[t.id]=o,this._reverseStreams[o.id]=t,t=o}i.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;function r(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],o=e._streams[i.id];n=n.replace(new RegExp(o.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function a(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],o=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var r=this.getSenders().find((function(e){return e.track===t}));if(r)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[n.id];if(a)a.addTrack(t),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var d=new e.MediaStream([t]);this._streams[n.id]=d,this._reverseStreams[d.id]=n,this.addStream(d)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=s({},t,(function(){var e=this,t=arguments,i=arguments.length&&"function"==typeof arguments[0];return i?n.apply(this,[function(n){var i=r(e,n);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return r(e,t)}))}));e.RTCPeerConnection.prototype[t]=i[t]}));var l=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=a(this,arguments[0]),l.apply(this,arguments)):l.apply(this,arguments)};var u=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=u.get.apply(this);return""===e.type?e:r(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach((function(i){t._streams[i].getTracks().find((function(t){return e.track===t}))&&(n=t._streams[i])})),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}},i.shimPeerConnection=function(e){var t=d.detectBrowser(e);!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection);if(!e.RTCPeerConnection)return;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=s({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},i.fixNegotiationNeeded=function(e){d.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))};var d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"));function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();n.apply(this,arguments);var o=this.getSenders().filter((function(e){return-1===i.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(o)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var i=t._shimmedLocalStreams[n].indexOf(e);-1!==i&&t._shimmedLocalStreams[n].splice(i,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),o.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;if("function"!=typeof t)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var i=n.video&&n.video.width,o=n.video&&n.video.height,r=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:r||3}},i&&(n.video.mandatory.maxWidth=i),o&&(n.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(n)}))}}},{}],5:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)};i.shimGetUserMedia=function(e){var t=e&&e.navigator;if(!t.mediaDevices)return;var n=r.detectBrowser(e),i=function(e){if("object"!==(void 0===e?"undefined":o(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"===o(e[n])?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var a={};"number"==typeof i.ideal?(a[r("min",n)]=i.ideal,t.optional.push(a),(a={})[r("max",n)]=i.ideal,t.optional.push(a)):(a[r("",n)]=i.ideal,t.optional.push(a))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach((function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},d=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===o(e.audio)){var d=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};d((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),d(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===o(e.video)){var s=e.video.facingMode;s=s&&("object"===(void 0===s?"undefined":o(s))?s:{ideal:s});var c=n.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||c)){delete e.video.facingMode;var l=void 0;if("environment"===s.exact||"environment"===s.ideal?l=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(l=["front"]),l)return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return l.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&l.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=i(e.video),a("chrome: "+JSON.stringify(e)),r(e)}))}e.video=i(e.video)}return a("chrome: "+JSON.stringify(e)),r(e)},s=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,i){d(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){i&&i(s(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var c=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return d(e,(function(e){return c(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(s(e))}))}))}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"));var a=r.log},{"../utils.js":15}],6:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)};i.shimRTCIceCandidate=function(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=d.default.parseCandidate(e.candidate),r=Object.assign(n,i);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))},i.shimMaxMessageSize=function(e){if(!e.RTCPeerConnection)return;var t=s.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){if(!e||!e.sdp)return!1;var t=d.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=d.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n},o=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},r=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=d.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),d=e.sdpSemantics;"plan-b"===d&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){var s=i(arguments[0]),c=o(s),l=r(arguments[0],s),u=void 0;u=0===c&&0===l?Number.POSITIVE_INFINITY:0===c||0===l?Math.max(c,l):Math.min(c,l);var p={};Object.defineProperty(p,"maxMessageSize",{get:function(){return u}}),this._sctp=p}return a.apply(this,arguments)}},i.shimSendThrowTypeError=function(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){var n=e.send;e.send=function(){var i=arguments[0],o=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return t(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",(function(e){return t(e.channel,e.target),e}))},i.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))},i.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection)return;var t=s.detectBrowser(e);if("chrome"===t.browser&&t.version>=71)return;var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}};var r,a=e("sdp"),d=(r=a)&&r.__esModule?r:{default:r},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),n.shimPeerConnection=function(e){var t=a.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,c.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,d.filterIceServers)(e.iceServers,t.version),a.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},n.shimReplaceTrack=function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var r,a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils")),d=e("./filtericeservers"),s=e("rtcpeerconnection-shim"),c=(r=s)&&r.__esModule?r:{default:r}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var o="string"==typeof t;return o&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=o?t[0]:t,!!t.length}}))};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],11:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.shimGetDisplayMedia=i.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},r=e("./getusermedia");Object.defineProperty(i,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(i,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),i.shimOnTrack=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},i.shimPeerConnection=function(e){var t=d.detectBrowser(e);if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection);t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}));if(t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),n=e[0],o=e[1],a=e[2];return r.apply(this,[n||null]).then((function(e){if(t.version<53&&!o)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(o,a)}},i.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},i.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});d.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},i.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;d.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))}},i.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},i.shimAddTransceiver=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var i=t.apply(this,arguments);if(n){var o=i.sender,r=o.getParameters();"encodings"in r||(r.encodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(r).catch((function(){}))))}return i})},i.shimCreateOffer=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}},i.shimCreateAnswer=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}};var d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)}}},{}],13:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)};i.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":o(e))&&"object"===o(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),d(e)},i&&i.prototype.getSettings){var s=i.prototype.getSettings;i.prototype.getSettings=function(){var e=s.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var c=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":o(e))&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)};i.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(i){return t.call(n,i,e)})),e.getVideoTracks().forEach((function(i){return t.call(n,i,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var i=e.getTracks();this.getSenders().forEach((function(e){i.includes(e.track)&&t.removeTrack(e)}))}})},i.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},i.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,a=t.setRemoteDescription,d=t.addIceCandidate;t.createOffer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[i]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],o=i.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o};var s=function(e,t,n){var i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=s,s=function(e,t,n){var i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=s,s=function(e,t,n){var i=d.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=s},i.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,i=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return i(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))},i.shimConstraints=a,i.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},i.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},i.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"));function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)};i.extractVersion=d,i.wrapPeerConnectionEvent=function(e,t,n){if(!e.RTCPeerConnection)return;var i=e.RTCPeerConnection.prototype,o=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return o.apply(this,arguments);var r=function(e){var t=n(e);t&&i(t)};return this._eventMap=this._eventMap||{},this._eventMap[i]=r,o.apply(this,[e,r])};var r=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return r.apply(this,arguments);var i=this._eventMap[n];return delete this._eventMap[n],r.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})},i.disableLog=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":o(e))+". Please use a boolean.");return r=e,e?"adapter.js logging disabled":"adapter.js logging enabled"},i.disableWarnings=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":o(e))+". Please use a boolean.");return a=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")},i.log=function(){if("object"===("undefined"==typeof window?"undefined":o(window))){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},i.deprecated=function(e,t){if(!a)return;console.warn(e+" is deprecated, please use "+t+" instead.")},i.detectBrowser=function(e){var t=e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=d(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=d(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=d(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=d(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},i.compactObject=function e(t){if(!s(t))return t;return Object.keys(t).reduce((function(n,i){var o=s(t[i]),r=o?e(t[i]):t[i],a=o&&!Object.keys(r).length;return void 0===r||a?n:Object.assign(n,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},i,r))}),{})},i.walkStats=c,i.filterStats=function(e,t,n){var i=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var r=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&r.push(e)})),r.forEach((function(t){e.forEach((function(n){n.type===i&&n.trackId===t.id&&c(e,n,o)}))})),o};var r=!0,a=!0;function d(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(i){i.endsWith("Id")?c(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((function(t){c(e,e.get(t),n)}))})))}},{}],16:[function(e,t,n){var i=e("sdp");function o(e,t,n,o,r){var a=i.writeRtpDescription(e.kind,t);if(a+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var d=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=d;var s="msid:"+(o?o.id:"-")+" "+d+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),a}function r(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},o=function(e,t,n,o){var r=i(e.parameters.apt,n),a=i(t.parameters.apt,o);return r&&a&&r.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(i){for(var r=0;r<t.codecs.length;r++){var a=t.codecs[r];if(i.name.toLowerCase()===a.name.toLowerCase()&&i.clockRate===a.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&a.parameters.apt&&!o(i,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(i.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var o=t.headerExtensions[i];if(e.uri===o.uri){n.headerExtensions.push(o);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function d(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function s(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function c(t,n,i,o){var r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=o,e.setTimeout((function(){t._dispatchEvent("track",r)}))}var l=function(n){var o=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){o[e]=r[e].bind(r)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw s("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"==typeof i;return o&&(i=[i]),i=i.filter((function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")})),delete e.url,e.urls=o?i[0]:i,!!i.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();i.iceTransport=o.iceTransport,i.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(i),i},l.prototype.addTrack=function(t,n){if(this._isClosed)throw s("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw s("InvalidAccessError","Track already exists.");for(var o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(i=this.transceivers[o]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),i.getTracks().forEach((function(e){n.addTrack(e,i)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw s("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw s("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;o.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},l.prototype._gather=function(t,n){var o=this,r=this.transceivers[n].iceGatherer;if(!r.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,r.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),r.onlocalcandidate=function(e){if(!(o.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var d=e.candidate,s=!d||0===Object.keys(d).length;if(s)"new"!==r.state&&"gathering"!==r.state||(r.state="completed");else{"new"===r.state&&(r.state="gathering"),d.component=1,d.ufrag=r.getLocalParameters().usernameFragment;var c=i.writeCandidate(d);a.candidate=Object.assign(a.candidate,i.parseCandidate(c)),a.candidate.candidate=c,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=i.getMediaSections(o._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=s?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",o._localDescription.sdp=i.getDescription(o._localDescription.sdp)+l.join("");var u=o.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),s||o._dispatchEvent("icecandidate",a),u&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){r.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,o){var a=r(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),o&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,o=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(s("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,o.signalingState)||o._isClosed)return Promise.reject(s("InvalidStateError","Can not set local "+e.type+" in state "+o.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=i.parseRtpParameters(e);o.transceivers[t].localCapabilities=n})),o.transceivers.forEach((function(e,t){o._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(o._remoteDescription.sdp),n=t.shift();var d=i.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=o.transceivers[t],s=a.iceGatherer,c=a.iceTransport,l=a.dtlsTransport,u=a.localCapabilities,p=a.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length)&&!a.rejected){var m=i.getIceParameters(e,n),h=i.getDtlsParameters(e,n);d&&(h.role="server"),o.usingBundle&&0!==t||(o._gather(a.mid,t),"new"===c.state&&c.start(s,m,d?"controlling":"controlled"),"new"===l.state&&l.start(h));var f=r(u,p);o._transceive(a,f.codecs.length>0,!1)}}))}return o._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(o){var l=this;if(-1===["offer","answer"].indexOf(o.type))return Promise.reject(s("TypeError",'Unsupported type "'+o.type+'"'));if(!a("setRemoteDescription",o.type,l.signalingState)||l._isClosed)return Promise.reject(s("InvalidStateError","Can not set remote "+o.type+" in state "+l.signalingState));var u={};l.remoteStreams.forEach((function(e){u[e.id]=e}));var p=[],m=i.splitSections(o.sdp),h=m.shift(),f=i.matchPrefix(h,"a=ice-lite").length>0,v=i.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=v;var g=i.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,m.forEach((function(a,s){var c=i.splitLines(a),m=i.getKind(a),g=i.isRejected(a)&&0===i.matchPrefix(a,"a=bundle-only").length,y=c[0].substr(2).split(" ")[2],C=i.getDirection(a,h),S=i.parseMsid(a),T=i.getMid(a)||i.generateIdentifier();if(g||"application"===m&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))l.transceivers[s]={mid:T,kind:m,protocol:y,rejected:!0};else{var b,w,P,k,E,I,x,_,j;!g&&l.transceivers[s]&&l.transceivers[s].rejected&&(l.transceivers[s]=l._createTransceiver(m,!0));var R,M,D=i.parseRtpParameters(a);g||(R=i.getIceParameters(a,h),(M=i.getDtlsParameters(a,h)).role="client"),x=i.parseRtpEncodingParameters(a);var A=i.parseRtcpParameters(a),B=i.matchPrefix(a,"a=end-of-candidates",h).length>0,z=i.matchPrefix(a,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===o.type||"answer"===o.type)&&!g&&v&&s>0&&l.transceivers[s]&&(l._disposeIceAndDtlsTransports(s),l.transceivers[s].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[s].iceTransport=l.transceivers[0].iceTransport,l.transceivers[s].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[s].rtpSender&&l.transceivers[s].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[s].rtpReceiver&&l.transceivers[s].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==o.type||g){if("answer"===o.type&&!g){w=(b=l.transceivers[s]).iceGatherer,P=b.iceTransport,k=b.dtlsTransport,E=b.rtpReceiver,I=b.sendEncodingParameters,_=b.localCapabilities,l.transceivers[s].recvEncodingParameters=x,l.transceivers[s].remoteCapabilities=D,l.transceivers[s].rtcpParameters=A,z.length&&"new"===P.state&&(!f&&!B||v&&0!==s?z.forEach((function(e){d(b.iceTransport,e)})):P.setRemoteCandidates(z)),v&&0!==s||("new"===P.state&&P.start(w,R,"controlling"),"new"===k.state&&k.start(M)),!r(b.localCapabilities,b.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&b.sendEncodingParameters[0].rtx&&delete b.sendEncodingParameters[0].rtx,l._transceive(b,"sendrecv"===C||"recvonly"===C,"sendrecv"===C||"sendonly"===C),!E||"sendrecv"!==C&&"sendonly"!==C?delete b.rtpReceiver:(j=E.track,S?(u[S.stream]||(u[S.stream]=new e.MediaStream),n(j,u[S.stream]),p.push([j,E,u[S.stream]])):(u.default||(u.default=new e.MediaStream),n(j,u.default),p.push([j,E,u.default])))}}else{(b=l.transceivers[s]||l._createTransceiver(m)).mid=T,b.iceGatherer||(b.iceGatherer=l._createIceGatherer(s,v)),z.length&&"new"===b.iceTransport.state&&(!B||v&&0!==s?z.forEach((function(e){d(b.iceTransport,e)})):b.iceTransport.setRemoteCandidates(z)),_=e.RTCRtpReceiver.getCapabilities(m),t<15019&&(_.codecs=_.codecs.filter((function(e){return"rtx"!==e.name}))),I=b.sendEncodingParameters||[{ssrc:1001*(2*s+2)}];var F,L=!1;if("sendrecv"===C||"sendonly"===C){if(L=!b.rtpReceiver,E=b.rtpReceiver||new e.RTCRtpReceiver(b.dtlsTransport,m),L)j=E.track,S&&"-"===S.stream||(S?(u[S.stream]||(u[S.stream]=new e.MediaStream,Object.defineProperty(u[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(j,"id",{get:function(){return S.track}}),F=u[S.stream]):(u.default||(u.default=new e.MediaStream),F=u.default)),F&&(n(j,F),b.associatedRemoteMediaStreams.push(F)),p.push([j,E,F])}else b.rtpReceiver&&b.rtpReceiver.track&&(b.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===b.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),b.associatedRemoteMediaStreams=[]);b.localCapabilities=_,b.remoteCapabilities=D,b.rtpReceiver=E,b.rtcpParameters=A,b.sendEncodingParameters=I,b.recvEncodingParameters=x,l._transceive(l.transceivers[s],!1,L)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===o.type?"active":"passive"),l._remoteDescription={type:o.type,sdp:o.sdp},"offer"===o.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(u).forEach((function(t){var n=u[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",i)}))}p.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&c(l,t,i,[n])}))}})),p.forEach((function(e){e[2]||c(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(s("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,d=arguments[0];if(d){if(d.mandatory||d.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==d.offerToReceiveAudio&&(r=!0===d.offerToReceiveAudio?1:!1===d.offerToReceiveAudio?0:d.offerToReceiveAudio),void 0!==d.offerToReceiveVideo&&(a=!0===d.offerToReceiveVideo?1:!1===d.offerToReceiveVideo?0:d.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--r<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));r>0||a>0;)r>0&&(n._createTransceiver("audio"),r--),a>0&&(n._createTransceiver("video"),a--);var c=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(o,r){var a=o.track,d=o.kind,s=o.mid||i.generateIdentifier();o.mid=s,o.iceGatherer||(o.iceGatherer=n._createIceGatherer(r,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(d);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),o.remoteCapabilities&&o.remoteCapabilities.codecs&&o.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(o.remoteCapabilities&&o.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=o.sendEncodingParameters||[{ssrc:1001*(2*r+1)}];a&&t>=15019&&"video"===d&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),o.wantReceive&&(o.rtpReceiver=new e.RTCRtpReceiver(o.dtlsTransport,d)),o.localCapabilities=c,o.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(c+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){c+=o(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),c+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,c+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(s("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(s("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var d=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,i){if(!(i+1>d)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var s;if(e.stream)"audio"===e.kind?s=e.stream.getAudioTracks()[0]:"video"===e.kind&&(s=e.stream.getVideoTracks()[0]),s&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var c=r(e.localCapabilities,e.remoteCapabilities);!c.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=o(e,c,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var c=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(c)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(o,r){if(!n._remoteDescription)return r(s("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var c=0;c<n.transceivers.length;c++)if(n.transceivers[c].mid===e.sdpMid){a=c;break}var l=n.transceivers[a];if(!l)return r(s("OperationError","Can not add ICE candidate"));if(l.rejected)return o();var u=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return o();if(u.component&&1!==u.component)return o();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!d(l.iceTransport,u))return r(s("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=i.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(u.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var m=0;m<n.transceivers.length&&(n.transceivers[m].rejected||(n.transceivers[m].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(n._remoteDescription.sdp))[m]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));m++);o()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw s("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var i;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[n]).type]||i.type,t.set(n,e[n])})),t}))}}}));var u=["createOffer","createAnswer"];return u.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:17}],17:[function(e,n,i){var o={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};o.localCName=o.generateIdentifier(),o.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},o.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},o.getDescription=function(e){var t=o.splitSections(e);return t&&t[0]},o.getMediaSections=function(e){var t=o.splitSections(e);return t.shift(),t},o.matchPrefix=function(e,t){return o.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},o.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},o.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},o.parseIceOptions=function(e){return e.substr(14).split(" ")},o.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},o.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},o.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},o.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},o.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<i.length;o++)n[(t=i[o].trim().split("="))[0].trim()]=t[1];return n},o.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},o.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},o.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},o.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},o.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},o.getMid=function(e){var t=o.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},o.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},o.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:o.matchPrefix(e+t,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},o.getIceParameters=function(e,t){var n=o.splitLines(e);return{usernameFragment:(n=n.concat(o.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},o.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},o.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=o.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var r=n[i],a=o.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(a){var d=o.parseRtpMap(a),s=o.matchPrefix(e,"a=fmtp:"+r+" ");switch(d.parameters=s.length?o.parseFmtp(s[0]):{},d.rtcpFeedback=o.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(o.parseRtcpFb),t.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(d.name.toUpperCase())}}}return o.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(o.parseExtmap(e))})),t},o.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=o.writeRtpMap(e),n+=o.writeFmtp(e),n+=o.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=o.writeExtmap(e)})),n},o.parseRtpEncodingParameters=function(e){var t,n=[],i=o.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),d=o.matchPrefix(e,"a=ssrc:").map((function(e){return o.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),s=d.length>0&&d[0].ssrc,c=o.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===s&&(t=c[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&t&&(i.rtx={ssrc:t}),n.push(i),r&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(i))}})),0===n.length&&s&&n.push({ssrc:s});var l=o.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},o.parseRtcpParameters=function(e){var t={},n=o.matchPrefix(e,"a=ssrc:").map((function(e){return o.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=o.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var r=o.matchPrefix(e,"a=rtcp-mux");return t.mux=r.length>0,t},o.parseMsid=function(e){var t,n=o.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=o.matchPrefix(e,"a=ssrc:").map((function(e){return o.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},o.parseSctpDescription=function(e){var t,n=o.parseMLine(e),i=o.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var r=o.matchPrefix(e,"a=sctp-port:");if(r.length>0)return{port:parseInt(r[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(o.matchPrefix(e,"a=sctpmap:").length>0){var a=o.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},o.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,21)},o.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||o.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},o.writeMediaSection=function(e,t,n,i){var r=o.writeRtpDescription(e.kind,t);if(r+=o.writeIceParameters(e.iceGatherer.getLocalParameters()),r+=o.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),r+="a=mid:"+e.mid+"\r\n",e.direction?r+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?r+="a=sendrecv\r\n":e.rtpSender?r+="a=sendonly\r\n":e.rtpReceiver?r+="a=recvonly\r\n":r+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";r+="a="+a,r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,r+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+o.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+o.localCName+"\r\n"),r},o.getDirection=function(e,t){for(var n=o.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?o.getDirection(t):"sendrecv"},o.getKind=function(e){return o.splitLines(e)[0].split(" ")[0].substr(2)},o.isRejected=function(e){return"0"===e.split(" ",2)[1]},o.parseMLine=function(e){var t=o.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},o.parseOLine=function(e){var t=o.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},o.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=o.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"===t(n)&&(n.exports=o)},{}]},{},[1])(1)})),B.sessions={},B.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||B.extension.isInstalled()}return!0};var A={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var i=new Error("NavigatorUserMediaError");i.name="You cancelled the request for permission, giving up...",n(i)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function B(e){if(void 0===B.initDone)return e.error("Library not initialized"),{};if(!B.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(B.log("Library initialized: "+B.initDone),(e=e||{}).success="function"==typeof e.success?e.success:B.noop,e.error="function"==typeof e.error?e.error:B.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:B.noop,null===e.server||void 0===e.server)return e.error("Invalid server url"),{};var n=!1,i=null,o={},r=null,a=null,d=0,s=e.server;B.isArray(s)?(B.log("Multiple servers provided ("+s.length+"), will use the first that works"),s=null,a=e.server,B.debug(a)):0===s.indexOf("ws")?(n=!0,B.log("Using WebSockets to contact Janus: "+s)):(n=!1,B.log("Using REST API to contact Janus: "+s));var c=e.iceServers;null==c&&(c=[{urls:"stun:stun.l.google.com:19302"}]);var l=e.iceTransportPolicy,u=e.bundlePolicy,p=e.ipv6;null==p&&(p=!1);var m=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(m=!0===e.withCredentials);var h=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(h=e.max_poll_events),h<1&&(h=1);var f=null;void 0!==e.token&&null!==e.token&&(f=e.token);var v=null;void 0!==e.apisecret&&null!==e.apisecret&&(v=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var g=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(g=e.keepAlivePeriod),isNaN(g)&&(g=25e3);var y=6e4;function C(e){var t={high:9e5,medium:3e5,low:1e5};return null!=e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(y=e.longPollTimeout),isNaN(y)&&(y=6e4);var S=!1,T=null,b={},w=this,P=0,k={};function E(){if(null!=T)if(B.debug("Long poll..."),S){var t=s+"/"+T+"?rid="+(new Date).getTime();null!=h&&(t=t+"&maxev="+h),null!=f&&(t=t+"&token="+encodeURIComponent(f)),null!=v&&(t=t+"&apisecret="+encodeURIComponent(v)),B.httpAPICall(t,{verb:"GET",withCredentials:m,success:I,timeout:y,error:function(t,n){if(B.error(t+":",n),++P>3)return S=!1,void e.error("Lost connection to the server (is it down?)");E()}})}else B.warn("Is the server down? (connected=false)")}function I(e,t){if(P=0,n||null==T||!0===t||E(),n||!B.isArray(e))if("keepalive"!==e.rtcgw)if("ack"!==e.rtcgw)if("success"!==e.rtcgw)if("trickle"===e.rtcgw){if(null==(s=e.sender))return void B.warn("Missing sender...");if(null==(l=b[s]))return void B.debug("This handle is not attached to this session");var o=e.candidate;B.debug("Got a trickled candidate on session "+T),B.debug(o);var r=l.webrtcStuff;r.pc&&r.remoteSdp?(B.debug("Adding remote candidate:",o),o&&!0!==o.completed?r.pc.addIceCandidate(o):r.pc.addIceCandidate(B.endOfCandidates)):(B.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),r.candidates||(r.candidates=[]),r.candidates.push(o),B.debug(r.candidates))}else{if("webrtcup"===e.rtcgw)return B.debug("Got a webrtcup event on session "+T),B.debug(e),null==(s=e.sender)?void B.warn("Missing sender..."):null==(l=b[s])?void B.debug("This handle is not attached to this session"):void l.webrtcState(!0);if("hangup"===e.rtcgw){if(B.debug("Got a hangup event on session "+T),B.debug(e),null==(s=e.sender))return void B.warn("Missing sender...");if(null==(l=b[s]))return void B.debug("This handle is not attached to this session");l.webrtcState(!1,e.reason),l.hangup()}else if("detached"===e.rtcgw){if(B.debug("Got a detached event on session "+T),B.debug(e),null==(s=e.sender))return void B.warn("Missing sender...");if(null==(l=b[s]))return;l.detached=!0,l.ondetached(),l.detach()}else if("media"===e.rtcgw){if(B.debug("Got a media event on session "+T),B.debug(e),null==(s=e.sender))return void B.warn("Missing sender...");if(null==(l=b[s]))return void B.debug("This handle is not attached to this session");l.mediaState(e.type,e.receiving)}else if("slowlink"===e.rtcgw){if(B.debug("Got a slowlink event on session "+T),B.debug(e),null==(s=e.sender))return void B.warn("Missing sender...");if(null==(l=b[s]))return void B.debug("This handle is not attached to this session");l.slowLink(e.uplink,e.lost)}else{if("error"===e.rtcgw){var a,d;if(B.error("Ooops: "+e.error.code+" "+e.error.reason),B.debug(e),null!=(a=e.transaction))null!=(d=k[a])&&d(e),delete k[a];return}if("event"===e.rtcgw){var s;if(B.debug("Got a plugin event on session "+T),B.debug(e),null==(s=e.sender))return void B.warn("Missing sender...");var c=e.plugindata;if(null==c)return void B.warn("Missing plugindata...");B.debug("  -- Event is coming from "+s+" ("+c.plugin+")");var l,u=c.data;if(B.debug(u),null==(l=b[s]))return void B.warn("This handle is not attached to this session");var p=e.jsep;null!=p&&(B.debug("Handling SDP as well..."),B.debug(p));var m=l.onmessage;null!=m?(B.debug("Notifying application..."),m(u,p)):B.debug("No provided notification callback")}else{if("timeout"===e.rtcgw)return B.error("Timeout on session "+T),B.debug(e),void(n&&i.close(3504,"Gateway timeout"));B.warn("Unknown message/event  '"+e.rtcgw+"' on session "+T),B.debug(e)}}}else B.debug("Got a success on session "+T),B.debug(e),null!=(a=e.transaction)&&(null!=(d=k[a])&&d(e),delete k[a]);else B.debug("Got an ack on session "+T),B.debug(e),null!=(a=e.transaction)&&(null!=(d=k[a])&&d(e),delete k[a]);else B.vdebug("Got a keepalive on session "+T);else for(var h=0;h<e.length;h++)I(e[h],!0)}function x(){if(null!==s&&n&&S){r=setTimeout(x,g);var e={rtcgw:"keepalive",session_id:T,transaction:B.randomString(12)};null!=f&&(e.token=f),null!=v&&(e.apisecret=v),i.send(JSON.stringify(e))}}function _(t){var c=B.randomString(12),l={rtcgw:"create",transaction:c,token:window.EZUIKit.opt.stream,device:window.EZUIKit.opt.deviceSerial,channel:window.EZUIKit.opt.channelNo};if(t.reconnect&&(S=!1,l.rtcgw="claim",l.session_id=T,i&&(i.onopen=null,i.onerror=null,i.onclose=null,r&&(clearTimeout(r),r=null))),null!=f&&(l.token=f),null!=v&&(l.apisecret=v),null===s&&B.isArray(a)&&(0===(s=a[d]).indexOf("ws")?(n=!0,B.log("Server #"+(d+1)+": trying WebSockets to contact Janus ("+s+")")):(n=!1,B.log("Server #"+(d+1)+": trying REST API to contact Janus ("+s+")"))),n)for(var u in i=B.newWebSocket(s,"rtcgw-protocol"),o={error:function(){if(B.error("Error connecting to the Janus WebSockets server... "+s),B.isArray(a)&&!t.reconnect)return++d==a.length?void t.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){_(t)}),200));t.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){k[c]=function(e){if(B.debug(e),"success"!==e.rtcgw)return B.error("Ooops: "+e.error.code+" "+e.error.reason),void t.error(e.error.reason);r=setTimeout(x,g),S=!0,T=e.session_id?e.session_id:e.data.id,t.reconnect?B.log("Claimed session: "+T):B.log("Created session: "+T),B.sessions[T]=w,t.success()},i.send(JSON.stringify(l))},message:function(e){I(JSON.parse(e.data))},close:function(){null!==s&&S&&(S=!1,e.error("Lost connection to the server (is it down?)"))}})i.addEventListener(u,o[u]);else B.httpAPICall(s,{verb:"POST",withCredentials:m,body:l,success:function(e){if(B.debug(e),"success"!==e.rtcgw)return B.error("Ooops: "+e.error.code+" "+e.error.reason),void t.error(e.error.reason);S=!0,T=e.session_id?e.session_id:e.data.id,t.reconnect?B.log("Claimed session: "+T):B.log("Created session: "+T),B.sessions[T]=w,E(),t.success()},error:function(e,n){if(B.error(e+":",n),B.isArray(a)&&!t.reconnect)return++d==a.length?void t.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){_(t)}),200));""===n?t.error(e+": Is the server down?"):t.error(e+": "+n)}})}function j(e,t){if((t=t||{}).success="function"==typeof t.success?t.success:B.noop,t.error="function"==typeof t.error?t.error:B.noop,!S)return B.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var o=b[e];if(null==o||null===o.webrtcStuff||void 0===o.webrtcStuff)return B.warn("Invalid handle"),void t.error("Invalid handle");var r=t.message,a=t.jsep,d=B.randomString(12),c={rtcgw:"message",body:r,transaction:d};if(null!==o.token&&void 0!==o.token&&(c.token=o.token),null!=v&&(c.apisecret=v),null!=a&&(c.jsep=a),B.debug("Sending message to plugin (handle="+e+"):"),B.debug(c),n)return c.session_id=T,c.handle_id=e,k[d]=function(e){if(B.debug("Message sent!"),B.debug(e),"success"===e.rtcgw){var n=e.plugindata;if(null==n)return B.warn("Request succeeded, but missing plugindata..."),void t.success();B.log("Synchronous transaction successful ("+n.plugin+")");var i=n.data;return B.debug(i),void t.success(i)}"ack"===e.rtcgw?t.success():void 0!==e.error&&null!==e.error?(B.error("Ooops: "+e.error.code+" "+e.error.reason),t.error(e.error.code+" "+e.error.reason)):(B.error("Unknown error"),t.error("Unknown error"))},void i.send(JSON.stringify(c));B.httpAPICall(s+"/"+T+"/"+e,{verb:"POST",withCredentials:m,body:c,success:function(e){if(B.debug("Message sent!"),B.debug(e),"success"===e.rtcgw){var n=e.plugindata;if(null==n)return B.warn("Request succeeded, but missing plugindata..."),void t.success();B.log("Synchronous transaction successful ("+n.plugin+")");var i=n.data;return B.debug(i),void t.success(i)}"ack"===e.rtcgw?t.success():void 0!==e.error&&null!==e.error?(B.error("Ooops: "+e.error.code+" "+e.error.reason),t.error(e.error.code+" "+e.error.reason)):(B.error("Unknown error"),t.error("Unknown error"))},error:function(e,n){B.error(e+":",n),t.error(e+": "+n)}})}function R(e,t){if(S){var o=b[e];if(null!=o&&null!==o.webrtcStuff&&void 0!==o.webrtcStuff){var r={rtcgw:"trickle",candidate:t,transaction:B.randomString(12)};if(null!==o.token&&void 0!==o.token&&(r.token=o.token),null!=v&&(r.apisecret=v),B.vdebug("Sending trickle candidate (handle="+e+"):"),B.vdebug(r),n)return r.session_id=T,r.handle_id=e,void i.send(JSON.stringify(r));B.httpAPICall(s+"/"+T+"/"+e,{verb:"POST",withCredentials:m,body:r,success:function(e){B.vdebug("Candidate sent!"),B.vdebug(e),"ack"===e.rtcgw||B.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){B.error(e+":",t)}})}else B.warn("Invalid handle")}else B.warn("Is the server down? (connected=false)")}function M(e,t,n,i){var o=b[e];if(null!=o&&null!==o.webrtcStuff&&void 0!==o.webrtcStuff){var r=o.webrtcStuff,a=function(e){B.log("Received state change on data channel:",e);var t=e.target.label,n=r.dataChannel[t]?r.dataChannel[t].readyState:"null";if(B.log("State change on <"+t+"> data channel: "+n),"open"===n){if(r.dataChannel[t].pending&&r.dataChannel[t].pending.length>0){for(var i in B.log("Sending pending messages on <"+t+">:",r.dataChannel[t].pending.length),r.dataChannel[t].pending){var a=r.dataChannel[t].pending[i];B.log("Sending string on data channel <"+t+">: "+a),r.dataChannel[t].send(a)}r.dataChannel[t].pending=[]}o.ondataopen(t)}};r.dataChannel[t]=n||r.pc.createDataChannel(t,{ordered:!1}),r.dataChannel[t].onmessage=function(e){B.log("Received message on data channel:",e);var t=e.target.label;o.ondata(e.data,t)},r.dataChannel[t].onopen=a,r.dataChannel[t].onclose=a,r.dataChannel[t].onerror=function(e){B.error("Got error on data channel:",e)},r.dataChannel[t].pending=[],i&&r.dataChannel[t].pending.push(i)}else B.warn("Invalid handle")}function D(e,t){(t=t||{}).success="function"==typeof t.success?t.success:B.noop,t.error="function"==typeof t.error?t.error:B.noop;var n=b[e];if(null==n||null===n.webrtcStuff||void 0===n.webrtcStuff)return B.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff,o=t.text;if(null==o)return B.warn("Invalid text"),void t.error("Invalid text");var r=t.label?t.label:B.dataChanDefaultLabel;return i.dataChannel[r]?"open"!==i.dataChannel[r].readyState?(i.dataChannel[r].pending.push(o),void t.success()):(B.log("Sending string on data channel <"+r+">: "+o),i.dataChannel[r].send(o),void t.success()):(M(e,r,!1,o),void t.success())}function A(e,t){(t=t||{}).success="function"==typeof t.success?t.success:B.noop,t.error="function"==typeof t.error?t.error:B.noop;var n=b[e];if(null==n||null===n.webrtcStuff||void 0===n.webrtcStuff)return B.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff;if(null===i.dtmfSender||void 0===i.dtmfSender){if(void 0!==i.pc&&null!==i.pc){var o=i.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!o)return B.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");i.dtmfSender=o.dtmf,i.dtmfSender&&(B.log("Created DTMF Sender"),i.dtmfSender.ontonechange=function(e){B.debug("Sent DTMF tone: "+e.tone)})}if(null===i.dtmfSender||void 0===i.dtmfSender)return B.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var r=t.dtmf;if(null==r)return B.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var a=r.tones;if(null==a)return B.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var d=r.duration;null==d&&(d=500);var s=r.gap;null==s&&(s=50),B.debug("Sending DTMF string "+a+" (duration "+d+"ms, gap "+s+"ms)"),i.dtmfSender.insertDTMF(a,d,s),t.success()}function z(e,t){(t=t||{}).success="function"==typeof t.success?t.success:B.noop,t.error="function"==typeof t.error?t.error:B.noop;var o=!0;void 0!==t.asyncRequest&&null!==t.asyncRequest&&(o=!0===t.asyncRequest);var r=!0;void 0!==t.noRequest&&null!==t.noRequest&&(r=!0===t.noRequest),B.log("Destroying handle "+e+" (async="+o+")"),K(e);var a=b[e];if(null==a||a.detached)return delete b[e],void t.success();if(r)return delete b[e],void t.success();if(!S)return B.warn("Is the server down? (connected=false)"),void t.error("Is the server down? (connected=false)");var d={rtcgw:"detach",transaction:B.randomString(12)};if(null!==a.token&&void 0!==a.token&&(d.token=a.token),null!=v&&(d.apisecret=v),n)return d.session_id=T,d.handle_id=e,i.send(JSON.stringify(d)),delete b[e],void t.success();B.httpAPICall(s+"/"+T+"/"+e,{verb:"POST",async:o,withCredentials:m,body:d,success:function(n){B.log("Destroyed handle:"),B.debug(n),"success"!==n.rtcgw&&B.error("Ooops: "+n.error.code+" "+n.error.reason),delete b[e],t.success()},error:function(n,i){B.error(n+":",i),delete b[e],t.success()}})}function F(e,n,i,o,r){var a=b[e];if(null==a||null===a.webrtcStuff||void 0===a.webrtcStuff)return B.warn("Invalid handle"),void o.error("Invalid handle");var d=a.webrtcStuff;B.debug("streamsDone:",r),r&&(B.debug("  -- Audio tracks:",r.getAudioTracks()),B.debug("  -- Video tracks:",r.getVideoTracks()));var s=!1;if(d.myStream&&i.update&&!d.streamExternal){if((!i.update&&Z(i)||i.update&&(i.addAudio||i.replaceAudio))&&r.getAudioTracks()&&r.getAudioTracks().length)if(d.myStream.addTrack(r.getAudioTracks()[0]),B.unifiedPlan){B.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",r.getAudioTracks()[0]);var m=null;if((f=d.pc.getTransceivers())&&f.length>0)for(var h in f){if((g=f[h]).sender&&g.sender.track&&"audio"===g.sender.track.kind||g.receiver&&g.receiver.track&&"audio"===g.receiver.track.kind){m=g;break}}m&&m.sender?m.sender.replaceTrack(r.getAudioTracks()[0]):d.pc.addTrack(r.getAudioTracks()[0],r)}else B.log((i.replaceAudio?"Replacing":"Adding")+" audio track:",r.getAudioTracks()[0]),d.pc.addTrack(r.getAudioTracks()[0],r);if((!i.update&&J(i)||i.update&&(i.addVideo||i.replaceVideo))&&r.getVideoTracks()&&r.getVideoTracks().length)if(d.myStream.addTrack(r.getVideoTracks()[0]),B.unifiedPlan){B.log((i.replaceVideo?"Replacing":"Adding")+" video track:",r.getVideoTracks()[0]);var f,v=null;if((f=d.pc.getTransceivers())&&f.length>0)for(var h in f){var g;if((g=f[h]).sender&&g.sender.track&&"video"===g.sender.track.kind||g.receiver&&g.receiver.track&&"video"===g.receiver.track.kind){v=g;break}}v&&v.sender?v.sender.replaceTrack(r.getVideoTracks()[0]):d.pc.addTrack(r.getVideoTracks()[0],r)}else B.log((i.replaceVideo?"Replacing":"Adding")+" video track:",r.getVideoTracks()[0]),d.pc.addTrack(r.getVideoTracks()[0],r)}else d.myStream=r,s=!0;if(!d.pc){var y={iceServers:c,iceTransportPolicy:l,bundlePolicy:u};"chrome"===B.webRTCAdapter.browserDetails.browser&&(y.sdpSemantics=B.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var S={optional:[{DtlsSrtpKeyAgreement:!0}]};if(!0===p&&S.optional.push({googIPv6:!0}),o.rtcConstraints&&"object"===t(o.rtcConstraints))for(var h in B.debug("Adding custom PeerConnection constraints:",o.rtcConstraints),o.rtcConstraints)S.optional.push(o.rtcConstraints[h]);"edge"===B.webRTCAdapter.browserDetails.browser&&(y.bundlePolicy="max-bundle"),B.log("Creating PeerConnection"),B.debug(S),d.pc=new RTCPeerConnection(y,S),B.debug(d.pc),d.pc.getStats&&(d.volume={},d.bitrate.value="0 kbits/sec"),B.log("Preparing local SDP and gathering candidates (trickle="+d.trickle+")"),d.pc.oniceconnectionstatechange=function(e){d.pc&&a.iceState(d.pc.iceConnectionState)},d.pc.onicecandidate=function(t){if(null==t.candidate||"edge"===B.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)B.log("End of candidates."),d.iceDone=!0,!0===d.trickle?R(e,{completed:!0}):function(e,t){(t=t||{}).success="function"==typeof t.success?t.success:B.noop,t.error="function"==typeof t.error?t.error:B.noop;var n=b[e];if(null==n||null===n.webrtcStuff||void 0===n.webrtcStuff)return void B.warn("Invalid handle, not sending anything");var i=n.webrtcStuff;if(B.log("Sending offer/answer SDP..."),null===i.mySdp||void 0===i.mySdp)return void B.warn("Local SDP instance is invalid, not sending anything...");i.mySdp={type:i.pc.localDescription.type,sdp:i.pc.localDescription.sdp},!1===i.trickle&&(i.mySdp.trickle=!1);B.debug(t),i.sdpSent=!0,t.success(i.mySdp)}(e,o);else{var n={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===d.trickle&&R(e,n)}},d.pc.ontrack=function(e){B.log("Handling Remote Track"),B.debug(e),e.streams&&(d.remoteStream=e.streams[0],a.onremotestream(d.remoteStream),e.track.onended||(B.log("Adding onended callback to track:",e.track),e.track.onended=function(e){B.log("Remote track muted/removed:",e),d.remoteStream&&(d.remoteStream.removeTrack(e.target),a.onremotestream(d.remoteStream))},e.track.onmute=e.track.onended,e.track.onunmute=function(e){B.log("Remote track flowing again:",e);try{d.remoteStream.addTrack(e.target),a.onremotestream(d.remoteStream)}catch(e){B.error(e)}}))}}if(s&&null!=r){B.log("Adding local stream");var T=!0===o.simulcast2;r.getTracks().forEach((function(e){if(B.log("Adding local track:",e),T)if("audio"===e.kind)d.pc.addTrack(e,r);else{B.log("Enabling rid-based simulcasting:",e);var t=C(o.simulcastMaxBitrates);d.pc.addTransceiver(e,{direction:"sendrecv",streams:[r],sendEncodings:[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}]})}else d.pc.addTrack(e,r)}))}(function(e){if(B.debug("isDataEnabled:",e),"edge"==B.webRTCAdapter.browserDetails.browser)return B.warn("Edge doesn't support data channels yet"),!1;return null!=e&&!0===e.data})(i)&&!d.dataChannel[B.dataChanDefaultLabel]&&(B.log("Creating data channel"),M(e,B.dataChanDefaultLabel,!1),d.pc.ondatachannel=function(t){B.log("Data channel created by Janus:",t),M(e,t.channel.label,t.channel)}),d.myStream&&a.onlocalstream(d.myStream),null==n?function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:B.noop,n.error="function"==typeof n.error?n.error:B.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:B.noop;var i=b[e];if(null==i||null===i.webrtcStuff||void 0===i.webrtcStuff)return B.warn("Invalid handle"),void n.error("Invalid handle");var o=i.webrtcStuff,r=!0===n.simulcast;r?B.log("Creating offer (iceDone="+o.iceDone+", simulcast="+r+")"):B.log("Creating offer (iceDone="+o.iceDone+")");var a={};if(B.unifiedPlan){var d=null,s=null,c=o.pc.getTransceivers();if(c&&c.length>0)for(var l in c){var u=c[l];u.sender&&u.sender.track&&"audio"===u.sender.track.kind||u.receiver&&u.receiver.track&&"audio"===u.receiver.track.kind?d||(d=u):(u.sender&&u.sender.track&&"video"===u.sender.track.kind||u.receiver&&u.receiver.track&&"video"===u.receiver.track.kind)&&(s||(s=u))}var p=Z(t),m=G(t);p||m?p&&m?d&&(d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",B.log("Setting audio transceiver to sendrecv:",d)):p&&!m?d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",B.log("Setting audio transceiver to sendonly:",d)):!p&&m&&(d?(d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",B.log("Setting audio transceiver to recvonly:",d)):(d=o.pc.addTransceiver("audio",{direction:"recvonly"}),B.log("Adding recvonly audio transceiver:",d))):t.removeAudio&&d&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive",B.log("Setting audio transceiver to inactive:",d));var h=J(t),f=q(t);h||f?h&&f?s&&(s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",B.log("Setting video transceiver to sendrecv:",s)):h&&!f?s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",B.log("Setting video transceiver to sendonly:",s)):!h&&f&&(s?(s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",B.log("Setting video transceiver to recvonly:",s)):(s=o.pc.addTransceiver("video",{direction:"recvonly"}),B.log("Adding recvonly video transceiver:",s))):t.removeVideo&&s&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive",B.log("Setting video transceiver to inactive:",s))}else a.offerToReceiveAudio=G(t),a.offerToReceiveVideo=q(t);!0===n.iceRestart&&(a.iceRestart=!0);B.debug(a);var v=J(t);if(v&&r&&"firefox"===B.webRTCAdapter.browserDetails.browser){B.log("Enabling Simulcasting for Firefox (RID)");var g=o.pc.getSenders().find((function(e){return"video"==e.track.kind}));if(g){var y=g.getParameters();y||(y={});var S=C(n.simulcastMaxBitrates);y.encodings=[{rid:"h",active:!0,maxBitrate:S.high},{rid:"m",active:!0,maxBitrate:S.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:S.low,scaleResolutionDownBy:4}],g.setParameters(y)}}o.pc.createOffer(a).then((function(e){B.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,B.log("Setting local description"),v&&r&&("chrome"===B.webRTCAdapter.browserDetails.browser||"safari"===B.webRTCAdapter.browserDetails.browser?(B.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=function(e){for(var t=e.split("\r\n"),n=!1,i=[-1],o=[-1],r=null,a=null,d=null,s=null,c=-1,l=0;l<t.length;l++){if(p=t[l].match(/m=(\w+) */)){if("video"===p[1]){if(!(i[0]<0)){c=l;break}n=!0}else if(i[0]>-1){c=l;break}}else if(n){var u=t[l].match(/a=ssrc-group:FID (\d+) (\d+)/);if(u)i[0]=u[1],o[0]=u[2],t.splice(l,1),l--;else{if(i[0]){if((h=t[l].match("a=ssrc:"+i[0]+" cname:(.+)"))&&(r=h[1]),(h=t[l].match("a=ssrc:"+i[0]+" msid:(.+)"))&&(a=h[1]),(h=t[l].match("a=ssrc:"+i[0]+" mslabel:(.+)"))&&(d=h[1]),(h=t[l].match("a=ssrc:"+i[0]+" label:(.+)"))&&(s=h[1]),0===t[l].indexOf("a=ssrc:"+o[0])){t.splice(l,1),l--;continue}if(0===t[l].indexOf("a=ssrc:"+i[0])){t.splice(l,1),l--;continue}}0!=t[l].length||(t.splice(l,1),l--)}}}if(i[0]<0){c=-1,n=!1;for(l=0;l<t.length;l++){var p;if(p=t[l].match(/m=(\w+) */)){if("video"===p[1]){if(!(i[0]<0)){c=l;break}n=!0}else if(i[0]>-1){c=l;break}}else if(n){if(i[0]<0){var m=t[l].match(/a=ssrc:(\d+)/);if(m){i[0]=m[1],t.splice(l,1),l--;continue}}else{var h;if((h=t[l].match("a=ssrc:"+i[0]+" cname:(.+)"))&&(r=h[1]),(h=t[l].match("a=ssrc:"+i[0]+" msid:(.+)"))&&(a=h[1]),(h=t[l].match("a=ssrc:"+i[0]+" mslabel:(.+)"))&&(d=h[1]),(h=t[l].match("a=ssrc:"+i[0]+" label:(.+)"))&&(s=h[1]),0===t[l].indexOf("a=ssrc:"+o[0])){t.splice(l,1),l--;continue}if(0===t[l].indexOf("a=ssrc:"+i[0])){t.splice(l,1),l--;continue}}0!=t[l].length||(t.splice(l,1),l--)}}}if(i[0]<0)return B.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;c<0&&(c=t.length);i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random()),o[1]=Math.floor(4294967295*Math.random()),o[2]=Math.floor(4294967295*Math.random());for(l=0;l<i.length;l++)r&&(t.splice(c,0,"a=ssrc:"+i[l]+" cname:"+r),c++),a&&(t.splice(c,0,"a=ssrc:"+i[l]+" msid:"+a),c++),d&&(t.splice(c,0,"a=ssrc:"+i[l]+" mslabel:"+d),c++),s&&(t.splice(c,0,"a=ssrc:"+i[l]+" label:"+s),c++),r&&(t.splice(c,0,"a=ssrc:"+o[l]+" cname:"+r),c++),a&&(t.splice(c,0,"a=ssrc:"+o[l]+" msid:"+a),c++),d&&(t.splice(c,0,"a=ssrc:"+o[l]+" mslabel:"+d),c++),s&&(t.splice(c,0,"a=ssrc:"+o[l]+" label:"+s),c++);t.splice(c,0,"a=ssrc-group:FID "+i[2]+" "+o[2]),t.splice(c,0,"a=ssrc-group:FID "+i[1]+" "+o[1]),t.splice(c,0,"a=ssrc-group:FID "+i[0]+" "+o[0]),t.splice(c,0,"a=ssrc-group:SIM "+i[0]+" "+i[1]+" "+i[2]),(e=t.join("\r\n")).endsWith("\r\n")||(e+="\r\n");return e}(e.sdp)):"firefox"!==B.webRTCAdapter.browserDetails.browser&&B.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp=e.sdp,o.pc.setLocalDescription(e).catch(n.error),o.mediaConstraints=a,o.iceDone||o.trickle?(B.log("Offer ready"),B.debug(n),n.success(e)):B.log("Waiting for all candidates...")}),n.error)}(e,i,o):d.pc.setRemoteDescription(n).then((function(){if(B.log("Remote description accepted!"),d.remoteSdp=n.sdp,d.candidates&&d.candidates.length>0){for(var t=0;t<d.candidates.length;t++){var r=d.candidates[t];B.debug("Adding remote candidate:",r),r&&!0!==r.completed?d.pc.addIceCandidate(r):d.pc.addIceCandidate(B.endOfCandidates)}d.candidates=[]}!function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:B.noop,n.error="function"==typeof n.error?n.error:B.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:B.noop;var i=b[e];if(null==i||null===i.webrtcStuff||void 0===i.webrtcStuff)return B.warn("Invalid handle"),void n.error("Invalid handle");var o=i.webrtcStuff,r=!0===n.simulcast;r?B.log("Creating answer (iceDone="+o.iceDone+", simulcast="+r+")"):B.log("Creating answer (iceDone="+o.iceDone+")");var a=null;if(B.unifiedPlan){a={};var d=null,s=null,c=o.pc.getTransceivers();if(c&&c.length>0)for(var l in c){var u=c[l];u.sender&&u.sender.track&&"audio"===u.sender.track.kind||u.receiver&&u.receiver.track&&"audio"===u.receiver.track.kind?d||(d=u):(u.sender&&u.sender.track&&"video"===u.sender.track.kind||u.receiver&&u.receiver.track&&"video"===u.receiver.track.kind)&&(s||(s=u))}var p=Z(t),m=G(t);if(p||m){if(p&&m){if(d)try{d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",B.log("Setting audio transceiver to sendrecv:",d)}catch(e){B.error(e)}}else if(p&&!m)try{d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",B.log("Setting audio transceiver to sendonly:",d))}catch(e){B.error(e)}else if(!p&&m)if(d)try{d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",B.log("Setting audio transceiver to recvonly:",d)}catch(e){B.error(e)}else d=o.pc.addTransceiver("audio",{direction:"recvonly"}),B.log("Adding recvonly audio transceiver:",d)}else if(t.removeAudio&&d)try{d.setDirection?d.setDirection("inactive"):d.direction="inactive",B.log("Setting audio transceiver to inactive:",d)}catch(e){B.error(e)}var h=J(t),f=q(t);if(h||f){if(h&&f){if(s)try{s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",B.log("Setting video transceiver to sendrecv:",s)}catch(e){B.error(e)}}else if(h&&!f){if(s)try{s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",B.log("Setting video transceiver to sendonly:",s)}catch(e){B.error(e)}}else if(!h&&f)if(s)try{s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",B.log("Setting video transceiver to recvonly:",s)}catch(e){B.error(e)}else s=o.pc.addTransceiver("video",{direction:"recvonly"}),B.log("Adding recvonly video transceiver:",s)}else if(t.removeVideo&&s)try{s.setDirection?s.setDirection("inactive"):s.direction="inactive",B.log("Setting video transceiver to inactive:",s)}catch(e){B.error(e)}}else a="firefox"==B.webRTCAdapter.browserDetails.browser||"edge"==B.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:G(t),offerToReceiveVideo:q(t)}:{mandatory:{OfferToReceiveAudio:G(t),OfferToReceiveVideo:q(t)}};B.debug(a);var v=J(t);if(v&&r&&"firefox"===B.webRTCAdapter.browserDetails.browser){B.log("Enabling Simulcasting for Firefox (RID)");var g=o.pc.getSenders()[1];B.log(g);var y=g.getParameters();B.log(y);var S=C(n.simulcastMaxBitrates);g.setParameters({encodings:[{rid:"high",active:!0,priority:"high",maxBitrate:S.high},{rid:"medium",active:!0,priority:"medium",maxBitrate:S.medium},{rid:"low",active:!0,priority:"low",maxBitrate:S.low}]})}o.pc.createAnswer(a).then((function(e){B.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,B.log("Setting local description"),v&&r&&("chrome"===B.webRTCAdapter.browserDetails.browser?B.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==B.webRTCAdapter.browserDetails.browser&&B.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp=e.sdp,o.pc.setLocalDescription(e).catch(n.error),o.mediaConstraints=a,o.iceDone||o.trickle?n.success(e):B.log("Waiting for all candidates...")}),n.error)}(e,i,o)}),o.error)}function L(e,n,i){(i=i||{}).success="function"==typeof i.success?i.success:B.noop,i.error="function"==typeof i.error?i.error:W;var o=i.jsep;if(n&&o)return B.error("Provided a JSEP to a createOffer"),void i.error("Provided a JSEP to a createOffer");if(!(n||o&&o.type&&o.sdp))return B.error("A valid JSEP is required for createAnswer"),void i.error("A valid JSEP is required for createAnswer");i.media=i.media||{audio:!0,video:!0};var r=i.media,a=b[e];if(null==a||null===a.webrtcStuff||void 0===a.webrtcStuff)return B.warn("Invalid handle"),void i.error("Invalid handle");var d,s=a.webrtcStuff;if(s.trickle=(d=i.trickle,B.debug("isTrickleEnabled:",d),null==d||!0===d),void 0===s.pc||null===s.pc)r.update=!1,r.keepAudio=!1,r.keepVideo=!1;else if(void 0!==s.pc&&null!==s.pc){if(B.log("Updating existing media session"),r.update=!0,null!==i.stream&&void 0!==i.stream)i.stream!==s.myStream&&B.log("Renegotiation involves a new external stream");else{if(r.addAudio){if(r.keepAudio=!1,r.replaceAudio=!1,r.removeAudio=!1,r.audioSend=!0,s.myStream&&s.myStream.getAudioTracks()&&s.myStream.getAudioTracks().length)return B.error("Can't add audio stream, there already is one"),void i.error("Can't add audio stream, there already is one")}else r.removeAudio?(r.keepAudio=!1,r.replaceAudio=!1,r.addAudio=!1,r.audioSend=!1):r.replaceAudio&&(r.keepAudio=!1,r.addAudio=!1,r.removeAudio=!1,r.audioSend=!0);if(null===s.myStream||void 0===s.myStream?(r.replaceAudio&&(r.keepAudio=!1,r.replaceAudio=!1,r.addAudio=!0,r.audioSend=!0),Z(r)&&(r.keepAudio=!1,r.addAudio=!0)):null===s.myStream.getAudioTracks()||void 0===s.myStream.getAudioTracks()||0===s.myStream.getAudioTracks().length?(r.replaceAudio&&(r.keepAudio=!1,r.replaceAudio=!1,r.addAudio=!0,r.audioSend=!0),Z(r)&&(r.keepVideo=!1,r.addAudio=!0)):!Z(r)||r.removeAudio||r.replaceAudio||(r.keepAudio=!0),r.addVideo){if(r.keepVideo=!1,r.replaceVideo=!1,r.removeVideo=!1,r.videoSend=!0,s.myStream&&s.myStream.getVideoTracks()&&s.myStream.getVideoTracks().length)return B.error("Can't add video stream, there already is one"),void i.error("Can't add video stream, there already is one")}else r.removeVideo?(r.keepVideo=!1,r.replaceVideo=!1,r.addVideo=!1,r.videoSend=!1):r.replaceVideo&&(r.keepVideo=!1,r.addVideo=!1,r.removeVideo=!1,r.videoSend=!0);null===s.myStream||void 0===s.myStream||null===s.myStream.getVideoTracks()||void 0===s.myStream.getVideoTracks()||0===s.myStream.getVideoTracks().length?(r.replaceVideo&&(r.keepVideo=!1,r.replaceVideo=!1,r.addVideo=!0,r.videoSend=!0),J(r)&&(r.keepVideo=!1,r.addVideo=!0)):!J(r)||r.removeVideo||r.replaceVideo||(r.keepVideo=!0),r.addData&&(r.data=!0)}if(Z(r)&&r.keepAudio&&J(r)&&r.keepVideo)return a.consentDialog(!1),void F(e,o,r,i,s.myStream)}if(r.update&&!s.streamExternal){if(r.removeAudio||r.replaceAudio){if(s.myStream&&s.myStream.getAudioTracks()&&s.myStream.getAudioTracks().length){var c=s.myStream.getAudioTracks()[0];B.log("Removing audio track:",c),s.myStream.removeTrack(c);try{c.stop()}catch(e){}}if(s.pc.getSenders()&&s.pc.getSenders().length){var l=!0;if(r.replaceAudio&&B.unifiedPlan&&(l=!1),l)for(var u in s.pc.getSenders()){(c=s.pc.getSenders()[u])&&c.track&&"audio"===c.track.kind&&(B.log("Removing audio sender:",c),s.pc.removeTrack(c))}}}if(r.removeVideo||r.replaceVideo){if(s.myStream&&s.myStream.getVideoTracks()&&s.myStream.getVideoTracks().length){c=s.myStream.getVideoTracks()[0];B.log("Removing video track:",c),s.myStream.removeTrack(c);try{c.stop()}catch(e){}}if(s.pc.getSenders()&&s.pc.getSenders().length){var p=!0;if(r.replaceVideo&&B.unifiedPlan&&(p=!1),p)for(var u in s.pc.getSenders()){(c=s.pc.getSenders()[u])&&c.track&&"video"===c.track.kind&&(B.log("Removing video sender:",c),s.pc.removeTrack(c))}}}}if(null!==i.stream&&void 0!==i.stream){var m=i.stream;if(B.log("MediaStream provided by the application"),B.debug(m),r.update&&s.myStream&&s.myStream!==i.stream&&!s.streamExternal){try{var h=s.myStream.getTracks();for(var f in h){var v=h[f];B.log(v),null!=v&&v.stop()}}catch(e){}s.myStream=null}return s.streamExternal=!0,a.consentDialog(!1),void F(e,o,r,i,m)}if(Z(r)||J(r)){if(!B.isGetUserMediaAvailable())return void i.error("getUserMedia not available");var g={mandatory:{},optional:[]};a.consentDialog(!0);var y=Z(r);!0===y&&null!=r&&null!=r&&"object"===t(r.audio)&&(y=r.audio);var C=J(r);if(!0===C&&null!=r&&null!=r){var S=!0===i.simulcast,T=!0===i.simulcast2;if(!S&&!T||o||void 0!==r.video&&!1!==r.video||(r.video="hires"),r.video&&"screen"!=r.video&&"window"!=r.video)if("object"===t(r.video))C=r.video;else{var w=0,P=0;"lowres"===r.video?(P=240,w=320):"lowres-16:9"===r.video?(P=180,w=320):"hires"===r.video||"hires-16:9"===r.video||"hdres"===r.video?(P=720,w=1280):"fhdres"===r.video?(P=1080,w=1920):"4kres"===r.video?(P=2160,w=3840):"stdres"===r.video?(P=480,w=640):"stdres-16:9"===r.video?(P=360,w=640):(B.log("Default video setting is stdres 4:3"),P=480,w=640),B.log("Adding media constraint:",r.video),C={height:{ideal:P},width:{ideal:w}},B.log("Adding video constraint:",C)}else if("screen"===r.video||"window"===r.video){var k=function(t,n){a.consentDialog(!1),t?i.error(t):F(e,o,r,i,n)},E=function(e,t,n){B.log("Adding media constraint (screen capture)"),B.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){n?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){e.addTrack(n.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){a.consentDialog(!1),t(e)}))};if(r.screenshareFrameRate||(r.screenshareFrameRate=3),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return void navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(t){a.consentDialog(!1),Z(r)&&!r.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){t.addTrack(n.getAudioTracks()[0]),F(e,o,r,i,t)})):F(e,o,r,i,t)}),(function(e){a.consentDialog(!1),i.error(e)}));if("chrome"===B.webRTCAdapter.browserDetails.browser){var I=B.webRTCAdapter.browserDetails.version,x=33;window.navigator.userAgent.match("Linux")&&(x=35),I>=26&&I<=x?(g={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:r.screenshareFrameRate,maxFrameRate:r.screenshareFrameRate,chromeMediaSource:"screen"}},audio:Z(r)&&!r.keepAudio},E(g,k)):B.extension.getScreen((function(e,t){if(e)return a.consentDialog(!1),i.error(e);(g={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:r.screenshareFrameRate,maxFrameRate:r.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=t,E(g,k,Z(r)&&!r.keepAudio)}))}else if("firefox"===B.webRTCAdapter.browserDetails.browser){if(!(B.webRTCAdapter.browserDetails.version>=33)){var _=new Error("NavigatorUserMediaError");return _.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",a.consentDialog(!1),void i.error(_)}g={video:{mozMediaSource:r.video,mediaSource:r.video},audio:Z(r)&&!r.keepAudio},E(g,(function(e,t){if(k(e,t),!e)var n=t.currentTime,i=window.setInterval((function(){t||window.clearInterval(i),t.currentTime==n&&(window.clearInterval(i),t.onended&&t.onended()),n=t.currentTime}),500)}))}return}}null!=r&&"screen"===r.video||navigator.mediaDevices.enumerateDevices().then((function(n){var d=n.some((function(e){return"audioinput"===e.kind})),s=function(e){if(B.debug("isScreenSendEnabled:",e),null==e)return!1;if("object"!==t(e.video)||"object"!==t(e.video.mandatory))return!1;var n=e.video.mandatory;if(n.chromeMediaSource)return"desktop"===n.chromeMediaSource||"screen"===n.chromeMediaSource;if(n.mozMediaSource)return"window"===n.mozMediaSource||"screen"===n.mozMediaSource;if(n.mediaSource)return"window"===n.mediaSource||"screen"===n.mediaSource;return!1}(r)||n.some((function(e){return"videoinput"===e.kind})),c=Z(r),l=J(r),u=function(e){return B.debug("isAudioSendRequired:",e),null!=e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}(r),p=function(e){return B.debug("isVideoSendRequired:",e),null!=e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}(r);if(c||l||u||p){var h=!!c&&d,f=!!l&&s;if(!h&&!f)return a.consentDialog(!1),i.error("No capture device found"),!1;if(!h&&u)return a.consentDialog(!1),i.error("Audio capture is required, but no capture device found"),!1;if(!f&&p)return a.consentDialog(!1),i.error("Video capture is required, but no capture device found"),!1}var v={audio:!(!d||r.keepAudio)&&y,video:!(!s||r.keepVideo)&&C};B.debug("getUserMedia constraints",v),v.audio||v.video?navigator.mediaDevices.getUserMedia(v).then((function(t){a.consentDialog(!1),F(e,o,r,i,t)})).catch((function(e){a.consentDialog(!1),i.error({code:e.code,name:e.name,message:e.message})})):(a.consentDialog(!1),F(e,o,r,i,m))})).catch((function(e){a.consentDialog(!1),i.error("enumerateDevices error",e)}))}else F(e,o,r,i)}function O(e,t){(t=t||{}).success="function"==typeof t.success?t.success:B.noop,t.error="function"==typeof t.error?t.error:W;var n=t.jsep,i=b[e];if(null==i||null===i.webrtcStuff||void 0===i.webrtcStuff)return B.warn("Invalid handle"),void t.error("Invalid handle");var o=i.webrtcStuff;if(null!=n){if(null===o.pc)return B.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");o.pc.setRemoteDescription(n).then((function(){if(B.log("Remote description accepted!"),o.remoteSdp=n.sdp,o.candidates&&o.candidates.length>0){for(var e=0;e<o.candidates.length;e++){var i=o.candidates[e];B.debug("Adding remote candidate:",i),i&&!0!==i.completed?o.pc.addIceCandidate(i):o.pc.addIceCandidate(B.endOfCandidates)}o.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function N(e,t){var n=b[e];if(null==n||null===n.webrtcStuff||void 0===n.webrtcStuff)return B.warn("Invalid handle"),0;var i=t?"remote":"local",o=n.webrtcStuff;return o.volume[i]||(o.volume[i]={value:0}),o.pc.getStats&&"chrome"===B.webRTCAdapter.browserDetails.browser?!t||null!==o.remoteStream&&void 0!==o.remoteStream?t||null!==o.myStream&&void 0!==o.myStream?null===o.volume[i].timer||void 0===o.volume[i].timer?(B.log("Starting "+i+" volume monitor"),o.volume[i].timer=setInterval((function(){o.pc.getStats((function(e){for(var n=e.result(),r=0;r<n.length;r++){var a=n[r];"ssrc"==a.type&&(t&&a.stat("audioOutputLevel")?o.volume[i].value=parseInt(a.stat("audioOutputLevel")):!t&&a.stat("audioInputLevel")&&(o.volume[i].value=parseInt(a.stat("audioInputLevel"))))}}))}),200),0):o.volume[i].value:(B.warn("Local stream unavailable"),0):(B.warn("Remote stream unavailable"),0):(B.warn("Getting the "+i+" volume unsupported by browser"),0)}function U(e,t){var n=b[e];if(null==n||null===n.webrtcStuff||void 0===n.webrtcStuff)return B.warn("Invalid handle"),!0;var i=n.webrtcStuff;return null===i.pc||void 0===i.pc?(B.warn("Invalid PeerConnection"),!0):void 0===i.myStream||null===i.myStream?(B.warn("Invalid local MediaStream"),!0):t?null===i.myStream.getVideoTracks()||void 0===i.myStream.getVideoTracks()||0===i.myStream.getVideoTracks().length?(B.warn("No video track"),!0):!i.myStream.getVideoTracks()[0].enabled:null===i.myStream.getAudioTracks()||void 0===i.myStream.getAudioTracks()||0===i.myStream.getAudioTracks().length?(B.warn("No audio track"),!0):!i.myStream.getAudioTracks()[0].enabled}function V(e,t,n){var i=b[e];if(null==i||null===i.webrtcStuff||void 0===i.webrtcStuff)return B.warn("Invalid handle"),!1;var o=i.webrtcStuff;return null===o.pc||void 0===o.pc?(B.warn("Invalid PeerConnection"),!1):void 0===o.myStream||null===o.myStream?(B.warn("Invalid local MediaStream"),!1):t?null===o.myStream.getVideoTracks()||void 0===o.myStream.getVideoTracks()||0===o.myStream.getVideoTracks().length?(B.warn("No video track"),!1):(o.myStream.getVideoTracks()[0].enabled=!n,!0):null===o.myStream.getAudioTracks()||void 0===o.myStream.getAudioTracks()||0===o.myStream.getAudioTracks().length?(B.warn("No audio track"),!1):(o.myStream.getAudioTracks()[0].enabled=!n,!0)}function H(e){var t=b[e];if(null==t||null===t.webrtcStuff||void 0===t.webrtcStuff)return B.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return null===n.pc||void 0===n.pc?"Invalid PeerConnection":n.pc.getStats?null===n.bitrate.timer||void 0===n.bitrate.timer?(B.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval((function(){n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var i=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"==B.webRTCAdapter.browserDetails.browser&&(i/=1e3);var o=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/i);"safari"===B.webRTCAdapter.browserDetails.browser&&(o=parseInt(o/1e3)),n.bitrate.value=o+" kbits/sec",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):n.bitrate.value:(B.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser")}function W(e){B.error("WebRTC error:",e)}function K(e,t){B.log("Cleaning WebRTC stuff");var o=b[e];if(null!=o){var r=o.webrtcStuff;if(null!=r){if(!0===t){var a={rtcgw:"hangup",transaction:B.randomString(12)};null!==o.token&&void 0!==o.token&&(a.token=o.token),null!=v&&(a.apisecret=v),B.debug("Sending hangup request (handle="+e+"):"),B.debug(a),n?(a.session_id=T,a.handle_id=e,i.send(JSON.stringify(a))):B.httpAPICall(s+"/"+T+"/"+e,{verb:"POST",withCredentials:m,body:a})}r.remoteStream=null,r.volume&&(r.volume.local&&r.volume.local.timer&&clearInterval(r.volume.local.timer),r.volume.remote&&r.volume.remote.timer&&clearInterval(r.volume.remote.timer)),r.volume={},r.bitrate.timer&&clearInterval(r.bitrate.timer),r.bitrate.timer=null,r.bitrate.bsnow=null,r.bitrate.bsbefore=null,r.bitrate.tsnow=null,r.bitrate.tsbefore=null,r.bitrate.value=null;try{if(!r.streamExternal&&null!==r.myStream&&void 0!==r.myStream){B.log("Stopping local stream tracks");var d=r.myStream.getTracks();for(var c in d){var l=d[c];B.log(l),null!=l&&l.stop()}}}catch(e){}r.streamExternal=!1,r.myStream=null;try{r.pc.close()}catch(e){}r.pc=null,r.candidates=null,r.mySdp=null,r.remoteSdp=null,r.iceDone=!1,r.dataChannel={},r.dtmfSender=null}o.oncleanup()}}function Z(e){return B.debug("isAudioSendEnabled:",e),null==e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function G(e){return B.debug("isAudioRecvEnabled:",e),null==e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function J(e){return B.debug("isVideoSendEnabled:",e),null==e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function q(e){return B.debug("isVideoRecvEnabled:",e),null==e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}_(e),this.getServer=function(){return s},this.isConnected=function(){return S},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:B.noop,e.error="function"==typeof e.error?e.error:B.noop,e.reconnect=!0,_(e)},this.getSessionId=function(){return T},this.destroy=function(t){!function(t){(t=t||{}).success="function"==typeof t.success?t.success:B.noop;var a=!0;void 0!==t.asyncRequest&&null!==t.asyncRequest&&(a=!0===t.asyncRequest);var d=!0;void 0!==t.notifyDestroyed&&null!==t.notifyDestroyed&&(d=!0===t.notifyDestroyed);var c=!1;void 0!==t.cleanupHandles&&null!==t.cleanupHandles&&(c=!0===t.cleanupHandles);if(B.log("Destroying session "+T+" (async="+a+")"),!S)return B.warn("Is the server down? (connected=false)"),void t.success();if(null==T)return B.warn("No session to destroy"),t.success(),void(d&&e.destroyed());if(c)for(var l in b)z(l,{noRequest:!0});var u={rtcgw:"destroy",transaction:B.randomString(12)};null!=f&&(u.token=f);null!=v&&(u.apisecret=v);if(n){u.session_id=T;var p=function(){for(var e in o)i.removeEventListener(e,o[e]);i.removeEventListener("message",h),i.removeEventListener("error",g),r&&clearTimeout(r),i.close()},h=function(n){var i=JSON.parse(n.data);i.session_id==u.session_id&&i.transaction==u.transaction&&(p(),t.success(),d&&e.destroyed())},g=function(n){p(),t.error("Failed to destroy the server: Is the server down?"),d&&e.destroyed()};return i.addEventListener("message",h),i.addEventListener("error",g),void i.send(JSON.stringify(u))}B.httpAPICall(s+"/"+T,{verb:"POST",async:a,withCredentials:m,body:u,success:function(n){B.log("Destroyed session:"),B.debug(n),T=null,S=!1,"success"!==n.rtcgw&&B.error("Ooops: "+n.error.code+" "+n.error.reason),t.success(),d&&e.destroyed()},error:function(n,i){B.error(n+":",i),T=null,S=!1,t.success(),d&&e.destroyed()}})}(t)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:B.noop,e.error="function"==typeof e.error?e.error:B.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:B.noop,e.iceState="function"==typeof e.iceState?e.iceState:B.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:B.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:B.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:B.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:B.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:B.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:B.noop,e.ondata="function"==typeof e.ondata?e.ondata:B.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:B.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:B.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:B.noop,!S)return B.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var t=e.plugin;if(null==t)return B.error("Invalid plugin"),void e.error("Invalid plugin");var o=e.opaqueId,r=e.token?e.token:f,a=B.randomString(12),d={rtcgw:"attach",plugin:t,opaque_id:o,transaction:a};null!=r&&(d.token=r);null!=v&&(d.apisecret=v);if(n)return k[a]=function(n){if(B.debug(n),"success"!==n.rtcgw)return B.error("Ooops: "+n.error.code+" "+n.error.reason),void e.error("Ooops: "+n.error.code+" "+n.error.reason);var i=n.data.id;B.log("Created handle: "+i);var o={session:w,plugin:t,id:i,token:r,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return t},getVolume:function(){return N(i,!0)},getRemoteVolume:function(){return N(i,!0)},getLocalVolume:function(){return N(i,!1)},isAudioMuted:function(){return U(i,!1)},muteAudio:function(){return V(i,!1,!0)},unmuteAudio:function(){return V(i,!1,!1)},isVideoMuted:function(){return U(i,!0)},muteVideo:function(){return V(i,!0,!0)},unmuteVideo:function(){return V(i,!0,!1)},getBitrate:function(){return H(i)},send:function(e){j(i,e)},data:function(e){D(i,e)},dtmf:function(e){A(i,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){L(i,!0,e)},createAnswer:function(e){L(i,!1,e)},handleRemoteJsep:function(e){O(i,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){K(i,!0===e)},detach:function(e){z(i,e)}};b[i]=o,e.success(o)},d.session_id=T,void i.send(JSON.stringify(d));B.httpAPICall(s+"/"+T,{verb:"POST",withCredentials:m,body:d,success:function(n){if(B.debug(n),"success"!==n.rtcgw)return B.error("Ooops: "+n.error.code+" "+n.error.reason),void e.error("Ooops: "+n.error.code+" "+n.error.reason);var i=n.data.id;B.log("Created handle: "+i);var o={session:w,plugin:t,id:i,token:r,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return i},getPlugin:function(){return t},getVolume:function(){return N(i,!0)},getRemoteVolume:function(){return N(i,!0)},getLocalVolume:function(){return N(i,!1)},isAudioMuted:function(){return U(i,!1)},muteAudio:function(){return V(i,!1,!0)},unmuteAudio:function(){return V(i,!1,!1)},isVideoMuted:function(){return U(i,!0)},muteVideo:function(){return V(i,!0,!0)},unmuteVideo:function(){return V(i,!0,!1)},getBitrate:function(){return H(i)},send:function(e){j(i,e)},data:function(e){D(i,e)},dtmf:function(e){A(i,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){L(i,!0,e)},createAnswer:function(e){L(i,!1,e)},handleRemoteJsep:function(e){O(i,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){K(i,!0===e)},detach:function(e){z(i,e)}};b[i]=o,e.success(o)},error:function(e,t){B.error(e+":",t)}})}(e)}}B.useDefaultDependencies=function(e){var n=e&&e.fetch||fetch,i=e&&e.Promise||Promise,o=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new o(e,t)},extension:e&&e.extension||A,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||window.adapter,httpAPICall:function(e,o){var r={method:o.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===o.verb&&(r.headers["Content-Type"]="application/json"),void 0!==o.withCredentials&&(r.credentials=!0===o.withCredentials?"include":o.withCredentials?o.withCredentials:"omit"),void 0!==o.body&&(r.body=JSON.stringify(o.body));var a=n(e,r).catch((function(e){return i.reject({message:"Probably a network error, is the server down?",error:e})}));if(void 0!==o.timeout){var d=new i((function(e,t){var n=setTimeout((function(){return clearTimeout(n),t({message:"Request timed out",timeout:o.timeout})}),o.timeout)}));a=i.race([a,d])}return a.then((function(e){return e.ok?t(o.success)===t(B.noop)?e.json().then((function(e){o.success(e)})).catch((function(t){return i.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:i.reject({message:"API call failed",response:e})})).catch((function(e){t(o.error)===t(B.noop)&&o.error(e.message||"<< internal error >>",e)})),a}}},B.useOldDependencies=function(e){var n=e&&e.jQuery||jQuery,i=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new i(e,t)},isArray:function(e){return n.isArray(e)},extension:e&&e.extension||A,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,i){var o=void 0!==i.body?{contentType:"application/json",data:JSON.stringify(i.body)}:{},r=void 0!==i.withCredentials?{xhrFields:{withCredentials:i.withCredentials}}:{};return n.ajax(n.extend(o,r,{url:e,type:i.verb,cache:!1,dataType:"json",async:i.async,timeout:i.timeout,success:function(e){t(i.success)===t(B.noop)&&i.success(e)},error:function(e,n,o){t(i.error)===t(B.noop)&&i.error(n,o)}}))}}},B.noop=function(){},B.dataChanDefaultLabel="JanusDataChannel",B.endOfCandidates=null,B.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:B.noop,!0===B.initDone)e.callback();else{if("undefined"!=typeof console&&void 0!==console.log||(console={log:function(){}}),B.trace=B.noop,B.debug=B.noop,B.vdebug=B.noop,B.log=B.noop,B.warn=B.noop,B.error=B.noop,!0===e.debug||"all"===e.debug)B.trace=console.trace.bind(console),B.debug=console.debug.bind(console),B.vdebug=console.debug.bind(console),B.log=console.log.bind(console),B.warn=console.warn.bind(console),B.error=console.error.bind(console);else if(Array.isArray(e.debug))for(var t in e.debug){var n=e.debug[t];switch(n){case"trace":B.trace=console.trace.bind(console);break;case"debug":B.debug=console.debug.bind(console);break;case"vdebug":B.vdebug=console.debug.bind(console);break;case"log":B.log=console.log.bind(console);break;case"warn":B.warn=console.warn.bind(console);break;case"error":B.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+n+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}}B.log("Initializing library");var i=e.dependencies||B.useDefaultDependencies();B.isArray=i.isArray,B.webRTCAdapter=i.webRTCAdapter,B.httpAPICall=i.httpAPICall,B.newWebSocket=i.newWebSocket,B.extension=i.extension,B.extension.init(),B.listDevices=function(e,t){e="function"==typeof e?e:B.noop,null==t&&(t={audio:!0,video:!0}),B.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){B.debug(n),e(n);try{var i=t.getTracks();for(var o in i){var r=i[o];null!=r&&r.stop()}}catch(e){}}))})).catch((function(t){B.error(t),e([])})):(B.warn("navigator.mediaDevices unavailable"),e([]))},B.attachMediaStream=function(e,t){"chrome"===B.webRTCAdapter.browserDetails.browser?B.webRTCAdapter.browserDetails.version>=52?e.srcObject=t:void 0!==e.src?e.src=URL.createObjectURL(t):B.error("Error attaching stream to element"):e.srcObject=t},B.reattachMediaStream=function(e,t){"chrome"===B.webRTCAdapter.browserDetails.browser?B.webRTCAdapter.browserDetails.version>=52?e.srcObject=t.srcObject:void 0!==e.src?e.src=t.src:B.error("Error reattaching stream to element"):e.srcObject=t.srcObject};var o=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",r=window["on"+o];if(window.addEventListener(o,(function(e){for(var t in B.log("Closing window"),B.sessions)null!==B.sessions[t]&&void 0!==B.sessions[t]&&B.sessions[t].destroyOnUnload&&(B.log("Destroying session "+t),B.sessions[t].destroy({asyncRequest:!1,notifyDestroyed:!1}));r&&"function"==typeof r&&r()})),B.safariVp8=!1,"safari"===B.webRTCAdapter.browserDetails.browser&&B.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(var t in RTCRtpSender.getCapabilities("video").codecs){var a=RTCRtpSender.getCapabilities("video").codecs[t];if(a&&a.mimeType&&"video/vp8"===a.mimeType.toLowerCase()){B.safariVp8=!0;break}}B.safariVp8?B.log("This version of Safari supports VP8"):B.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var d=new RTCPeerConnection({},{});d.createOffer({offerToReceiveVideo:!0}).then((function(e){B.safariVp8=-1!==e.sdp.indexOf("VP8"),B.safariVp8?B.log("This version of Safari supports VP8"):B.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),d.close(),d=null}))}if(B.unifiedPlan=!1,"firefox"===B.webRTCAdapter.browserDetails.browser&&B.webRTCAdapter.browserDetails.version>=59)B.unifiedPlan=!0;else if("chrome"===B.webRTCAdapter.browserDetails.browser&&B.webRTCAdapter.browserDetails.version<72)B.unifiedPlan=!1;else if("undefined"==typeof RTCRtpTransceiver||"currentDirection"in RTCRtpTransceiver.prototype){var s=new RTCPeerConnection;try{s.addTransceiver("audio"),B.unifiedPlan=!0}catch(e){}s.close()}else B.unifiedPlan=!1;B.initDone=!0,e.callback()}},B.isWebrtcSupported=function(){return void 0!==window.RTCPeerConnection&&null!==window.RTCPeerConnection},B.isGetUserMediaAvailable=function(){return void 0!==navigator.mediaDevices&&null!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia&&null!==navigator.mediaDevices.getUserMedia},B.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",i=0;i<e;i++){var o=Math.floor(Math.random()*t.length);n+=t.substring(o,o+1)}return n},window.Janus=B;var z=null,F=null,L="tts-"+Janus.randomString(12),O=null;Janus=window.Janus,Janus.init({debug:"all",callback:function(){window.stopTalk=function(){z.destroy()},window.startTalk=function(){Janus.isWebrtcSupported()?z=new Janus({server:window.EZUIKit.opt.rtcUrl,success:function(){z.attach({plugin:"rtcgw.plugin.tts",opaqueId:L,success:function(e){F=e,Janus.log("Plugin attached! ("+F.getPlugin()+", id="+F.getId()+")");var t=window.EZUIKit.opt.talkLink;console.log("ttsUlr",t);var n={request:"start",url:t,codec:"opus",dir:"sendrecv",audio_debug:1};"gb28181"===window.EZUIKit.opt.talkType&&(n.devProto="gb28181"),Janus.debug("Trying a createOffer too (audio/video sendrecv)"),F.createOffer({media:{audio:!0,video:!1,data:!1},simulcast:!1,simulcast2:!1,success:function(e){Janus.debug("Got SDP!"),Janus.debug(e),F.send({message:n,jsep:e}),void 0!==window.EZUIKit.handleTalkSuccess&&window.EZUIKit.handleTalkSuccess()},error:function(e){Janus.error("WebRTC error:",e),void 0!==window.EZUIKit.handleTalkError&&window.EZUIKit.handleTalkError(e)}})},error:function(e){console.error("  -- Error attaching plugin...",e),bootbox.alert("Error attaching plugin... "+e),"undefined"!==window.EZUIKit.handleTalkError&&window.EZUIKit.handleTalkError(e)},consentDialog:function(e){Janus.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:function(e){Janus.log("ICE state changed to "+e)},mediaState:function(e,t){Janus.log("Janus "+(t?"started":"stopped")+" receiving our "+e)},webrtcState:function(e){Janus.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:function(e,t){Janus.warn("Janus reports problems "+(e?"sending":"receiving")+" packets on this PeerConnection ("+t+" lost packets)")},onmessage:function(e,t){Janus.debug(" ::: Got a message :::"),Janus.debug(e),null!=t&&(Janus.debug("Handling SDP as well..."),Janus.debug(t),F.handleRemoteJsep({jsep:t}));var n=e.result;if(null!=n){if("done"===n)return bootbox.alert("The TTS Test is over"),null!=O&&O.stop(),void(O=null);"msg"===n&&void 0!==window.EZUIKit.handleTalkMessage&&window.EZUIKit.handleTalkMessage(e),"slow_link"===n.status&&toastr.warning("Janus apparently missed many packets we sent, maybe we should reduce the bitrate","Packet loss?",{timeOut:2e3})}},onlocalstream:function(e){Janus.debug(" ::: Got a local stream :::"),Janus.debug(e),Janus.attachMediaStream(document.getElementById("myaudio"),e),"completed"!==F.webrtcStuff.pc.iceConnectionState&&"connected"!==F.webrtcStuff.pc.iceConnectionState&&(null==O?document.getElementById("audioright"):O.spin());var t=e.getAudioTracks();null==t||t.length},onremotestream:function(e){Janus.debug(" ::: Got a remote stream :::"),Janus.debug(e),Janus.attachMediaStream(document.getElementById("peeraudio"),e);var t=e.getAudioTracks();null==t||0===t.length||document.getElementById("peeraudio").play()},ondataopen:function(e){Janus.log("The DataChannel is available!")},ondata:function(e){Janus.debug("We got data from the DataChannel! "+e)},oncleanup:function(){Janus.log(" ::: Got a cleanup notification :::"),null!=O&&O.stop(),O=null}})},error:function(e){Janus.error(e),"undefined"!==window.EZUIKit.handleTalkError&&window.EZUIKit.handleTalkError(e)},destroyed:function(){}}):bootbox.alert("No WebRTC support... ")}}}),window.janus=z,window.tts=F;var N=function(){function e(t){var i=this;n(this,e),this.jSPlugin=t;var o=document.createElement("div");o.id="audioleft";var r=document.createElement("div");r.id="audioright",r.style="display:none;";var a=document.createElement("audio");a.id="myaudio",a.muted=!0,a.setAttribute("autoplay",!0),a.setAttribute("controls",!0),o.appendChild(a),o.style="display:none;";var d=document.createElement("audio");d.id="peeraudio",d.setAttribute("autoplay",!0),d.setAttribute("controls",!0),r.appendChild(d),window.EZUIKit.handleTalkError=function(e){console.log("talk err",e),void 0!==i.jSPlugin.handleTalkError&&i.jSPlugin.handleTalkError(e)},window.EZUIKit.handleTalkSuccess=function(e){console.log("talk success",e),void 0!==i.jSPlugin.handleTalkSuccess&&i.jSPlugin.handleTalkSuccess(e)},window.EZUIKit.opt={rtcUrl:"",talkLink:"",ttsUrl:"",stream:"",deviceSerial:f(this.jSPlugin.url).deviceSerial,channelNo:f(this.jSPlugin.url).channelNo},document.body.appendChild(o),document.body.appendChild(r)}return o(e,[{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"startTalk",value:function(){var e=this;if(this.jSPlugin.capacity&&this.jSPlugin.capacity.support_talk&&(!this.jSPlugin.capacity||"3"!==this.jSPlugin.capacity.support_talk&&"1"!==this.jSPlugin.capacity.support_talk))return"function"==typeof this.jSPlugin.params.handleError&&this.jSPlugin.params.handleError({msg:"设备不支持对讲",retcode:-1e3,id:this.jSPlugin.params.id,type:"handleError"}),console.log("设备不支持对讲"),!1;var t=new FormData;t.append("accessToken",this.jSPlugin.accessToken),t.append("deviceSerial",f(this.jSPlugin.url).deviceSerial),t.append("channelNo",f(this.jSPlugin.url).channelNo),fetch(this.jSPlugin.env.domain+"/api/lapp/live/talk/url",{method:"POST",body:t}).then((function(e){return e.json()})).then((function(t){if(200==t.code){var n=t.data;if(n){var i=n.rtcUrl;if(-1===i.indexOf("ws")&&(i=i.replace("https","wss").replace("rtcgw","rtcgw-ws")),window.EZUIKit.opt.rtcUrl=i,window.EZUIKit.opt.ttsUrl="tts://"+n.ttsUrl,window.EZUIKit.opt.deviceSerial=f(e.jSPlugin.url).deviceSerial,window.EZUIKit.opt.channelNo=f(e.jSPlugin.url).channelNo,2===window.EZUIKit.opt.ttsUrl.split("?").length){var o="talk?dev="+window.EZUIKit.opt.deviceSerial+"&chann="+window.EZUIKit.opt.channelNo+"&encodetype=2";window.EZUIKit.opt.talkLink=window.EZUIKit.opt.ttsUrl.split("?")[0]+"/"+o,window.EZUIKit.opt.talkType="gb28181"}else{o="talk://"+window.EZUIKit.opt.deviceSerial+":0:"+window.EZUIKit.opt.channelNo+":cas.ys7.com:6500";window.EZUIKit.opt.talkLink=window.EZUIKit.opt.ttsUrl.split("?")[0]+"/"+o}window.EZUIKit.opt.stream=n.stream,window.startTalk()}}else"function"==typeof e.jSPlugin.params.handleError&&e.jSPlugin.params.handleError({msg:t.msg,retcode:t.code,id:e.jSPlugin.params.id,type:"handleError"})})).catch((function(e){console.log("err",e)}))}},{key:"stopTalk",value:function(){window.stopTalk(),document.getElementById("myaudio")&&document.getElementById("myaudio").srcObject&&document.getElementById("myaudio").srcObject.getTracks()[0].stop()}}]),e}(),U=function(){function e(t){var i=this;n(this,e),this.jSPlugin=t;var o=document.createElement("style");o.innerHTML="\n    body{\n      padding: 0;\n      margin: 0;\n    }\n    #mobile-ez-ptz-container {\n      display: inline-block;\n      width: 375px;\n      text-align: center;\n    }\n    .live-ptz-title{\n      height: 25px;\n      font-size: 18px;\n      color: #2c2c2c;\n      text-align: center;\n      font-weight: 700;\n      margin: 24px 0 12px;\n    }\n    .live-ptz-intro {\n      margin-bottom: 24px;\n      color: #aaaaaa;\n    }\n    .mobile-ez-ptz-wrap {\n      background-image: linear-gradient(180deg, #f6f8ff 0%, #ededed6b 50%)\n    }\n    #mobile-ez-ptz-container .mobile-ez-ptz-container {\n      position: relative;\n      width: 260px;\n      height: 260px;\n      background: rgba(255, 255, 255, 0.80);\n      border: 1px solid rgba(255, 255, 255, 0.80);\n      border-radius: 100%;\n      cursor: pointer;\n      overflow: hidden;\n      margin: auto;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.top {\n      width: 0;\n      height: 0;\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-bottom: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 6px);\n      top: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.top.active {\n      border-bottom-color: #1890FF;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.bottom {\n      width: 0;\n      height: 0;\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-top: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      left: calc(50% - 6px);\n      bottom: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.bottom.active {\n      border-top-color: #1890FF;\n\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.right {\n      width: 0;\n      height: 0;\n      border-top: 6px solid transparent;\n      border-bottom: 6px solid transparent;\n      border-left: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 6px);\n      right: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.right.active {\n      border-left-color: #1890FF;\n\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.left {\n      width: 0;\n      height: 0;\n      border-top: 6px solid transparent;\n      border-bottom: 6px solid transparent;\n      border-right: 6px solid #aaaaaa;\n      position: absolute;\n      display: inline-block;\n      top: calc(50% - 6px);\n      left: 10px;\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .mobile-ez-ptz-icon.left.active {\n      border-right-color: #1890FF;\n\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-container .ez-ptz-main.center {\n      width: 52px;\n      height: 52px;\n      background: #FFFFFF;\n      border: 2px solid #eee;\n      border-radius: 100%;\n      top: calc(50% - 26px);\n      left: calc(50% - 26px);\n      position: absolute;\n      /* box-shadow: 0px -39px 40px 6px #1890ff; */\n    }\n\n    #mobile-ez-ptz-container .mobile-ez-ptz-wrap {\n      display: inline-block;\n      padding: 24px 24px;\n      border-radius: 100%;\n      overflow: hidden;\n    }\n\n    #mobile-ez-ptz-container .ez-ptz-close {\n      position: absolute;\n      color: #FFFFFF;\n      top: 0;\n      right: 0px;\n    }",document.getElementsByTagName("head")[0].appendChild(o);var r=document.createElement("div");r.className="mobile-ez-ptz-container",r.id="mobile-ez-ptz-container",r.style="display:inline-block;width: ".concat(this.jSPlugin.width,"px;text-align:center;");var a=document.createElement("div");a.className="live-ptz-title",a.id="live-ptz-title",a.innerHTML="云台控制",document.getElementById("live-ptz-title")||r.appendChild(a);var d=document.createElement("div");d.className="live-ptz-intro",d.id="live-ptz-intro",d.innerHTML="请通过操控云台来调整摄像机视角",document.getElementById("live-ptz-intro")||r.appendChild(d);var s=document.createElement("div");s.id="mobile-ez-ptz-item",s.className="mobile-ez-ptz-wrap",s.innerHTML='\n    <div class="mobile-ez-ptz-container" id="mobile-ez-ptz-container">\n      <div class="ez-ptz-main center"></div>\n      <div class="mobile-ez-ptz-icon top default"></div>\n      <div class="mobile-ez-ptz-icon left default"></div>\n      <div class="mobile-ez-ptz-icon bottom default"></div>\n      <div class="mobile-ez-ptz-icon right default"></div>\n    </div>\n      ',document.getElementById("mobile-ez-ptz-item")||r.appendChild(s),u(r,document.getElementById("".concat(this.jSPlugin.id,"-wrap"))),document.getElementById("mobile-ez-ptz-item").ontouchstart=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("mobile-ez-ptz-item").ontouchend=function(e){e.preventDefault(),console.log("触摸结束",e),i._handlePtzTouch(e,"stop")},document.getElementById("mobile-ez-ptz-item").onmousedown=function(e){e.preventDefault(),console.log("触摸开始"),i._handlePtzTouch(e,"start")},document.getElementById("mobile-ez-ptz-item").onmouseup=function(e){e.preventDefault(),console.log("触摸结束",e),i._handlePtzTouch(e,"stop")}}return o(e,[{key:"show",value:function(){document.getElementById("mobile-ez-ptz-item").style="display: inline-block"}},{key:"hide",value:function(){document.getElementById("mobile-ez-ptz-item").style="display: none"}},{key:"_handlePtzTouch",value:function(e,t){var n=document.getElementById("mobile-ez-ptz-item").getBoundingClientRect(),i=n.left+130,o=n.top+130,r=(e.x||e.changedTouches[0].clientX)-i,a=(e.y||e.changedTouches[0].clientY)-o,d=0,s=this.jSPlugin.env.domain+"/api/lapp/device/ptz/start";Math.abs(r)>Math.abs(a)?r>0?(d=3,document.getElementsByClassName("mobile-ez-ptz-icon")[3].className=document.getElementsByClassName("mobile-ez-ptz-icon")[3].className.replace("default","active")):(d=2,document.getElementsByClassName("mobile-ez-ptz-icon")[1].className=document.getElementsByClassName("mobile-ez-ptz-icon")[1].className.replace("default","active")):a>0?(d=1,document.getElementsByClassName("mobile-ez-ptz-icon")[2].className=document.getElementsByClassName("mobile-ez-ptz-icon")[2].className.replace("default","active")):(d=0,document.getElementsByClassName("mobile-ez-ptz-icon")[0].className=document.getElementsByClassName("mobile-ez-ptz-icon")[0].className.replace("default","active")),document.getElementById("mobile-ez-ptz-item").style="background-image:linear-gradient(".concat(0===d?180:1===d?0:2===d?90:270,"deg, #c0ddf1 0%, rgba(100,143,252,0.00) 50%)"),"stop"===t&&(s=this.jSPlugin.env.domain+"/api/lapp/device/ptz/stop",document.getElementById("mobile-ez-ptz-item").style="",document.getElementsByClassName("mobile-ez-ptz-icon")[3].className=document.getElementsByClassName("mobile-ez-ptz-icon")[3].className.replace("active","default"),document.getElementsByClassName("mobile-ez-ptz-icon")[1].className=document.getElementsByClassName("mobile-ez-ptz-icon")[1].className.replace("active","default"),document.getElementsByClassName("mobile-ez-ptz-icon")[2].className=document.getElementsByClassName("mobile-ez-ptz-icon")[2].className.replace("active","default"),document.getElementsByClassName("mobile-ez-ptz-icon")[0].className=document.getElementsByClassName("mobile-ez-ptz-icon")[0].className.replace("active","default"));var c=new FormData;c.append("deviceSerial",f(this.jSPlugin.url).deviceSerial),c.append("channelNo",f(this.jSPlugin.url).channelNo),c.append("speed",1),c.append("direction",d),c.append("accessToken",this.jSPlugin.accessToken),fetch(s,{method:"POST",body:c}).then((function(e){return e.json()})).then((function(e){200==e.code||60005!=e.code&&60002!=e.code&&60003!=e.code&&60004!=e.code||(document.getElementById("mobile-ez-ptz-item").style="background-image:linear-gradient(".concat(0===d?180:1===d?0:2===d?90:270,"deg, #f45656 0%, rgba(100,143,252,0.00) 50%)"))})).catch((function(e){console.log("云台调用异常",e)}))}}]),e}(),V={header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-0",iconId:"deviceID",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-1",iconId:"deviceName",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-2",iconId:"cloudRec",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-3",iconId:"rec",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"}]},footer:{color:"#FFFFFF",backgroundColor:"rgb(0 0 0 / 0%)",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-0",iconId:"play",part:"left",defaultActive:1,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-1",iconId:"capturePicture",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-2",iconId:"sound",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-3",iconId:"pantile",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-4",iconId:"recordvideo",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-5",iconId:"talk",part:"left",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-6",iconId:"hd",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-7",iconId:"webExpend",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-footer-8",iconId:"expend",part:"right",defaultActive:0,isrender:0,themeId:"f7896c8942c9476fb439370dd974f1c0"}]}},H={data:{header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:1},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:1},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}}},W={data:{header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:1},{iconId:"rec",part:"right",defaultActive:0,isrender:1}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"speed",part:"right",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}}},K={data:{header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-0",iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-1",iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-2",iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-3",iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:1},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:1},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"speed",part:"right",defaultActive:0,isrender:0},{iconId:"hd",part:"right",defaultActive:0,isrender:1},{iconId:"webExpend",part:"right",defaultActive:0,isrender:1},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}}},Z={data:{header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-0",iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-1",iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-2",iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{btnKey:"c1cbc1d4e86d49a0981f54beea95280a-f7896c8942c9476fb439370dd974f1c0-header-3",iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:1},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:1},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}}},G={data:{header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:0},{iconId:"deviceName",part:"left",defaultActive:0,isrender:0},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:0},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"sound",part:"left",defaultActive:1,isrender:0},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:0},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:0}]}}},J={data:{header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:0},{iconId:"rec",part:"right",defaultActive:0,isrender:0}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:0},{iconId:"talk",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:0},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"zoom",part:"left",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:0},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}}},q={data:{header:{color:"#FFFFFF",backgroundColor:"#000000",activeColor:"#1890FF",btnList:[{iconId:"deviceID",part:"left",defaultActive:0,isrender:1},{iconId:"deviceName",part:"left",defaultActive:0,isrender:1},{iconId:"cloudRec",part:"right",defaultActive:0,isrender:1},{iconId:"rec",part:"right",defaultActive:0,isrender:1}]},footer:{color:"#FFFFFF",backgroundColor:"#00000080",activeColor:"#1890FF",btnList:[{iconId:"play",part:"left",defaultActive:1,isrender:1},{iconId:"capturePicture",part:"left",defaultActive:0,isrender:1},{iconId:"sound",part:"left",defaultActive:1,isrender:1},{iconId:"pantile",part:"left",defaultActive:0,isrender:0},{iconId:"recordvideo",part:"left",defaultActive:0,isrender:1},{iconId:"zoom",part:"left",defaultActive:0,isrender:1},{iconId:"speed",part:"right",defaultActive:0,isrender:1},{iconId:"hd",part:"right",defaultActive:0,isrender:0},{iconId:"webExpend",part:"right",defaultActive:0,isrender:1},{iconId:"expend",part:"right",defaultActive:0,isrender:1}]}}},X=[{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"pcLive",themeIntro:"PC直播全量版",themeName:"PC直播全量版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:K.data.header,footer:K.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"security",themeIntro:"PC直播安防版",themeName:"PC直播安防版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:Z.data.header,footer:Z.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"voice",themeIntro:"PC直播语音版",themeName:"PC直播语音版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:J.data.header,footer:J.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"simple",themeIntro:"PC直播极简版",themeName:"PC直播极简版",themeType:"webLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"",header:G.data.header,footer:G.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"pcRec",themeIntro:"PC回放全量版",themeName:"PC回放全量版",themeType:"webRec",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_DmANlElAAA-xyivSaw030.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:q.data.header,footer:q.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"mobileLive",themeIntro:"Mobile直播全量版",themeName:"Mobile直播全量版",themeType:"mobileLive",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_GmAL5IhAABZs1vUK0s564.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:H.data.header,footer:H.data.footer},{autoFocus:5,createTime:"2021-06-14T08:04:37.000Z",themeId:"mobileRec",themeIntro:"Mobile回放全量版",themeName:"Mobile回放全量版",themeType:"mobileRec",updateTime:"2021-06-14T08:04:37.000Z",label:"官方",labelPic:"https://resource.eziot.com/group1/M00/00/8A/CtwQEmLr_GmAL5IhAABZs1vUK0s564.png",poster:"https://resource.eziot.com/group1/M00/00/89/CtwQEmLl8r-AZU7wAAETKlvgerU237.png",header:W.data.header,footer:W.data.footer}],Y=function(){function e(t){var i=this;n(this,e),this.jSPlugin=t,this.enableZoom=!1,this.isMouseDown=!1,this.videoWidth=1920,this.videoHeight=1080,this.currentScale=1,this.currentPosition={x:0,y:0,xPercent:.1,yPercent:.1,xCurrentVideo:0,yCurrentVideo:0,left:0,top:0,right:1920,bottom:1080},this.DOM=document.getElementById(t.id),this.clientRect=document.getElementById(t.id).getBoundingClientRect();var o=document.createElement("div");o.id="".concat(t.id,"-zoom-container"),o.style="position: absolute;\n    display:none;\n    left: 12px;\n    bottom: 80px;";var r='\n    <div\n    style="display: inline-flex;flex-direction: column;width: 38px;height: 160px;background:rgba(0,0,0,0.60);border-radius: 8px;align-items: center;">\n    <div id="'.concat(this.jSPlugin.id,'-scale-value" style="font-size: 12px;color:#FFFFFF;margin-top:10px;margin-bottom:4px;">2.0X</div>\n    <div style="width: 24px;" id="').concat(this.jSPlugin.id,'-addScale">\n      <?xml version="1.0" encoding="utf-8"?>\n      <svg version="1.1" fill="#FFFFFF" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n         viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" xml:space="preserve">\n      <title>放大</title>\n      <g id="矩形">\n        <rect class="st0" width="20" height="20" fill="none"/>\n      </g>\n      <g id="形状结合">\n        <path class="st1" d="M10,3.8c3.5,0,6.2,2.8,6.2,6.2s-2.8,6.2-6.2,6.2S3.8,13.5,3.8,10S6.5,3.8,10,3.8z M10,5c-2.8,0-5,2.2-5,5\n          s2.2,5,5,5s5-2.2,5-5S12.8,5,10,5z"/>\n      </g>\n      <g id="路径-4">\n        <path class="st2" d="M12.5,10.7h-5c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6h5c0.3,0,0.6,0.3,0.6,0.6S12.8,10.7,12.5,10.7z"/>\n      </g>\n      <g id="路径-4备份">\n        <path class="st2" d="M10,13.2c-0.3,0-0.6-0.3-0.6-0.6v-5c0-0.3,0.3-0.6,0.6-0.6s0.6,0.3,0.6,0.6v5C10.6,12.9,10.3,13.2,10,13.2z"/>\n      </g>\n      </svg>\n    </div>\n    <div style="\n    position: relative;\n    width: 1px;\n    height: 64px;\n    border: 1px solid rgba(255,255,255,0.75);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: flex-end;">\n    <div class="scale-body-line-dot" id="').concat(this.jSPlugin.id,'-scale-body-line-dot" style="width: 8px;\n      height: 8px;\n      background: #FFFFFF;\n      border-radius: 100%;\n      position: absolute;\n      border: 1.5px solid rgba(64,122,255,1);"></div>\n      <div id="').concat(this.jSPlugin.id,'-line-dot" style="width: 1px;\n      height: 0%;\n      background: #1890FF;\n      bottom: 0;"></div>\n    </div>\n    <div style="width: 24px;margin-top: 6px;" id="').concat(this.jSPlugin.id,'-subScale">\n      <?xml version="1.0" encoding="utf-8"?>\n      <svg fill="#FFFFFF" version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n        viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" xml:space="preserve">\n        <title>缩小</title>\n        <g id="矩形">\n          <rect class="st0" width="20" height="20" fill="none"/>\n        </g>\n        <g id="形状结合">\n          <path class="st1" d="M10,3.8c3.5,0,6.2,2.8,6.2,6.2s-2.8,6.2-6.2,6.2S3.8,13.5,3.8,10S6.5,3.8,10,3.8z M10,5c-2.8,0-5,2.2-5,5\n            s2.2,5,5,5s5-2.2,5-5S12.8,5,10,5z"/>\n        </g>\n        <g id="路径-4">\n          <path class="st2" d="M12.5,10.7h-5c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6h5c0.3,0,0.6,0.3,0.6,0.6S12.8,10.7,12.5,10.7z"/>\n        </g>\n      </svg>\n    </div>\n  </div>\n    ');o.innerHTML=r,document.getElementById("".concat(t.id,"-audioControls-left")).parentNode.appendChild(o),document.getElementById("".concat(t.id,"-addScale")).onclick=function(){i.addScale()},document.getElementById("".concat(t.id,"-subScale")).onclick=function(){i.subScale()}}return o(e,[{key:"onMouseDown",value:function(e){this.currentPosition,this.currentScale,this.moveX=e.clientX,this.moveY=e.clientY,this.isMouseDown=!0}},{key:"onMouseUp",value:function(e){var t=this.currentPosition;this.enableZoom,this.isMouseDown=!1,t.left=t.left-(e.clientX-this.moveX),t.top=t.top-(e.clientY-this.moveY),this.doScale()}},{key:"onMouseOut",value:function(e){this.isMouseDown&&(console.log("鼠标按上",e),this.isMouseDown=!1),this.isMouseDown=!1}},{key:"renderDot",value:function(){var e=this.currentScale;document.getElementById("".concat(this.jSPlugin.id,"-scale-value")).innerHTML="".concat(e,".0X"),document.getElementById("".concat(this.jSPlugin.id,"-line-dot")).style.height="".concat((e-1)/7*100,"%"),document.getElementById("".concat(this.jSPlugin.id,"-scale-body-line-dot")).style.bottom="calc(".concat((e-1)/7*100,"% - 6px)")}},{key:"startZoom",value:function(){var e=this,t=this.jSPlugin.jSPlugin._JSPlayM4_GetFrameInfo(0);this.videoWidth=t.width,this.videoHeight=t.height,this.currentPosition.right=t.width,this.currentPosition.bottom=t.height,this.currentScale=1,document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="block",this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight),this.renderDot(),this.enableZoom=!0,document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0"))?(document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0")).addEventListener("mousedown",(function(t){return e.onMouseDown(t)})),document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0")).addEventListener("mouseup",(function(t){return e.onMouseUp(t)})),document.getElementById("".concat(this.jSPlugin.id,"canvas_draw0")).addEventListener("mouseout",(function(t){return e.onMouseOut(t)}))):document.getElementById("".concat(this.jSPlugin.id,"-player"))&&(document.getElementById("".concat(this.jSPlugin.id,"-player")).addEventListener("mousedown",(function(t){return e.onMouseDown(t)})),document.getElementById("".concat(this.jSPlugin.id,"-player")).addEventListener("mouseup",(function(t){return e.onMouseUp(t)})),document.getElementById("".concat(this.jSPlugin.id,"-player")).addEventListener("mouseout",(function(t){return e.onMouseOut(t)})))}},{key:"stopZoom",value:function(){var e=this;this.currentScale=1,this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight),document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="none",this.renderDot(),this.enableZoom=!1,document.getElementById(this.jSPlugin.id).removeEventListener("mousedown",(function(t){return e.onMouseDown(t)})),document.getElementById(this.jSPlugin.id).removeEventListener("mouseup",(function(t){return e.onMouseUp(t)})),document.getElementById(this.jSPlugin.id).removeEventListener("mouseout",(function(t){return e.onMouseOut(t)}))}},{key:"doScale",value:function(){console.log("执行放大");var e=this.currentPosition,t=this.currentScale;e.left=e.left+e.xPercent*(e.right-e.left)-this.videoWidth/t*.5,e.left<0?e.left=0:e.left>this.videoWidth-this.videoWidth/t&&(e.left=this.videoWidth-this.videoWidth/t),e.right=e.left+this.videoWidth/t,e.top=e.top+e.yPercent*(e.bottom-e.top)-this.videoHeight/t*.5,e.top<0?e.top=0:e.top>this.videoHeight-this.videoHeight/t&&(e.top=this.videoHeight-this.videoHeight/t),e.bottom=e.top+this.videoHeight/t,e.left=parseInt(e.left,10),e.right=parseInt(e.right,10),e.top=parseInt(e.top,10),e.bottom=parseInt(e.bottom,10),console.log("计算后，",this.jSPlugin.jSPlugin,e.left,e.right,e.top,e.bottom,e.xPercent,e.yPercent),this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(e.left,e.right,e.top,e.bottom),this.renderDot()}},{key:"calCurrentPosition",value:function(e){var t=this.currentPosition,n=this.clientRect;t.x=e.clientX,t.y=e.clientY,t.xPercent=(e.clientX-n.x)/n.width,t.yPercent=(e.clientY-n.y)/n.height,this.doScale()}},{key:"addScale",value:function(){var e=this.currentScale,t=this.currentPosition;if(e>=8)return console.log("达到最大倍率了"),this.jSPlugin.Message&&this.jSPlugin.Message.default("已经放大到最大倍数8.0X"),!1;this.currentScale++,t.xPercent=.5,t.yPercent=.5,this.doScale()}},{key:"subScale",value:function(){var e=this.currentScale,t=this.currentPosition;if(e<=1)return console.log("达到最小倍率了"),!1;this.currentScale--,t.xPercent=.5,t.yPercent=.5,this.doScale()}}]),e}();function Q(e,t){return Math.abs(t.clientX-e.clientX)*Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)*Math.abs(t.clientY-e.clientY)}var ee=function(){function e(t){var i=this;n(this,e),this.jSPlugin=t,this.enableZoom=!1,this.isDubboTouch=!1,this.videoWidth=0,this.videoHeight=0,this.currentScale=1,this.currentPosition={x:0,y:0,xPercent:.1,yPercent:.1,xCurrentVideo:0,yCurrentVideo:0,left:0,top:0,right:1920,bottom:1080},this.DOM=document.getElementById(t.id),this.clientRect=document.getElementById(t.id).getBoundingClientRect(),this.point1={clientX:0,clientY:0},this.point2={clientX:0,clientY:0},this.touchLineLength=0,this.inited=!1;var o=document.createElement("div");o.id="".concat(t.id,"-zoom-container"),o.style="display:none;\n    position: absolute;\n    left: 10px;\n    top: -30px;\n    border: 1px solid rgba(0,0,0,0.6);\n    color: #FFFFFF;\n    background: rgba(0,0,0,0.6);\n    border-radius: 10px;\n    width: 36px;\n    font-size: 12px;\n    text-align: center;\n    height: 22px;\n    line-height: 22px;";o.innerHTML="1X",document.getElementById("".concat(t.id,"-audioControls-left")).parentNode.appendChild(o),document.getElementById(this.jSPlugin.id).addEventListener("touchstart",(function(e){return i.onTouchstart(e)})),document.getElementById(this.jSPlugin.id).addEventListener("touchmove",(function(e){return i.onTouchmove(e)}))}return o(e,[{key:"onTouchstart",value:function(e){if(!this.inited){var t=this.jSPlugin.jSPlugin._JSPlayM4_GetFrameInfo(0);this.videoWidth=t.width,this.videoHeight=t.height,this.currentPosition.right=t.width,this.currentPosition.bottom=t.height,this.inited=!0}var n=this.currentPosition;this.currentScale,console.log("双指按下",n);var i=e.touches,o=i[0],r=i[1];o&&(this.point1.clientX=o.clientX,this.point1.clientY=o.clientY),r&&(this.point2.clientX=r.clientX,this.point2.clientY=r.clientY,this.touchLineLength=Q(this.point1,this.point2),this.isDubboTouch=!0,this.moveX=o.clientX,this.moveY=o.clientY),console.log("双指按下2",n)}},{key:"onTouchmove",value:function(e){var t=this.isDubboTouch,n=this.currentPosition,i=this.clientRect;if(1===e.touches.length){var o=e.touches[0];return n.xPercent=n.xPercent+(this.point1.clientX-o.clientX)/i.width/this.currentScale,n.yPercent=n.yPercent+(this.point1.clientY-o.clientY)/i.height/this.currentScale,this.doScale(),this.point1.clientX=o.clientX,this.point1.clientY=o.clientY,!1}if(!t)return!1;var r=e.touches,a=(o=r[0],r[1]);if(o&&(this.point1.clientX=o.clientX,this.point1.clientY=o.clientY),a){this.point2.clientX=a.clientX,this.point2.clientY=a.clientY;var d=Q(this.point1,this.point2);d!==this.touchLineLength&&(d>this.touchLineLength?this.currentScale<8?(++this.currentScale,n.xPercent=(this.point1.clientX+this.point2.clientX)/2/i.width,n.yPercent=(this.point1.clientY+this.point2.clientY)/2/i.height,this.doScale()):console.log("已经是最大8倍率了"):this.currentScale>1?(--this.currentScale,n.xPercent=(this.point1.clientX+this.point2.clientX)/2/i.width,n.yPercent=(this.point1.clientY+this.point2.clientY)/2/i.height,this.doScale()):console.log("已经是最小1倍率了"),this.isDubboTouch=!1)}}},{key:"startZoom",value:function(){var e=this.jSPlugin.jSPlugin._JSPlayM4_GetFrameInfo(0);this.videoWidth=e.width,this.videoHeight=e.height,this.currentPosition.right=e.width,this.currentPosition.bottom=e.height,this.currentScale=1,document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="block",this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight),this.renderDot()}},{key:"stopZoom",value:function(){this.currentScale=1,this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(0,this.videoWidth,0,this.videoHeight),document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display="none",this.renderDot()}},{key:"doScale",value:function(){var e=this.currentPosition,t=this.currentScale;e.left=e.left+e.xPercent*(e.right-e.left)-this.videoWidth/t*.5,e.left<0?e.left=0:e.left>this.videoWidth-this.videoWidth/t&&(e.left=this.videoWidth-this.videoWidth/t),e.right=e.left+this.videoWidth/t,e.top=e.top+e.yPercent*(e.bottom-e.top)-this.videoHeight/t*.5,e.top<0?e.top=0:e.top>this.videoHeight-this.videoHeight/t&&(e.top=this.videoHeight-this.videoHeight/t),e.bottom=e.top+this.videoHeight/t,e.left=parseInt(e.left,10),e.right=parseInt(e.right,10),e.top=parseInt(e.top,10),e.bottom=parseInt(e.bottom,10),console.log("视频宽高",this.videoWidth,this.videoHeight),console.log("计算后，",e.left,e.right,e.top,e.bottom,e.xPercent,e.yPercent),e.left<e.right&&e.top<e.bottom&&e.bottom<=this.videoHeight&&e.right<=this.videoWidth&&this.jSPlugin.jSPlugin._JSPlayM4_SetDisplayRegion(e.left,e.right,e.top,e.bottom),document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).innerHTML="".concat(t,".0X"),document.getElementById("".concat(this.jSPlugin.id,"-zoom-container")).style.display=1===t?"none":"inline-block"}},{key:"calCurrentPosition",value:function(e){var t=this.currentPosition,n=this.clientRect;t.x=e.clientX,t.y=e.clientY,t.xPercent=(e.clientX-n.x)/n.width,t.yPercent=(e.clientY-n.y)/n.height,this.doScale()}}]),e}(),te=function(e){var t="";return Object.keys(e).map((function(n,i){t+="".concat(n,":").concat(e[n]).concat(i<Object.keys(e).length-1?";":"")})),t},ne=function(){function e(t){var i=this;if(n(this,e),this.jSPlugin=t,this.isNeedRenderHeader=!1,this.isNeedRenderFooter=!1,this.autoFocus=0,this.autoFocusTimer=null,this.recordTimer=null,this.nextRate=1,this.showHD=!1,this.decoderState={state:{isEditing:!1,play:!1,sound:!1,recordvideo:!1,recordCount:"00:00",talk:!1,zoom:!1,pantile:!1,hd:!1,speed:!1,expend:!1,webExpend:!1,cloudRec:"cloud.rec"===f(t.url).type,rec:"rec"===f(t.url).type,type:f(t.url).type}},console.log(" matchEzopenUrl(jSPlugin.url)",f(t.url),this.decoderState.state),this.inited=!1,this.isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),void 0!==t.isMobile&&(this.isMobile=t.isMobile),this.themeData=V,this.jSPlugin.themeId)switch(this.jSPlugin.themeId){case"pcLive":case"pcRec":case"mobileLive":case"mobileRec":case"security":case"voice":case"simple":var o=S.find(X,(function(e){return e.themeId===i.jSPlugin.themeId}));o&&(this.themeData=o),this.initThemeData(),this.renderThemeData();break;case"themeData":this.themeData=this.jSPlugin.params.themeData,this.initThemeData(),this.renderThemeData();break;default:this.fetchThemeData(this.jSPlugin.themeId)}this.jSPlugin.Talk||(this.jSPlugin.Talk=new N(this.jSPlugin)),s("".concat(this.jSPlugin.staticPath,"/speed/speed.css")),s("".concat(this.jSPlugin.staticPath,"/css/theme.css"))}return o(e,[{key:"fetchThemeData",value:function(e){var t=this,n="".concat(this.jSPlugin.env.domain,"/console/jssdk/ezopen/template/getDetail?accessToken=").concat(this.jSPlugin.accessToken,"&id=").concat(e);"test11open.ys7.com"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&"jianboyu.top"!==window.location.hostname||(n=n.replace("test12open.ys7.com/console/jssdk","test11open.ys7.com/console/jssdk")),fetch(n,{method:"GET"}).then((function(e){return e.json()})).then((function(e){console.log("get theme data",e),0===e.meta.code&&e.data&&(t.themeData=e.data,e.data.header&&(t.themeData.header=e.data.header,t.themeData.header.btnList=t.themeData.header.btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),e.data.footer&&(t.themeData.footer=e.data.footer,t.themeData.footer.btnList=t.themeData.footer.btnList.sort((function(e,t){return e.btnKey.split("-")[3]-t.btnKey.split("-")[3]}))),t.initThemeData(),t.renderThemeData())})).catch((function(e){t.renderThemeData()}))}},{key:"changeTheme",value:function(e){var n=this;if("string"==typeof e)switch(this.jSPlugin.themeId=e,this.jSPlugin.themeId){case"pcLive":case"pcRec":case"mobileLive":case"mobileRec":case"security":case"voice":case"simple":var i=S.find(X,(function(e){return e.themeId===n.jSPlugin.themeId}));i&&(this.themeData=i),this.initThemeData(),this.renderThemeData();break;default:this.fetchThemeData(e)}else"object"===t(e)&&(this.themeData=e,this.initThemeData(),this.renderThemeData(),this.decoderState.state.isEditing&&this.editStart());this.jSPlugin&&this.jSPlugin.handleThemeChange&&this.jSPlugin.handleThemeChange(e)}},{key:"renderThemeData",value:function(){var e=this,t=this.themeData,n=t.header,i=t.footer;if(this.isNeedRenderHeader&&n&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.background=n.backgroundColor.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.color=n.color.replace("-diy",""),n.btnList.map((function(t,n){t.isrender&&e.setDecoderState(r({},t.iconId,e.decoderState.state[t.iconId]))}))),this.isNeedRenderFooter&&i)document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=i.backgroundColor.replace("-diy",""),document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=i.color.replace("-diy",""),i.btnList.map((function(t,n){if(t.isrender&&e.setDecoderState(r({},t.iconId,e.decoderState.state[t.iconId])),"play"===t.iconId&&t.defaultActive)var i=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(i),e.jSPlugin.play())}),50)})),-1!==this.jSPlugin.url.indexOf("hd.live")&&this.setDecoderState({hd:!0}),this.themeData.autoFocus>0&&(this.autoFocus=parseInt(this.themeData.autoFocus),this.startAutoFocus(),document.getElementById("".concat(this.jSPlugin.id,"-wrap")).addEventListener("click",(function(){e.stopAutoFocus()})));else var o=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(o),e.jSPlugin.play())}),50);S.findIndex(this.themeData.footer.btnList,(function(e){return"zoom"===e.iconId&&e.isrender>0}))>=0&&(this.isMobile?this.jSPlugin.Zoom=new ee(this.jSPlugin):this.jSPlugin.Zoom=new Y(this.jSPlugin));var a=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(a),e.jSPlugin.reSize(e.jSPlugin.params.width,e.jSPlugin.params.height))}),50)}},{key:"setDecoderState",value:function(e){var t=this,n=this.themeData,i=n.header,o=n.footer;Object.keys(e).map((function(n,r){var a="#FFFFFF",d="#FFFFFF";switch(-1===i.btnList.findIndex((function(e){return e.iconId===n}))?(a=o.color.replace("-diy",""),d=o.activeColor.replace("-diy","")):(a=i.color.replace("-diy",""),d=o.activeColor.replace("-diy","")),n){case"play":e[n]?document.getElementById("".concat(t.jSPlugin.id,"-play"))&&(document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[1].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-play")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).childNodes[0].children[0].style.fill=e[n]?d:a):document.getElementById("".concat(t.jSPlugin.id,"-play"))&&(document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).children[0].children[0].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-play")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-play-content")).childNodes[0].children[1].style.fill=e[n]?d:a);break;case"sound":document.getElementById("".concat(t.jSPlugin.id,"-sound"))&&(e[n]?(document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[0].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-sound")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).childNodes[0].children[1].style.fill=e[n]?d:a):(document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).children[0].children[1].style="display:none",document.getElementById("".concat(t.jSPlugin.id,"-sound")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-sound-content")).childNodes[0].children[0].style.fill=e[n]?d:a));break;case"recordvideo":document.getElementById("".concat(t.jSPlugin.id,"-recordvideo"))&&(document.getElementById("".concat(t.jSPlugin.id,"-recordvideo")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-recordvideo-content")).childNodes[0].style.fill=e[n]?d:a,e[n]?t.countTime("add",0):t.countTime("destroy",0));break;case"talk":document.getElementById("".concat(t.jSPlugin.id,"-talk"))&&(document.getElementById("".concat(t.jSPlugin.id,"-talk")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-talk-content")).childNodes[1].style.fill=e[n]?d:a);break;case"zoom":document.getElementById("".concat(t.jSPlugin.id,"-zoom"))&&(document.getElementById("".concat(t.jSPlugin.id,"-zoom")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-zoom-content")).childNodes[1].style.fill=e[n]?d:a);break;case"pantile":document.getElementById("".concat(t.jSPlugin.id,"-pantile"))&&(document.getElementById("".concat(t.jSPlugin.id,"-pantile")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-pantile-content")).childNodes[0].style.fill=e[n]?d:a);break;case"webExpend":e[n]?(document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[0].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend")).className="disabled")):(document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).children[0].children[1].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend")).className="")),document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).childNodes[0].childNodes[0].style.fill=e[n]?d:a,document.getElementById("".concat(t.jSPlugin.id,"-webExpend-content")).childNodes[0].childNodes[1].style.fill=e[n]?d:a);break;case"capturePicture":document.getElementById("".concat(t.jSPlugin.id,"-capturePicture"))&&(document.getElementById("".concat(t.jSPlugin.id,"-capturePicture")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-capturePicture-content")).childNodes[0].style.fill=e[n]?d:a);break;case"expend":e[n]?(document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[1].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[0].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend")).className="disabled")):(document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[0].style="display:inline-block",document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).children[0].children[1].style="display:none"),document.getElementById("".concat(t.jSPlugin.id,"-webExpend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-webExpend")).className="")),document.getElementById("".concat(t.jSPlugin.id,"-expend"))&&(document.getElementById("".concat(t.jSPlugin.id,"-expend")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).childNodes[0].childNodes[0].style.fill=e[n]?d:a,document.getElementById("".concat(t.jSPlugin.id,"-expend-content")).childNodes[0].childNodes[1].style.fill=e[n]?d:a);break;case"hd":e[n]?document.getElementById("".concat(t.jSPlugin.id,"-hd"))&&(document.getElementById("".concat(t.jSPlugin.id,"-hd-content")).children[1].children[0].style="display:block",document.getElementById("".concat(t.jSPlugin.id,"-hd-content")).children[1].children[1].style="display:none"):document.getElementById("".concat(t.jSPlugin.id,"-hd"))&&(document.getElementById("".concat(t.jSPlugin.id,"-hd-content")).children[1].children[1].style="display:block",document.getElementById("".concat(t.jSPlugin.id,"-hd-content")).children[1].children[0].style="display:none");break;case"speed":document.getElementById("".concat(t.jSPlugin.id,"-speed"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speed-content")).children[1].children[0].style.color=e[n]?d:a,document.getElementById("".concat(t.jSPlugin.id,"-speed-content")).children[1].children[0].style.borderColor=e[n]?d:a),t.isMobile&&e[n]?document.getElementById("".concat(t.jSPlugin.id,"-select-mask")).style.display="block":document.getElementById("".concat(t.jSPlugin.id,"-select-mask")).style.display="none";break;case"cloudRec":document.getElementById("".concat(t.jSPlugin.id,"-cloudRec"))&&(console.log("document.getElementById(`${this.jSPlugin.id}-cloudRec-content`)",document.getElementById("".concat(t.jSPlugin.id,"-cloudRec"))),document.getElementById("".concat(t.jSPlugin.id,"-cloudRec")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-cloudRec-content")).children[0].children[0].style.fill=e[n]?d:a),document.getElementById("".concat(t.jSPlugin.id,"-rec"))&&(document.getElementById("".concat(t.jSPlugin.id,"-rec")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-rec-content")).children[0].children[0].style.fill=e[n]?a:d);break;case"rec":document.getElementById("".concat(t.jSPlugin.id,"-cloudRec"))&&(document.getElementById("".concat(t.jSPlugin.id,"-cloudRec")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-cloudRec-content")).children[0].children[0].style.fill=e[n]?a:d),document.getElementById("".concat(t.jSPlugin.id,"-rec"))&&(document.getElementById("".concat(t.jSPlugin.id,"-rec")).className=e[n]?"active":"",document.getElementById("".concat(t.jSPlugin.id,"-rec-content")).children[0].children[0].style.fill=e[n]?d:a)}t.decoderState.state=Object.assign(t.decoderState.state,e)}))}},{key:"startAutoFocus",value:function(){var e=this;console.log("开始自动隐藏",this.autoFocus);var t=this.autoFocus;this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.autoFocusTimer=setTimeout((function(){document.getElementById("".concat(e.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(e.jSPlugin.id,"-audioControls")).style.opacity=0)}),1e3*t)}},{key:"stopAutoFocus",value:function(){console.log("结束自动隐藏"),document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.opacity=1),this.autoFocusTimer&&clearTimeout(this.autoFocusTimer),this.startAutoFocus()}},{key:"toString",value:function(){return"".concat(this.coreX,"-").concat(this.coreY)}},{key:"renderFooter",value:function(e,t){var n=this,i=this.matchBtn(e);if(this.isMobile&&"zoom"===i.id)return!1;var o=document.createElement("div");o.className="theme-icon-item",o.innerHTML="".concat('<span id="'.concat(this.jSPlugin.id,"-").concat(i.id,'" style="position:relative;">')+'<div id="'.concat(this.jSPlugin.id,"-").concat(i.id,'-content" title="').concat(i.title,'" style="height:').concat(this.jSPlugin.width>500?48:32,'px;display: flex;align-items: center;position:relative;">')).concat(i.domString,"</div>")+"</span>",o.onclick=function(e){if(n.decoderState.state.isEditing)return!1;i.onclick(e)},i.onmouseenter&&(o.onmouseenter=function(e){if(n.decoderState.state.isEditing)return!1;i.onmouseenter(e)}),i.onmouseleave&&(o.onmouseleave=function(e){if(n.decoderState.state.isEditing)return!1;i.onmouseleave(e)});var r=document.createElement("span");r.className="icon-move left",r.innerHTML='<span id="'.concat(this.jSPlugin.id,"-").concat(i.id,'-left" title="左移" style="position: absolute;top: calc(50% - 10px);left: -4px;"><svg fill="#ffffff" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="24" viewBox="0 0 10 15" style="background:#00000080;"><path d="M7.4,10V5.3c0-0.3-0.3-0.6-0.6-0.6c-0.1,0-0.3,0.1-0.4,0.2L3.7,7.4c-0.2,0.2-0.3,0.6,0,0.8 c0,0,0,0,0.1,0.1l2.7,2.2c0.2,0.2,0.6,0.2,0.8-0.1C7.3,10.3,7.4,10.2,7.4,10z"></path></svg></span>'),r.onclick=function(){n.editIcon(i.id,"left","footer")},o.appendChild(r);var a=document.createElement("span");a.className="icon-move right",a.innerHTML='<span id="'.concat(this.jSPlugin.id,"-").concat(i.id,'-right" class="ezuikit-theme-icon" title="右移" style="position: absolute;top: calc(50% - 10px);left: calc(100% - 8px);"><svg fill="#ffffff" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="24" viewBox="0 0 10 15" style="background:#00000080"><path d="M3.4,5.2v4.7c0,0.3,0.3,0.6,0.6,0.6c0.1,0,0.3-0.1,0.4-0.2l2.7-2.5c0.2-0.2,0.3-0.6,0-0.8 c0,0,0,0-0.1-0.1L4.4,4.8C4.1,4.6,3.8,4.6,3.6,4.9C3.5,5,3.4,5.1,3.4,5.2z"></path></svg></span>'),a.onclick=function(){n.editIcon(i.id,"right","footer")},o.appendChild(a);var d=document.createElement("span");d.className="icon-move close",d.innerHTML='<span id="'.concat(i.id,'-remove" class="ezuikit-theme-icon" title="移除" style="position: absolute;top: -10px;right: -10px;">')+'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 15 15"><circle style="fill-rule:evenodd;clip-rule:evenodd;fill-opacity:0.8011;" cx="7.5" cy="7.6" r="7" /><rect x="3.9" y="3.5" class="st1" style="fill:none;" width="8.1" height="8.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="5" x2="10" y2="10.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="10.1" x2="10" y2="5" /></svg></span>',d.onclick=function(){n.editIcon(i.id,"delete","footer")},o.appendChild(d),"left"===t?document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).childNodes[0].appendChild(o):document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).childNodes[1].appendChild(o)}},{key:"editIcon",value:function(e,t,n){console.log("编辑组件",e,t,n);var i=this.themeData;console.log("themeData",this.themeData);var o=this.themeData[n].btnList,r=S.findIndex(o,(function(t){return t.iconId===e})),a=o[r];switch(t){case"delete":if("rec"===e){if(-1===S.findIndex(o,(function(e){return"cloudRec"===e.iconId&&1==e.isrender})))return this.jSPlugin.Message&&this.jSPlugin.Message.default("必须选中一种存储介质"),!1}else if("cloudRec"===e&&-1===S.findIndex(o,(function(e){return"rec"===e.iconId&&1==e.isrender})))return this.jSPlugin.Message&&this.jSPlugin.Message.default("必须选中一种存储介质"),!1;o[r].isrender=0;break;case"right":for(var d=-1,s=r+1;s<o.length;s++)if(o[s].part===o[r].part&&1==o[s].isrender){d=s;break}-1!==d&&(o[r]=o[d],o[d]=a);break;case"left":for(var c=-1,l=r-1;l>=0;l--)if(o[l].part===o[r].part&&1==o[l].isrender){c=l;break}-1!==c&&(o[r]=o[c],o[c]=a)}console.log("new btnList",o),i[n].btnList=o,this.changeTheme(i)}},{key:"renderHeader",value:function(e,t){var n=this,i=this.matchBtn(e),o=document.createElement("div");o.className="theme-icon-item",o.innerHTML="".concat('<span id="'.concat(this.jSPlugin.id,"-").concat(i.id,'" style="position:relative";>')+'<span id="'.concat(this.jSPlugin.id,"-").concat(i.id,'-content" title="').concat(i.title,'" style="display:inline-block;height:').concat(this.width>500?48:32,'px;">')).concat(i.domString,"</span>")+'<span id="'.concat(this.jSPlugin.id,"-").concat(i.id,'-remove" title="移除" style="position: absolute;top: -6px;left: 38px;display: none;">')+'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 15 15"><circle style="fill-rule:evenodd;clip-rule:evenodd;fill-opacity:0.8011;" cx="7.5" cy="7.6" r="7" /><rect x="3.9" y="3.5" class="st1" style="fill:none;" width="8.1" height="8.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="5" x2="10" y2="10.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="10.1" x2="10" y2="5" /></svg></span></span>',o.onclick=function(e){if(n.decoderState.state.isEditing)return!1;i.onclick(e)};var r=document.createElement("span");r.className="icon-move close",r.innerHTML='<span id="'.concat(i.id,'-remove" class="ezuikit-theme-icon" title="移除" style="position: absolute;top: -6px;right: -6px;">')+'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 15 15"><circle style="fill-rule:evenodd;clip-rule:evenodd;fill-opacity:0.8011;" cx="7.5" cy="7.6" r="7" /><rect x="3.9" y="3.5" class="st1" style="fill:none;" width="8.1" height="8.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="5" x2="10" y2="10.1" /><line style="fill:none;stroke:#ffffff;stroke-width:0.5833;stroke-linecap:round;" x1="4.9" y1="10.1" x2="10" y2="5" /></svg></span>',r.onclick=function(){n.editIcon(i.id,"delete","header")},o.appendChild(r),"left"===t?document.getElementById("".concat(this.jSPlugin.id,"-headControl")).childNodes[0].appendChild(o):document.getElementById("".concat(this.jSPlugin.id,"-headControl")).childNodes[1].appendChild(o)}},{key:"countTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this;if(!document.getElementById(this.jSPlugin.id+"time-area")){var i=document.createElement("div");i.id=this.jSPlugin.id+"time-area",i.className="time-area",i.innerHTML='<span class="dot"></span><span class="value">00:00</span>',document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).appendChild(i)}if(this.countTimer&&clearInterval(this.countTimer),"add"===e){var o=t;document.getElementById(n.jSPlugin.id+"time-area").style.display="flex",this.countTimer=setInterval((function(){++o,document.getElementById(n.jSPlugin.id+"time-area").children[1].innerHTML=r(o)}),1e3)}else"destroy"===e&&(this.countTimer&&clearInterval(this.countTimer),this.countTimer=void 0,document.getElementById(n.jSPlugin.id+"time-area")&&(document.getElementById(n.jSPlugin.id+"time-area").children[1].innerHTML="00:00",document.getElementById(n.jSPlugin.id+"time-area").style.display="none"));function r(e){var t,n,i,o=parseInt(e),r=0,a=0;return o>59&&(r=parseInt(o/60),o=parseInt(o%60),r>59&&(a=parseInt(r/60),r=parseInt(r%60))),t=parseInt(o)>9?parseInt(o):"0"+parseInt(o),n=parseInt(r)>9?parseInt(r):"0"+parseInt(r),i=parseInt(a)>9?parseInt(a):"0"+parseInt(a),a>0?i+":"+n+":"+t:r>0?n+":"+t:"00:"+t}}},{key:"matchBtn",value:function(e){var t=this,n=this.themeData,i=n.header,o=n.footer,r={title:"",id:"",domString:"",color:"#FFFFFF",activeColor:"#FFFFFF",onclick:function(){},onmoveleft:function(){},onmoveright:function(){},onremove:function(){}};switch(-1===i.btnList.findIndex((function(t){return t.iconId===e}))?(r.color=o.color,r.backgroundColor=o.backgroundColor,r.activeColor=o.activeColor):(r.color=i.color,r.backgroundColor=i.backgroundColor,r.activeColor=i.activeColor),e){case"play":return r.title="播放/结束播放",r.id=e,r.domString='<div style="height: 100%">'+'<svg style="display:none" width="'.concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'"  fill="').concat(r.color,'" viewBox="-6 -6 32 32">\n            <path id="Stroke-1" class="st1" d="M10.5,1.7c-4.9,0-8.8,4-8.8,8.8s4,8.8,8.8,8.8s8.8-4,8.8-8.8S15.4,1.7,10.5,1.7z M10.5,2.7\n              c4.3,0,7.8,3.5,7.8,7.8s-3.5,7.8-7.8,7.8s-7.8-3.5-7.8-7.8S6.2,2.7,10.5,2.7z"/>\n            <path class="st2" d="M8.7,8C9,8,9.3,8.3,9.3,8.6v3.8C9.3,12.7,9,13,8.7,13C8.3,13,8,12.7,8,12.4V8.6C8,8.3,8.3,8,8.7,8z"/>\n            <path id="Rectangle-Copy-10" class="st2" d="M12.8,8c0.3,0,0.6,0.3,0.6,0.6v3.8c0,0.3-0.3,0.6-0.6,0.6c-0.3,0-0.6-0.3-0.6-0.6V8.6\n              C12.2,8.3,12.5,8,12.8,8z"/>\n          </svg>')+'<svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M13,9.8L10.1,8C9.9,7.9,9.7,7.9,9.5,7.9c-0.6,0-1,0.4-1,1v3.7c0,0.2,0.1,0.4,0.2,0.5c0.3,0.5,0.9,0.6,1.4,0.3 l2.9-1.8c0.1-0.1,0.2-0.2,0.3-0.3C13.6,10.7,13.4,10.1,13,9.8z" /><path d="M10.5,1.9c-4.9,0-8.8,4-8.8,8.8c0,4.9,4,8.8,8.8,8.8s8.8-4,8.8-8.8C19.4,5.8,15.4,1.9,10.5,1.9z M10.5,18.5 c-4.3,0-7.8-3.5-7.8-7.8s3.5-7.8,7.8-7.8c4.3,0,7.8,3.5,7.8,7.8S14.9,18.5,10.5,18.5z" /></svg></div>',r.onclick=function(){var e=t.decoderState.state,n=e.play;if(e.isEditing)return!1;n?t.jSPlugin.stop():t.jSPlugin.play(),t.setDecoderState({play:!n})},r;case"sound":return r.title="声音",r.id=e,r.domString='<span style="height: 100%">'+'<svg style="display:none" fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">\n            <path d="M8.5,4.2c0.8-0.7,2.1-0.2,2.2,0.9l0,0.1v10c0,1.1-1.2,1.7-2.1,1.1l-0.1-0.1l-3.3-2.8C5,13.2,5,12.9,5.1,12.7 c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.3,2.8c0.2,0.2,0.5,0.1,0.5-0.2l0-0.1v-10c0-0.3-0.3-0.4-0.5-0.3L9.2,5L5.9,7.8 C5.6,7.9,5.3,7.9,5.1,7.7C5,7.5,5,7.3,5.1,7.1L5.2,7L8.5,4.2z"/>\n            <path d="M5.5,6.9C5.8,6.9,6,7.1,6,7.4c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2C3.4,7.9,3.3,8,3.2,8.2l0,0.1v4 c0,0.2,0.1,0.3,0.3,0.3l0.1,0h2C5.8,12.5,6,12.7,6,13c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2c-0.7,0-1.3-0.5-1.3-1.2l0-0.1v-4 c0-0.7,0.5-1.3,1.2-1.3l0.1,0H5.5z"/>\n            <path d="M17.4,7.9c0.2-0.2,0.5-0.2,0.7,0c0.2,0.2,0.2,0.4,0.1,0.6l-0.1,0.1l-3.8,3.8c-0.2,0.2-0.5,0.2-0.7,0 c-0.2-0.2-0.2-0.4-0.1-0.6l0.1-0.1L17.4,7.9z"/>\n            <path d="M13.7,7.9c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.8,3.8c0.2,0.2,0.2,0.5,0,0.7c-0.2,0.2-0.4,0.2-0.6,0.1l-0.1-0.1 l-3.7-3.8C13.5,8.4,13.5,8.1,13.7,7.9z"/>\n            </svg>')+'<svg style="display:inline-block" width="'.concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" fill="').concat(r.color,'" viewBox="-6 -6 32 32">\n              <path d="M13.2,7.1c0.1-0.2,0.5-0.3,0.7-0.2c1.1,0.7,1.9,2.2,1.9,3.7c0,1.6-0.7,3-1.9,3.7\n                c-0.2,0.1-0.5,0.1-0.7-0.2c-0.1-0.2-0.1-0.5,0.2-0.7c0.8-0.5,1.4-1.6,1.4-2.9c0-1.3-0.6-2.4-1.4-2.9C13.1,7.6,13,7.3,13.2,7.1z"/>\n              <path d="M15.7,4.5c0.2-0.2,0.5-0.2,0.7-0.1C18,5.8,19,8.2,19,10.7c0,2.5-1,4.8-2.7,6.3\n                c-0.2,0.2-0.5,0.2-0.7-0.1c-0.2-0.2-0.2-0.5,0.1-0.7c1.4-1.2,2.3-3.3,2.3-5.5c0-2.2-0.9-4.3-2.3-5.5C15.5,5,15.5,4.7,15.7,4.5z"/>\n              <path id="Stroke-5" class="st1" d="M8.5,4.7c0.8-0.7,2.1-0.2,2.2,0.9l0,0.1v10c0,1.1-1.2,1.7-2.1,1.1l-0.1-0.1l-3.3-2.8\n                C5,13.7,5,13.4,5.1,13.2c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.3,2.8c0.2,0.2,0.5,0.1,0.5-0.2l0-0.1v-10c0-0.3-0.3-0.4-0.5-0.3l-0.1,0\n                L5.9,8.3C5.6,8.4,5.3,8.4,5.1,8.2C5,8,5,7.7,5.1,7.6l0.1-0.1L8.5,4.7z"/>\n              <path  d="M5.5,7.4C5.8,7.4,6,7.6,6,7.9c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2c-0.2,0-0.3,0.1-0.3,0.3l0,0.1v4\n                c0,0.2,0.1,0.3,0.3,0.3l0.1,0h2C5.8,13,6,13.2,6,13.5c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-2c-0.7,0-1.3-0.5-1.3-1.2l0-0.1v-4\n                c0-0.7,0.5-1.3,1.2-1.3l0.1,0H5.5z"/>\n            </svg>')+"</span>",r.onclick=function(){var e=t.decoderState.state,n=e.play,i=e.sound;n&&(i?(t.jSPlugin.closeSound(),t.setDecoderState({sound:!1})):(t.jSPlugin.openSound(),t.setDecoderState({sound:!0})))},r;case"recordvideo":return r.title="录屏",r.id=e,r.domString='<svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M11.6,5.3H4.7c-1.4,0-2.5,1.1-2.5,2.5v5.9c0,1.4,1.1,2.5,2.5,2.5h6.9c1.4,0,2.5-1.1,2.5-2.5V7.7 C14.1,6.4,13,5.3,11.6,5.3z M4.7,6.3h6.9c0.8,0,1.5,0.7,1.5,1.5v5.9c0,0.8-0.7,1.5-1.5,1.5H4.7c-0.8,0-1.5-0.7-1.5-1.5V7.7 C3.3,6.9,3.9,6.3,4.7,6.3z" /><path d="M16.6,6.7c0.9-0.8,2.3-0.1,2.4,1l0,0.1v5.7c0,1.2-1.3,1.9-2.3,1.2l-0.1-0.1L13.3,12 c-0.2-0.2-0.2-0.5-0.1-0.7c0.2-0.2,0.4-0.2,0.6-0.1l0.1,0.1l3.3,2.7c0.3,0.2,0.7,0.1,0.8-0.3l0-0.1V7.8c0-0.4-0.4-0.6-0.7-0.4 l-0.1,0l-3.3,2.7c-0.2,0.2-0.5,0.1-0.7-0.1c-0.2-0.2-0.1-0.5,0-0.6l0.1-0.1L16.6,6.7z" /></svg>',r.onclick=function(){var e=t.decoderState.state,n=e.play,i=e.recordvideo;n&&(i?(t.jSPlugin.stopSave(),t.setDecoderState({recordvideo:!1})):(t.jSPlugin.startSave("".concat((new Date).getTime())),t.setDecoderState({recordvideo:!0})))},r;case"capturePicture":return r.title="截图",r.id=e,r.domString='<svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M10.8,7.7c-2,0-3.7,1.6-3.7,3.7S8.7,15,10.8,15c2,0,3.7-1.6,3.7-3.7S12.8,7.7,10.8,7.7z M10.8,8.7c1.5,0,2.7,1.2,2.7,2.7S12.2,14,10.8,14c-1.5,0-2.7-1.2-2.7-2.7S9.3,8.7,10.8,8.7z" /><path d="M8.6,3.7l-0.1,0C8,3.7,7.7,4,7.5,4.3l-1,1.7l-1.3,0C4,6.1,3.1,7,3.1,8.2v7.1 c0,1.2,0.9,2.1,2.1,2.1h11.1c1.2,0,2.1-0.9,2.1-2.1V8.2l0-0.1c-0.1-1.1-1-1.9-2.1-1.9l-1.3,0l-1.1-1.8c-0.2-0.4-0.7-0.6-1.1-0.6H8.6 z M8.6,4.7h4.2c0.1,0,0.2,0.1,0.3,0.1l1.2,2c0.1,0.2,0.3,0.2,0.4,0.2h1.6c0.6,0,1.1,0.5,1.1,1.1v7.1c0,0.6-0.5,1.1-1.1,1.1H5.1 c-0.6,0-1.1-0.5-1.1-1.1V8.2c0-0.6,0.5-1.1,1.1-1.1h1.6c0.2,0,0.3-0.1,0.4-0.2l1.2-2C8.4,4.7,8.5,4.7,8.6,4.7z" /></svg>',r.onclick=function(){t.decoderState.state.play?t.jSPlugin.capturePicture("".concat((new Date).getTime())):console.log("视频未播放，无法截图")},r;case"talk":return r.title="对讲",r.id=e,r.domString="<div></div>"+'<svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M10.1,2.7C8.5,2.7,7.2,4,7.2,5.6v5.2c0,1.6,1.3,2.9,2.9,2.9l0.2,0c1.5-0.1,2.7-1.4,2.7-2.9V5.6\tC13,4,11.7,2.7,10.1,2.7z M10.1,3.7c1.1,0,1.9,0.9,1.9,1.9v5.2c0,1-0.8,1.8-1.8,1.9l-0.1,0c-1,0-1.9-0.9-1.9-1.9V5.6 C8.2,4.5,9,3.7,10.1,3.7z" /><path d="M15.1,8.5c0.2,0,0.4,0.2,0.5,0.4l0,0.1v1.7c0,3-2.5,5.5-5.5,5.5c-3,0-5.4-2.3-5.5-5.3l0-0.2V9 c0-0.3,0.2-0.5,0.5-0.5c0.2,0,0.4,0.2,0.5,0.4l0,0.1v1.7c0,2.5,2,4.5,4.5,4.5c2.4,0,4.4-1.9,4.5-4.3l0-0.2V9 C14.6,8.7,14.8,8.5,15.1,8.5z" /><path d="M13.5,17.7c0.3,0,0.5,0.2,0.5,0.5c0,0.2-0.2,0.4-0.4,0.5l-0.1,0h-7c-0.3,0-0.5-0.2-0.5-0.5 c0-0.2,0.2-0.4,0.4-0.5l0.1,0H13.5z" /><path d="M10.1,15.2c0.2,0,0.4,0.2,0.5,0.4l0,0.1v2.5c0,0.3-0.2,0.5-0.5,0.5c-0.2,0-0.4-0.2-0.5-0.4l0-0.1 v-2.5C9.6,15.4,9.8,15.2,10.1,15.2z" /></svg>',r.onclick=function(){var e=t.decoderState.state,n=e.talk,i=e.sound;if(n){console.log("结束对讲"),t.setDecoderState({talk:!1}),t.jSPlugin.Talk.stopTalk();var o=S.findIndex(t.themeData.footer.btnList,(function(e){return"sound"===e.iconId&&1===e.isrender&&1===e.defaultActive}))>-1;t.themeData&&o&&(t.jSPlugin.openSound(),t.setDecoderState({sound:!0}))}else console.log("开始对讲"),t.setDecoderState({talk:!0}),i&&(t.jSPlugin.closeSound(),t.setDecoderState({sound:!1})),t.jSPlugin.Talk.startTalk()},r;case"zoom":return r.title="电子放大",r.id=e,r.domString="<div></div>"+'<svg  fill="'.concat(r.color,'" version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n          width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="5 -6 5 32" style="enable-background:new 0 0 20 20.1;" xml:space="preserve">\n              <path class="st1" d="M8.8,2.6c3.5,0,6.2,2.8,6.2,6.2s-2.8,6.2-6.2,6.2s-6.2-2.8-6.2-6.2S5.3,2.6,8.8,2.6z M8.8,3.9\n                c-2.8,0-5,2.2-5,5s2.2,5,5,5s5-2.2,5-5S11.5,3.9,8.8,3.9z M12.7,12.7l3.9,3.9"/>\n              <path class="st2" d="M11.2,9.5h-5c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6h5c0.3,0,0.6,0.3,0.6,0.6S11.6,9.5,11.2,9.5z"/>\n              <path class="st2" d="M8.7,12c-0.3,0-0.6-0.3-0.6-0.6v-5c0-0.3,0.3-0.6,0.6-0.6s0.6,0.3,0.6,0.6v5C9.3,11.8,9.1,12,8.7,12z"/>\n              <path class="st2" d="M16.9,17.6c-0.1,0-0.3-0.1-0.4-0.2l-3.9-3.9c-0.2-0.2-0.2-0.6,0-0.8s0.6-0.2,0.8,0l3.9,3.9\n                c0.2,0.2,0.2,0.6,0,0.8C17.2,17.5,17,17.6,16.9,17.6z"/>\n          </svg>'),r.onclick=function(){t.decoderState.state.zoom?(console.log("结束电子放大"),t.setDecoderState({zoom:!1}),t.jSPlugin.Zoom.stopZoom()):(console.log("开始电子放大"),t.jSPlugin.Zoom.startZoom(),t.setDecoderState({zoom:!0}))},r;case"pantile":return r.title="云台控制",r.id=e,r.domString='<svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M10.2,7.8c1.6,0,2.9,1.3,2.9,2.9s-1.3,2.9-2.9,2.9s-2.9-1.3-2.9-2.9S8.5,7.8,10.2,7.8z M10.2,8.8c-1.1,0-1.9,0.9-1.9,1.9s0.9,1.9,1.9,1.9s1.9-0.9,1.9-1.9S11.2,8.8,10.2,8.8z" /><path d="M8.8,3.5c0.7-0.6,1.8-0.6,2.5-0.1l0.1,0.1l1.4,1.1c0.2,0.2,0.3,0.5,0.1,0.7 c-0.2,0.2-0.4,0.2-0.6,0.1l-0.1,0l-1.4-1.1C10.5,3.9,10,3.9,9.6,4.2L9.4,4.3L8,5.4C7.8,5.5,7.5,5.5,7.3,5.3c-0.2-0.2-0.1-0.5,0-0.6 l0.1-0.1L8.8,3.5z" /><path d="M2.5,12.3c-0.6-0.7-0.6-1.8-0.1-2.5l0.1-0.1l1.1-1.4c0.2-0.2,0.5-0.3,0.7-0.1 c0.2,0.2,0.2,0.4,0.1,0.6l0,0.1l-1.1,1.4C3,10.6,3,11.1,3.2,11.5l0.1,0.1L4.4,13c0.2,0.2,0.1,0.5-0.1,0.7c-0.2,0.2-0.5,0.1-0.6,0 l-0.1-0.1L2.5,12.3z" /><path d="M17.7,12.3c0.6-0.7,0.6-1.8,0.1-2.5l-0.1-0.1l-1.1-1.4c-0.2-0.2-0.5-0.3-0.7-0.1 c-0.2,0.2-0.2,0.4-0.1,0.6l0,0.1l1.1,1.4c0.3,0.4,0.3,0.9,0.1,1.3l-0.1,0.1L15.8,13c-0.2,0.2-0.1,0.5,0.1,0.7c0.2,0.2,0.5,0.1,0.6,0 l0.1-0.1L17.7,12.3z" /><path d="M8.8,18.2c0.7,0.6,1.8,0.6,2.5,0.1l0.1-0.1l1.4-1.1c0.2-0.2,0.3-0.5,0.1-0.7 c-0.2-0.2-0.4-0.2-0.6-0.1l-0.1,0l-1.4,1.1c-0.4,0.3-0.9,0.3-1.3,0.1l-0.1-0.1L8,16.3c-0.2-0.2-0.5-0.1-0.7,0.1 c-0.2,0.2-0.1,0.5,0,0.6l0.1,0.1L8.8,18.2z" /></svg>',r.onclick=function(){var e=t.decoderState.state,n=e.pantile,i=e.expend;if(n)console.log("隐藏云台"),t.Ptz.hide(),t.setDecoderState({pantile:!1});else{if(console.log("显示云台"),t.isMobile&&!i)return console.log("移动端，非全屏状态不展示云台"),!1;t.Ptz.show(),t.setDecoderState({pantile:!0})}},r;case"expend":return r.title="全局全屏",r.id=e,r.domString='<span><svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M3.4,7.6c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-1.2,1-2.3,2.2-2.3h1.8c0.3,0,0.5,0.2,0.5,0.5S7.2,4.1,6.9,4.1H5.2 c-0.7,0-1.2,0.6-1.2,1.3v1.8C3.9,7.4,3.7,7.6,3.4,7.6z" /><path d="M6.9,18.1H5.2c-1.2,0-2.2-1-2.2-2.2v-1.8c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v1.8c0,0.7,0.6,1.2,1.2,1.2 h1.8c0.3,0,0.5,0.2,0.5,0.5S7.2,18.1,6.9,18.1z" /><path d="M15.7,18.1h-1.8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h1.8c0.7,0,1.2-0.6,1.2-1.2v-1.8 c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v1.8C17.9,17.1,16.9,18.1,15.7,18.1z" /><path d="M17.4,7.6c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-0.7-0.6-1.3-1.2-1.3h-1.8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h1.8 c1.2,0,2.2,1,2.2,2.3v1.8C17.9,7.4,17.7,7.6,17.4,7.6z" /></svg>'+'<svg style="display:none" width="'.concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" fill="').concat(r.color,'" viewBox="-6 -6 32 32">\n            <path class="st1" d="M5.7,8.1H3.9c-0.3,0-0.6-0.2-0.6-0.6S3.6,7,3.9,7h1.9c0.7,0,1.3-0.6,1.3-1.3V3.8c0-0.3,0.2-0.6,0.6-0.6\n              s0.6,0.2,0.6,0.6v1.9C8.2,7,7.1,8.1,5.7,8.1z"/>\n            <path class="st1" d="M7.6,17.7c-0.3,0-0.6-0.2-0.6-0.6v-1.9c0-0.7-0.6-1.3-1.3-1.3H3.9c-0.3,0-0.6-0.2-0.6-0.6s0.2-0.6,0.6-0.6h1.9\n              c1.3,0,2.4,1.1,2.4,2.4v1.9C8.2,17.5,7.9,17.7,7.6,17.7z"/>\n            <path class="st1" d="M13.4,17.7c-0.3,0-0.6-0.2-0.6-0.6v-1.9c0-1.3,1.1-2.4,2.4-2.4h1.9c0.3,0,0.6,0.2,0.6,0.6S17.5,14,17.2,14\n              h-1.9c-0.7,0-1.3,0.6-1.3,1.3v1.9C14,17.5,13.8,17.7,13.4,17.7z"/>\n            <path class="st1" d="M17.2,8.1h-1.9c-1.3,0-2.4-1.1-2.4-2.4V3.8c0-0.3,0.2-0.6,0.6-0.6S14,3.5,14,3.8v1.9C14,6.4,14.6,7,15.3,7h1.9\n              c0.3,0,0.6,0.2,0.6,0.6S17.5,8.1,17.2,8.1z"/>\n          </svg>\n          </span>'),r.onclick=function(){var e,n,i,o,r=t.decoderState.state,a=r.webExpend,d=r.expend,s=r.play,c=r.pantile;if(!s)return!1;if(a)return console.log("正在网站全屏"),!1;if(d)if(t.isMobile){l=parseInt(getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-wrap"))).height,10)-parseInt(getComputedStyle(document.getElementById(t.jSPlugin.id)).height,10);document.getElementById("".concat(t.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(t.jSPlugin.id,"-ez-iframe-footer-container")).style.marginTop="-32px"),document.getElementById("".concat(t.jSPlugin.id,"-headControl"))&&(document.getElementById("".concat(t.jSPlugin.id,"-headControl")).style.position="relative"),e=document.getElementById("".concat(t.jSPlugin.id,"-wrap")),n=t.jSPlugin.width,i=t.jSPlugin.height+l,o="",o+="width:"+n+"px;",o+="height:"+i+"px;",o+="-webkit-transform: none; transform: none;",o+="-webkit-transform-origin: 0 0;",o+="transform-origin: 0 0;",e.style.cssText=o,t.jSPlugin.jSPlugin.JS_Resize(t.jSPlugin.width,t.jSPlugin.height),c&&(t.Ptz.hide(),t.setDecoderState({pantile:!1}))}else{console.log("取消全局全屏"),h().then((function(e){console.log("取消全屏",e,t.jSPlugin),t.jSPlugin.jSPlugin.JS_Resize(t.jSPlugin.width,t.jSPlugin.height)}))}else if(console.log("执行全局全屏"),t.isMobile){var l=parseInt(getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-wrap"))).height,10)-parseInt(getComputedStyle(document.getElementById(t.jSPlugin.id)).height,10);p(document.getElementById("".concat(t.jSPlugin.id,"-wrap"))),setTimeout((function(){var e=document.documentElement.clientWidth,n=document.documentElement.clientHeight;document.getElementById("".concat(t.jSPlugin.id)).style["backface-visibility"]="hidden",t.jSPlugin.jSPlugin.JS_Resize(n,e-l)}),100)}else{m(document.getElementById("".concat(t.jSPlugin.id))).then((function(e){t.jSPlugin.jSPlugin.JS_Resize(window.screen.availWidth,window.screen.availHeight)})).catch((function(e){console.log(e)}))}t.setDecoderState({expend:!d})},r;case"webExpend":return r.title="网页全屏",r.id=e,r.domString='<span><svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M3.1,7.6c-0.3,0-0.5-0.2-0.5-0.5V5.3c0-1.2,1-2.3,2.2-2.3h1.8c0.3,0,0.5,0.2,0.5,0.5S6.8,4.1,6.6,4.1H4.8 c-0.7,0-1.2,0.6-1.2,1.3v1.8C3.6,7.4,3.3,7.6,3.1,7.6z" /><path d="M15.3,18.1h-1.8c-0.3,0-0.5-0.2-0.5-0.5s0.2-0.5,0.5-0.5h1.8c0.7,0,1.2-0.6,1.2-1.2v-1.8 c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v1.8C17.6,17.1,16.6,18.1,15.3,18.1z" /><circle class="st2" cx="10.2" cy="10.4" r="1.1"/></svg>'+'<svg fill="'.concat(r.color,'" style="display:none;" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">\n          <path class="st1" d="M5.4,8.1H3.5C3.2,8.1,3,7.9,3,7.6s0.2-0.5,0.5-0.5h1.9c0.8,0,1.4-0.6,1.4-1.4V3.8c0-0.3,0.2-0.5,0.5-0.5\n            s0.5,0.2,0.5,0.5v1.9C7.7,7,6.7,8.1,5.4,8.1z"/>\n          <path class="st1" d="M13.1,17.7c-0.3,0-0.5-0.2-0.5-0.5v-1.9c0-1.3,1.1-2.4,2.4-2.4h1.9c0.3,0,0.5,0.2,0.5,0.5s-0.2,0.5-0.5,0.5H15\n            c-0.8,0-1.4,0.6-1.4,1.4v1.9C13.6,17.4,13.4,17.7,13.1,17.7z"/>\n            <circle class="st2" cx="10.2" cy="10.4" r="1.1"/>\n          ')+"</svg></span>",r.onclick=function(){var e=t.decoderState.state,n=e.webExpend,i=e.expend;if(!e.play)return!1;if(i)return console.log("正在全局全屏"),!1;if(n){console.log("取消网页全屏"),h().then((function(e){t.jSPlugin.jSPlugin.JS_Resize(t.jSPlugin.width,t.jSPlugin.height)}))}else{console.log("执行网页全屏");var o=0,r=0;m(document.getElementById("".concat(t.jSPlugin.id,"-wrap"))).then((function(e){console.log("全屏promise",window.screen.availWidth),document.getElementById("".concat(t.jSPlugin.id,"-canvas-container"))&&(o=parseInt(window.getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-canvas-container"))).height,10)),document.getElementById("".concat(t.jSPlugin.id,"-headControl"))&&(r=parseInt(window.getComputedStyle(document.getElementById("".concat(t.jSPlugin.id,"-headControl"))).height,10)),console.log("this.jSPlugin.JS_Resiz",o,r,document.body.clientWidth),t.jSPlugin.jSPlugin.JS_Resize(window.screen.availWidth,window.screen.availHeight-o-r)})).catch((function(e){console.log(e)}))}t.setDecoderState({webExpend:!n})},r;case"hd":return r.title="画面清晰度",r.id=e,r.domString='<ul id="'.concat(this.jSPlugin.id,'-hdSelect" class="hd speed-select ').concat(this.isMobile?"mobile":"",'" style="display:none;">')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;" name="option" id="'.concat(this.jSPlugin.id,'-select-hd">高清</li>')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;"  name="option" id="'.concat(this.jSPlugin.id,'-select-sd">标清</li>')+'<li class="selectOption cancel" style="'.concat(this.isMobile?"":"display:none;",'" name="option" id="').concat(this.jSPlugin.id,'-select-speed">取消</li>')+"</ul>"+'<span><svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -6 32 32">')+'<path d="M17.4,16.5H3.1c-0.8,0-1.4-0.6-1.4-1.4V5.4c0-0.9,0.7-1.6,1.6-1.6h14.1c0.8,0,1.4,0.6,1.4,1.4v9.8 C18.8,15.9,18.2,16.5,17.4,16.5z M3.3,5C3.1,5,2.9,5.2,2.9,5.4v9.7c0,0.2,0.1,0.3,0.3,0.3h14.3c0.2,0,0.3-0.1,0.3-0.3V5.3 c0-0.2-0.1-0.3-0.3-0.3H3.3z" /><path d="M13.3,13.6h-1.6c-0.4,0-0.7-0.3-0.7-0.7V7.4c0-0.4,0.3-0.7,0.7-0.7h1.6c1.2,0,2.2,1,2.2,2.2v2.4 C15.6,12.6,14.6,13.6,13.3,13.6z M12.2,12.5h1.1c0.6,0,1.1-0.5,1.1-1.1V9c0-0.6-0.5-1.1-1.1-1.1h-1.1V12.5z" /><path d="M5.5,13.6c-0.3,0-0.6-0.2-0.6-0.6V7.3C5,7,5.2,6.8,5.5,6.8S6.1,7,6.1,7.3v5.7C6.1,13.4,5.8,13.6,5.5,13.6z" /><path d="M9.2,13.6c-0.3,0-0.6-0.2-0.6-0.6V7.3c0-0.3,0.2-0.6,0.6-0.6S9.8,7,9.8,7.3v5.7C9.8,13.4,9.5,13.6,9.2,13.6z" /><rect x="5.6" y="9.6" width="3.6" height="1.1" /></svg>'+'<svg style="display:none" fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg" width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-6 -8 40 44">\n                <path d="M24.1,23.8h-20c-1.1,0-1.9-0.9-1.9-1.9V8.4c0-1.2,1-2.2,2.1-2.2h19.7c1.1,0,1.9,0.9,1.9,1.9v13.8\n                    C26,23,25.1,23.8,24.1,23.8z M4.3,7.7C4,7.7,3.7,8,3.7,8.4v13.5c0,0.2,0.2,0.4,0.4,0.4h20c0.2,0,0.4-0.2,0.4-0.4V8.2\n                    c0-0.2-0.2-0.4-0.4-0.4H4.3z"/>\n                <path d="M18.4,19.8h-2.2c-0.5,0-0.9-0.4-0.9-0.9v-7.8c0-0.5,0.4-0.9,0.9-0.9h2.2c1.7,0,3.1,1.4,3.1,3.1v3.3\n                C21.5,18.4,20.1,19.8,18.4,19.8z M16.7,18.3h1.6c0.9,0,1.6-0.7,1.6-1.6v-3.3c0-0.9-0.7-1.6-1.6-1.6h-1.6V18.3z"/>\n                <path d="M10.5,19.8c1.2,0,2.1-0.3,2.7-0.9c0.6-0.6,0.9-1.3,0.9-2.1c0-0.8-0.3-1.4-0.9-1.8c-0.4-0.2-1.1-0.5-2.2-0.8\n                    l0,0l-1-0.2c-0.4-0.1-0.8-0.2-1-0.4c-0.4-0.2-0.6-0.5-0.6-0.9c0-0.4,0.1-0.6,0.4-0.9s0.7-0.3,1.3-0.3c0.8,0,1.4,0.2,1.8,0.6\n                    c0.2,0.3,0.3,0.6,0.4,0.9l0,0h1.4c0-0.6-0.2-1.1-0.5-1.6c-0.6-0.8-1.6-1.2-2.9-1.2c-1,0-1.8,0.3-2.4,0.8c-0.6,0.5-0.9,1.2-0.9,2\n                    c0,0.7,0.3,1.3,1,1.7c0.4,0.2,0.9,0.4,1.7,0.6l0,0l1.2,0.3c0.6,0.2,1.1,0.3,1.3,0.4c0.3,0.2,0.5,0.5,0.5,0.9c0,0.5-0.2,0.9-0.6,1.1\n                    s-0.9,0.4-1.5,0.4c-0.9,0-1.6-0.2-2-0.7c-0.2-0.3-0.3-0.6-0.4-1.1l0,0H6.8c0,0.9,0.3,1.6,0.9,2.2C8.2,19.5,9.2,19.8,10.5,19.8z"/>\n                <defs>\n                  <filter id="Adobe_OpacityMaskFilter" filterUnits="userSpaceOnUse" x="15.2" y="10.3" width="6.2" height="9.5">\n                    <feColorMatrix  type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"/>\n                  </filter>\n                </defs>\n                <mask maskUnits="userSpaceOnUse" x="15.2" y="10.3" width="6.2" height="9.5" id="mask-2_2_">\n                  <g class="st2">\n                    <path id="path-1_2_" class="st3" d="M24.1,23.1h-20c-0.6,0-1.2-0.5-1.2-1.2V8.2C2.9,7.5,3.5,7,4.1,7h19.7c0.8,0,1.4,0.6,1.4,1.4\n                      v13.5C25.2,22.6,24.7,23.1,24.1,23.1z"/>\n                  </g>\n                </mask>\n                <defs>\n                  <filter id="Adobe_OpacityMaskFilter_1_" filterUnits="userSpaceOnUse" x="6.8" y="10.3" width="7.3" height="9.5">\n                    <feColorMatrix  type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"/>\n                  </filter>\n                </defs>\n                <mask maskUnits="userSpaceOnUse" x="6.8" y="10.3" width="7.3" height="9.5" id="mask-2_3_">\n                  <g class="st5">\n                    <path id="path-1_3_" class="st3" d="M24.1,23.1h-20c-0.6,0-1.2-0.5-1.2-1.2V8.2C2.9,7.5,3.5,7,4.1,7h19.7c0.8,0,1.4,0.6,1.4,1.4\n                      v13.5C25.2,22.6,24.7,23.1,24.1,23.1z"/>\n                  </g>\n                </mask>\n                </svg>\n                ')+'<span class=\'speed-select-mask\' style="display:none" id="'.concat(this.jSPlugin.id,'-select-hd-mask"></span>')+"</span>",r.onclick=function(e){var n=t.decoderState.state,i=n.hd,o=n.expend;i&&e.target.id==="".concat(t.jSPlugin.id,"-select-sd")?(console.log("切换到标清"),t.jSPlugin.changeVideoLevel(0),t.setDecoderState({hd:!1})):i||e.target.id!=="".concat(t.jSPlugin.id,"-select-hd")||(t.jSPlugin.changeVideoLevel(1),t.setDecoderState({hd:!0})),t.showHD=!t.showHD,document.getElementById("".concat(t.jSPlugin.id,"-hdSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).style.display="none"===document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).style.display?"block":"none",t.isMobile&&(document.getElementById("".concat(t.jSPlugin.id,"-select-hd-mask")).style.display="none"===document.getElementById("".concat(t.jSPlugin.id,"-select-hd-mask")).style.display?"block":"none")),t.isMobile&&o&&t.showHD?document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).className="hd speed-select mobile expend":document.getElementById("".concat(t.jSPlugin.id,"-hdSelect")).className=t.isMobile?"hd speed-select mobile":"speed-select"},r;case"speed":r.title="回放倍速",r.id=e,r.domString='<ul id="'.concat(this.jSPlugin.id,'-speedSelect" class="speed speed-select ').concat(this.isMobile?"mobile":"",'" style="display:none;">')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed4">4倍</li>')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed2">2倍</li>')+'<li class="selectOption active" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed1">1倍（正常播放）</li>')+'<li class="selectOption default" style="height: 45px;text-align: center;line-height: 45px;list-style: none;cursor: pointer;font-size: 13px;" name="option" id="'.concat(this.jSPlugin.id,'-select-speed05">0.5倍</li>')+'<li class="selectOption cancel" style="'.concat(this.isMobile?"":"display:none;",'" name="option" id="').concat(this.jSPlugin.id,'-select-speed">取消</li>')+"</ul>"+'<span>\n          <div style="font-size: 12px;\n          vertical-align: bottom;\n          display: inline-flex;\n          padding: 0px 7px;\n          width: 48px;\n          line-height: 24px;\n          justify-content: center;\n          border: 1px solid '.concat(r.color,';\n          text-align: center;border-radius: 12.5px;"\n          id="').concat(this.jSPlugin.id,'-speed-text"\n          >').concat(1===this.nextRate?"倍速":"".concat(this.nextRate,"倍").replace("3","0.5"),"</div>\n                ")+'<span class=\'speed-select-mask\' style="display:none" id="'.concat(this.jSPlugin.id,'-select-mask"></span>')+"</span>";var a=function(e){console.log("setLiActive",e),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[0].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[0].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[1].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[1].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[2].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[2].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[3].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[3].className.replace("active","default"),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[e].className=document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).childNodes[e].className.replace("default","active")};return this.isMobile||(r.onmouseenter=function(e){console.log("鼠标移入",e),t.setDecoderState({speed:!0}),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="block")},r.onmouseleave=function(e){console.log("鼠标移出",e),t.setDecoderState({speed:!1}),document.getElementById("".concat(t.jSPlugin.id,"-speedSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="none")}),r.onclick=function(e){var n=t.decoderState.state,i=n.speed,o=n.expend;if(!i&&t.isMobile&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).className=o?"speed speed-select mobile expend":"speed speed-select mobile"),t.nextRate=1,e.target.id)switch(e.target.id){case"".concat(t.jSPlugin.id,"-select-speed1"):console.log("倍速1"),t.nextRate=1,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),document.getElementById("".concat(t.jSPlugin.id,"-speed-text"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speed-text")).innerHTML="倍速",a(2)),t.setDecoderState({speed:!i});break;case"".concat(t.jSPlugin.id,"-select-speed2"):console.log("倍速2"),t.nextRate=2,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),document.getElementById("".concat(t.jSPlugin.id,"-speed-text"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speed-text")).innerHTML="2倍",a(1)),t.setDecoderState({speed:!i});break;case"".concat(t.jSPlugin.id,"-select-speed4"):console.log("倍速4"),t.nextRate=4,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),document.getElementById("".concat(t.jSPlugin.id,"-speed-text"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speed-text")).innerHTML="4倍",a(0)),t.setDecoderState({speed:!i});break;case"".concat(t.jSPlugin.id,"-select-speed05"):console.log("倍速05"),t.nextRate=3,t.jSPlugin.jSPlugin.JS_Speed(t.nextRate),document.getElementById("".concat(t.jSPlugin.id,"-speed-text"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speed-text")).innerHTML="0.5倍",a(3)),t.setDecoderState({speed:!i});break;default:t.isMobile?t.setDecoderState({speed:!i}):t.setDecoderState({speed:!0})}t.isMobile||e.target.id!=="".concat(t.jSPlugin.id,"-speed-text")?document.getElementById("".concat(t.jSPlugin.id,"-speedSelect"))&&(document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="none"===document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display?"block":"none"):document.getElementById("".concat(t.jSPlugin.id,"-speedSelect")).style.display="block"},r;case"deviceName":return r.title="设备名称",r.id=e,r.domString="<span>设备名称</span>",r.onclick=function(){},r;case"deviceID":return r.title="设备序列号",r.id=e,r.domString="<span>设备序列号</span>",r.onclick=function(){},r;case"cloudRec":return r.title="云存储回放",r.id=e,r.domString='\n        <span>\n          <svg fill="'.concat(r.color,'" version="1.1" xmlns="http://www.w3.org/2000/svg"  width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="-10 0 40 15">\n\t<path d="M9.5,13.1c-0.3,0-0.5-0.2-0.5-0.5V8.8c0-0.3,0.2-0.5,0.5-0.5S10,8.5,10,8.8v3.8C10,12.8,9.8,13.1,9.5,13.1z"/>\n\t<path d="M7.6,10.6c-0.1,0-0.3-0.1-0.4-0.2C7,10.2,7,9.9,7.3,9.7l1.9-1.7c0.2-0.2,0.5-0.2,0.7,0l1.8,1.7\n\t\tc0.2,0.2,0.2,0.5,0,0.7c-0.2,0.2-0.5,0.2-0.7,0L9.5,9.1l-1.6,1.4C7.8,10.6,7.7,10.6,7.6,10.6z"/>\n\t<path d="M13.2,15.7H5.6c-2.1-0.1-3.8-1.8-3.8-3.9c0-1.8,1.3-3.4,3-3.8c0.4-2.2,2.3-3.9,4.6-3.9c2.3,0,4.2,1.7,4.6,3.8\n\t\tc1.8,0.4,3.1,1.9,3.1,3.8C17.1,13.9,15.4,15.7,13.2,15.7z M5.6,14.7h7.6c1.6,0,2.9-1.3,2.9-2.9c0-1.5-1.1-2.7-2.6-2.9l-0.4,0l0-0.4\n\t\tc-0.2-1.9-1.7-3.3-3.6-3.3C7.5,5.1,6,6.6,5.8,8.5l0,0.4l-0.4,0c-1.4,0.2-2.5,1.4-2.5,2.9C2.8,13.3,4.1,14.6,5.6,14.7z"/>\n          </svg>\n        </span>\n        '),r.onclick=function(){console.log("点击云回放"),t.setDecoderState({type:"cloud.rec",cloudRec:!0,rec:!1}),t.jSPlugin.changePlayUrl({type:"cloud.rec"}),console.log(t.jSPlugin);var e=l("begin",t.jSPlugin.url)||(new Date).Format("yyyyMMdd");t.Rec.renderRec("".concat(e.slice(0,4),"-").concat(e.slice(4,6),"-").concat(e.slice(6,8)))},r;case"rec":return r.title="本地存储",r.id=e,r.domString="\n        <span>\n        <svg fill=".concat(r.color,' version="1.1" xmlns="http://www.w3.org/2000/svg"  width="').concat(this.jSPlugin.width>500?48:32,'" height="').concat(this.jSPlugin.width>500?48:32,'" viewBox="0 0 40 15">\n          <path d="M13,16.3H5.5c-1.1,0-2-0.9-2-2V3.8c0-1.1,0.9-2,2-2h5.4c0.5,0,1,0.2,1.4,0.6l2.1,2.1C14.8,4.8,15,5.3,15,5.9\n  v8.4C15,15.4,14.1,16.3,13,16.3z M5.5,2.8c-0.6,0-1,0.4-1,1v10.5c0,0.6,0.4,1,1,1H13c0.6,0,1-0.4,1-1V5.9c0-0.3-0.1-0.5-0.3-0.7\n  L11.6,3c-0.2-0.2-0.4-0.3-0.7-0.3H5.5z"/>\n<path d="M6.3,7.3C6,7.3,5.8,7,5.8,6.8V4.5C5.8,4.2,6,4,6.3,4s0.5,0.2,0.5,0.5v2.2C6.8,7,6.6,7.3,6.3,7.3z"/>\n<path d="M8.5,7.3C8.3,7.3,8,7,8,6.8V4.5C8,4.2,8.3,4,8.5,4S9,4.2,9,4.5v2.2C9,7,8.8,7.3,8.5,7.3z"/>\n<path d="M10.8,7.3c-0.3,0-0.5-0.2-0.5-0.5V4.5c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v2.2C11.3,7,11.1,7.3,10.8,7.3z"\n  />\n        </svg>\n      </span>\n        '),r.onclick=function(){console.log("点击本地回放"),t.setDecoderState({type:"rec",cloudRec:!1,rec:!0}),t.jSPlugin.changePlayUrl({type:"rec"}),console.log(t.jSPlugin);var e=l("begin",t.jSPlugin.url)||(new Date).Format("yyyyMMdd");t.Rec.renderRec("".concat(e.slice(0,4),"-").concat(e.slice(4,6),"-").concat(e.slice(6,8)))},r;default:return r}}},{key:"initThemeData",value:function(){var e=this,t=this.themeData,n=t.header,i=t.footer,o=this.jSPlugin.id;if(this.header=k,this.footer=E,this.isNeedRenderHeader=S.findIndex(n.btnList,(function(e){return e.isrender>0}))>=0,this.isMobile&&(this.isNeedRenderHeader=S.findIndex(n.btnList,(function(e){return e.isrender>0&&"deviceID"===e.iconId||e.isrender>0&&"deviceName"===e.iconId}))>=0),this.isNeedRenderFooter=S.findIndex(i.btnList,(function(e){return e.isrender>0}))>=0,this.isNeedRenderTimeLine=S.findIndex(n.btnList,(function(e){return"cloudRec"===e.iconId&&1===e.isrender||"rec"===e.iconId&&1===e.isrender}))>=0&&!this.jSPlugin.disabledTimeLine,["date-switch-container-wrap","rec-type-container-wrap","mobile-rec-wrap","mobile-ez-ptz-container"].forEach((function(e,t){document.getElementById(e)&&document.getElementById(e).parentElement.removeChild(document.getElementById(e))})),this.isNeedRenderHeader)if(document.getElementById("".concat(this.jSPlugin.id,"-headControl")))document.getElementById("".concat(this.jSPlugin.id,"-headControl")).innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' style='display:flex'></div><div id='").concat(this.jSPlugin.id,"-headControl-right' style='display:flex'></div>");else{var r=document.createElement("div");r.setAttribute("id","".concat(this.jSPlugin.id,"-headControl")),r.setAttribute("class","header-controls"),r.innerHTML="<div id='".concat(this.jSPlugin.id,"-headControl-left' class=\"header-controls-left\" style='display:flex'></div><div id='").concat(this.jSPlugin.id,"-headControl-right' class=\"header-controls-right\" style='display:flex'></div>");var a={height:this.jSPlugin.width>500?"48px":"32px","line-height":this.jSPlugin.width>500?"48px":"32px",display:"flex","justify-content":"space-between",top:0,"z-index":1,background:"#000000",color:"#FFFFFF",width:"100%"};r.style=te(a),document.getElementById("".concat(o,"-wrap")).insertBefore(r,document.getElementById(o));var d=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&clearInterval(d)}),50)}else document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&document.getElementById("".concat(this.jSPlugin.id,"-headControl")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-headControl")));if(this.isNeedRenderFooter)if(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")))document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).innerHTML='<div id="'.concat(this.jSPlugin.id,'-audioControls"  class="footer-controls" style=\'display:flex;justify-content: space-between;height: ').concat(this.jSPlugin.width>500?48:32,"px;width:100%;'><div id='").concat(this.jSPlugin.id,"-audioControls-left' class=\"footer-controls-left\" style='display:flex'></div><div id='").concat(this.jSPlugin.id,"-audioControls-right' class=\"footer-controls-right\" style='display:flex'></div></div>"));else{var s=document.createElement("div");s.setAttribute("id","".concat(this.jSPlugin.id,"-ez-iframe-footer-container")),s.setAttribute("class","ez-iframe-footer-container");var c={"min-height":this.jSPlugin.width>500?"48px":"32px","max-height":this.jSPlugin.width>500?"96px":"80px",position:"relative","margin-top":this.jSPlugin.width>500?"-48px":"-32px",display:"flex","flex-wrap":"wrap","justify-content":"space-between","z-index":999,top:0,color:"#FFFFFF",width:"100%"};s.style=te(c),s.innerHTML='<div id="'.concat(this.jSPlugin.id,'-audioControls" class="footer-controls" style=\'display:flex;height:').concat(this.jSPlugin.width>500?48:32,"px;justify-content: space-between;width:100%;z-index:999;position: relative;'><div id='").concat(this.jSPlugin.id,"-audioControls-left' class=\"footer-controls-left\" style='display:flex;margin-lefacti'></div><div id='").concat(this.jSPlugin.id,"-audioControls-right' class=\"footer-controls-right\" style='display:flex'></div></div>"),u(s,document.getElementById(o))}else document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container"))&&document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")).parentElement.removeChild(document.getElementById("".concat(this.jSPlugin.id,"-ez-iframe-footer-container")));if(this.isNeedRenderHeader&&document.getElementById("".concat(this.jSPlugin.id,"-headControl"))&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.background=n.backgroundColor,document.getElementById("".concat(this.jSPlugin.id,"-headControl")).style.color=n.color,n.btnList.map((function(t,n){t.isrender&&e.renderHeader(t.iconId,t.part)}))),this.isNeedRenderFooter&&document.getElementById("".concat(this.jSPlugin.id,"-audioControls"))&&(document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.background=i.backgroundColor,document.getElementById("".concat(this.jSPlugin.id,"-audioControls")).style.color=i.color,i.btnList.map((function(t,n){t.isrender&&e.renderFooter(t.iconId,t.part)}))),this.isNeedRenderTimeLine)if(this.isMobile)document.getElementById("".concat(this.jSPlugin.id,"-headControl-right"))&&(document.getElementById("".concat(this.jSPlugin.id,"-headControl-right")).style.display="none"),this.Rec=new M(this.jSPlugin);else{this.Rec=new x(this.jSPlugin);var l=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&clearInterval(l)}),50)}S.findIndex(this.themeData.footer.btnList,(function(e){return"pantile"===e.iconId&&1===e.isrender}))>=0&&!this.jSPlugin.disabledPTZ&&(this.isMobile&&(this.MobilePtz=new U(this.jSPlugin)),this.Ptz=new D(this.jSPlugin));if(["fullscreenchange","webkitfullscreenchange","mozfullscreenchange"].forEach((function(t){window.addEventListener(t,(function(t){return n=e.decoderState.state,i=n.expend,o=n.webExpend,void(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||(e.jSPlugin.reSize(e.jSPlugin.params.width,e.jSPlugin.params.height),i&&e.setDecoderState({expend:!1}),o&&e.setDecoderState({webExpend:!1})));var n,i,o}))})),this.themeData.poster){this.jSPlugin.poster=this.themeData.poster;var p=setInterval((function(){window.EZUIKit[e.jSPlugin.id].state.EZUIKitPlayer.init&&(clearInterval(p),e.jSPlugin.setPoster(e.themeData.poster))}),50)}this.inited=!0,this.getDeviceInfo()}},{key:"getDeviceInfo",value:function(){var e=this;v(this.jSPlugin.env.domain+"/api/lapp/device/info","POST",{accessToken:this.jSPlugin.accessToken,deviceSerial:f(this.jSPlugin.url).deviceSerial},0,(function(t){200==t.code&&t.data&&(document.getElementById("".concat(e.jSPlugin.id,"-deviceName-content"))&&(document.getElementById("".concat(e.jSPlugin.id,"-deviceName-content")).style.maxWidth="160px",document.getElementById("".concat(e.jSPlugin.id,"-deviceName-content")).style.overflow="hidden",document.getElementById("".concat(e.jSPlugin.id,"-deviceName-content")).style.textOverflow="ellipsis",document.getElementById("".concat(e.jSPlugin.id,"-deviceName-content")).innerHTML=t.data.deviceName),document.getElementById("".concat(e.jSPlugin.id,"-deviceID-content"))&&(document.getElementById("".concat(e.jSPlugin.id,"-deviceID-content")).style.maxWidth="160px",document.getElementById("".concat(e.jSPlugin.id,"-deviceID-content")).style.overflow="hidden",document.getElementById("".concat(e.jSPlugin.id,"-deviceID-content")).style.textOverflow="ellipsis",document.getElementById("".concat(e.jSPlugin.id,"-deviceID-content")).innerHTML=f(e.jSPlugin.url).deviceSerial))}))}},{key:"editStart",value:function(e){var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),n=document.getElementById("".concat(this.jSPlugin.id,"-headControl"));n&&n.setAttribute("class","header-controls themeEditing"),t&&t.setAttribute("class","footer-controls themeEditing"),this.setDecoderState({isEditing:!0})}},{key:"editEnd",value:function(e){var t=document.getElementById("".concat(this.jSPlugin.id,"-audioControls")),n=document.getElementById("".concat(this.jSPlugin.id,"-headControl"));n&&n.setAttribute("class","header-controls"),t&&t.setAttribute("class","footer-controls"),this.setDecoderState({isEditing:!1})}},{key:"webExpend",value:function(){var e=this,t=this.decoderState.state;t.webExpend;var n=t.expend;if(!t.play)return!1;if(n)return console.log("正在全局全屏"),!1;console.log("执行网页全屏");var i=0,o=0;m(document.getElementById("".concat(this.jSPlugin.id,"-wrap"))).then((function(t){console.log("全屏promise",window.screen.availWidth),document.getElementById("".concat(e.jSPlugin.id,"-canvas-container"))&&(i=parseInt(window.getComputedStyle(document.getElementById("".concat(e.jSPlugin.id,"-canvas-container"))).height,10)),document.getElementById("".concat(e.jSPlugin.id,"-headControl"))&&(o=parseInt(window.getComputedStyle(document.getElementById("".concat(e.jSPlugin.id,"-headControl"))).height,10)),console.log("this.jSPlugin.JS_Resiz",i,o,document.body.clientWidth),e.jSPlugin.jSPlugin.JS_Resize(window.screen.availWidth,window.screen.availHeight-i-o)})).catch((function(e){console.log(e)}))}},{key:"expend",value:function(){var e=this,t=this.decoderState.state,n=t.webExpend;t.expend;var i=t.play;if(t.pantile,!i)return!1;if(n)return console.log("正在网站全屏"),!1;if(console.log("执行全局全屏"),this.isMobile){var o=parseInt(getComputedStyle(document.getElementById("".concat(this.jSPlugin.id,"-wrap"))).height,10)-parseInt(getComputedStyle(document.getElementById(this.jSPlugin.id)).height,10);p(document.getElementById("".concat(this.jSPlugin.id,"-wrap"))),setTimeout((function(){var t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;document.getElementById("".concat(e.jSPlugin.id)).style["backface-visibility"]="hidden",e.jSPlugin.jSPlugin.JS_Resize(n,t-o)}),100)}else{m(document.getElementById("".concat(this.jSPlugin.id))).then((function(t){e.jSPlugin.jSPlugin.JS_Resize(window.screen.availWidth,window.screen.availHeight)})).catch((function(e){console.log(e)}))}}}]),e}();Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var ie=function(){function e(t,i){if(n(this,e),this.params=t,this.state={},this.jsPlugin=i,this.url="https://log.ys7.com/statistics.do?",t.env)switch(t.env){case"test12":this.url="https://test12dclog.ys7.com/statistics.do?";break;case"online":break;default:this.url=t.env}}return o(e,[{key:"uuid",value:function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var n=e.join("");return n}},{key:"dclog",value:function(e){var t=this.url,n=Object.assign({},{systemName:"open_website_monitor"},{bn:"ezuikit-js"},e,{un:e.url},{st:(new Date).getTime(),h:window.location.pathname});Object.keys(n).forEach((function(e,i){var o=n[e];"string"==typeof n[e]&&(o=n[e].replace("%","%25")),void 0!==n[e]&&(t+="".concat(0===i?"":"&").concat(e,"=").concat(encodeURIComponent(o)))})),(new Image).src=t}},{key:"localInfoLog",value:function(e){var t=this.url,n={systemName:"open_netstream_localinfo",Ver:"v6.0.0",PlatAddr:window.location.protocol+"//"+window.location.host,ExterVer:"v6.0.0",OpId:this.uuid(),CltType:102,AppId:"",playurl:encodeURIComponent(this.jsPlugin.url),StartTime:(new Date).Format("yyyy-MM-dd hh:mm:ss.S"),OS:navigator.platform};n=Object.assign(n,e),Object.keys(n).forEach((function(e,i){var o=n[e];"string"==typeof n[e]&&(o=n[e].replace("%","%25")),void 0!==n[e]&&(t+="".concat(0===i?"":"&").concat(e,"=").concat(encodeURIComponent(o)))})),(new Image).src=t}},{key:"playLog",value:function(e){var t=this.url,n={systemName:"open_netstream_play_main",playurl:encodeURIComponent(this.jsPlugin.url),Time:(new Date).Format("yyyy-MM-dd hh:mm:ss.S"),Via:2,OpId:this.uuid()};n=Object.assign(n,e),Object.keys(n).forEach((function(e,i){var o=n[e];"string"==typeof n[e]&&(o=n[e].replace("%","%25")),void 0!==n[e]&&(t+="".concat(0===i?"":"&").concat(e,"=").concat(encodeURIComponent(o)))})),(new Image).src=t}}]),e}();!function(e,n){"object"===("undefined"==typeof module?"undefined":t(module))&&"object"===t(module.exports)?module.exports=e.document?n(e,!0):function(e){if(!e.document)throw new Error("EZUIPlayer requires a window with a document");return n(e)}:n(e)}("undefined"!=typeof window?window:void 0,(function(e,n){var i;function o(e,t){for(var n=document.getElementsByTagName("head")[0].getElementsByTagName("script"),i=!1,o=0;o<n.length;o++)n[o].getAttribute("src")==e&&(i=!0,t());if(!i){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,document.getElementsByTagName("head")[0].appendChild(r)}}function a(e,t,n,i,o,r){var a=e,d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=JSON.parse(d.responseText);o(e)}},d.open(t,a,!0);var s=new FormData;for(var c in n)s.append(c,n[c]);d.send(s)}var d={EZUIKitPlayer:void 0,EZUIKitTalk:void 0,opt:{apiDomain:"https://open.ys7.com/api/lapp/live/talk/url",filePath:"https://open.ys7.com/assets/ezuikit_v2.6.4",accessToken:"",url:"",deviceSerial:"",channelNo:"",id:"",talkLink:"",rtcUrl:"",ttsUrl:"",stream:"",isReliesReady:!1,template:"simple",plugin:[],audio:1,autoplay:1,videoLoading:!1},state:(i={countTimer:void 0,recodeTime:0,recodeTimer:void 0},r(i,"recodeTime",0),r(i,"fetchDefaultList",!1),r(i,"page",0),r(i,"pageSize",5),i),handleTalkSuccess:function(){},handleTalkError:function(){}},s="https://open.ys7.com",c=s,l=function(n){var i=this;this.opt={id:n.id,apiDomain:s+"/api/lapp/live/talk/url",filePath:c+"/assets/ezuikit_v2.6.4",decoderVersion:"",accessToken:"",url:"",deviceSerial:"",channelNo:"",talkLink:"",rtcUrl:"",ttsUrl:"",stream:"",isReliesReady:!1,template:"simple",plugin:[],audio:1,autoplay:1,fullScreenStatus:0,bSupporDoubleClickFull:!0,videoLoading:!1},this.params=n,n.id&&(this.opt.id=n.id),n.accessToken&&(this.opt.accessToken=n.accessToken),void 0!==n.audio&&(this.opt.audio=n.audio),void 0!==n.decoderVersion&&(this.opt.decoderVersion=n.decoderVersion),void 0!==n.env&&(void 0!==n.env.domain&&(s=n.env.domain,this.opt.apiDomain=s+"/api/lapp/live/talk/url"),void 0!==n.env.filePathDomain&&(c=n.env.filePathDomain,this.opt.filePathDomain=n.env.filePathDomain)),n.url&&(this.opt.url=n.url,this.opt.deviceSerial=n.url.split("/")[3],this.opt.channelNo=n.url.split("/")[4].split(".")[0]),void 0!==n.template&&(this.opt.template=n.template),n.plugin&&(this.opt.plugin=n.plugin),void 0!==n.autoplay&&(this.opt.autoplay=n.autoplay?1:0),void 0!==n.bSupporDoubleClickFull&&(this.opt.bSupporDoubleClickFull=n.bSupporDoubleClickFull),void 0!==n.handleTalkSuccess&&(e.EZUIKit.handleTalkSuccess=n.handleTalkSuccess),void 0!==n.handleTalkError&&(e.EZUIKit.handleTalkError=n.handleTalkError);var r=this.opt.id,l=document.getElementById(r);l.style.fontSize=0,l.style.overflowY="auto",l.style.position="relative";var u=document.createElement("iframe");u.src=function(){switch(i.opt.template){case"simple":var e=s+"/ezopen/h5/iframe?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+n.accessToken+"&templete=0&id="+r+"&decoderVersion="+i.opt.decoderVersion;return void 0!==n.controls&&n.controls&&(console.log("typeof",t(n.controls)),"play,voice,hd,fullScreen",n.controls.length>0&&(e+="&controls="+n.controls.join(","))),n.websocketParams&&(e+="&websocketParams="+JSON.stringify(n.websocketParams)),e;case"standard":return s+"/ezopen/h5/iframe?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+n.accessToken+"&templete=1&id="+r+"&decoderVersion="+i.opt.decoderVersion;case"security":return s+"/ezopen/h5/iframe_se?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+n.accessToken+"&templete=0&id="+r+"&decoderVersion="+i.opt.decoderVersion;case"theme":return e=s+"/jssdk/theme.html?url=".concat(n.url,"&accessToken=").concat(n.accessToken,"&id=").concat(r,"&isMobile=").concat(n.isMobile),void 0!==n.isMobile&&(e+="&isMobile="+n.isMobile),void 0!==n.autoplay&&(e+="&autoplay="+n.autoplay),void 0!==n.domain&&"https://test12open.ys7.com"==n.domain&&(e+="&env=test12"),void 0!==n.env&&void 0!==n.env.domain&&"https://test12open.ys7.com"==n.env.domain&&(e+="&env=test12"),void 0!==n.header&&(e+="&header="+n.header),e;default:return s+"/ezopen/h5/iframe?bSupporDoubleClickFull=0&url="+i.opt.url.replace("?","&")+"&autoplay="+i.opt.autoplay+"&audio="+i.opt.audio+"&accessToken="+n.accessToken+"&templete=0&id="+r+"&decoderVersion="+i.opt.decoderVersion}}();var p=document.getElementById(r).offsetHeight,m=document.getElementById(r).offsetWidth;n.height&&(p=parseInt(n.height),/\%$/.test(n.height)&&(m=document.getElementById(r).offsetWidth*(parseInt(n.height)/100))),n.width&&(m=parseInt(n.width),/\%$/.test(n.width)&&(m=document.getElementById(r).offsetWidth*(parseInt(n.width)/100))),u.width=m,u.height=p,u.id="EZUIKitPlayer-"+r,u.setAttribute("allowfullscreen",!0),u.setAttribute("allow","autoplay"),u.setAttribute("frameborder",0),l.appendChild(u);var h=i.opt.filePath+"/js/jquery.js";o(h,(function(){o("https://open.ys7.com/assets/layer/layer.js",(function(){if(g().headerContainer){var t=document.createElement("div");t.setAttribute("class","panel-top");var r=document.createElement("div");if(r.setAttribute("class","contros"),t.appendChild(r),l.insertBefore(t,u),g().capturePictureModule){var c=document.createElement("span");c.innerHTML='<span title="截图"><svg id="capturePicture" title="截图" t="1578882764585" class="icon" viewBox="0 0 1024 1024" version="1.1"  xmlns="http://www.w3.org/2000/svg" p-id="5958" width="24" height="24">  <path    d="M887.296 315.904h-153.6c-51.2 0-68.096-102.4-119.296-102.4H392.704c-34.304 0-51.2 102.4-102.4 102.4h-153.6c-29.696 0-51.2 21.504-51.2 51.2v439.296c0 25.6 21.504 47.104 51.2 47.104h751.104c29.696 0 51.2-21.504 51.2-51.2v-435.2c-0.512-30.208-21.504-51.2-51.712-51.2zM512 768c-115.2 0-204.8-89.6-204.8-200.704s89.6-200.704 204.8-200.704 204.8 89.6 204.8 200.704-93.696 200.704-204.8 200.704z m247.296-354.304c-12.8 0-25.6-12.8-25.6-25.6s12.8-25.6 25.6-25.6 25.6 12.8 25.6 25.6c0 17.408-12.8 25.6-25.6 25.6zM256 264.704c0-8.704-8.704-16.896-16.896-16.896h-51.2c-8.704 0-16.896 8.704-16.896 16.896V281.6H256v-16.896z m256 148.992c-85.504 0-153.6 68.096-153.6 153.6s68.096 153.6 153.6 153.6 153.6-68.096 153.6-153.6-68.096-153.6-153.6-153.6z"    fill="#ffffff" p-id="5959"></path></svg></span>',c.onclick=function(){i.capturePicture()},r.appendChild(c)}if(console.log("matchHeaderOpt().saveModule",g().saveModule),g().saveModule){var p=document.createElement("span");p.innerHTML='<span title="开始录像">  <svg id="startSave" t="1578882716693" class="icon" viewBox="0 0 1024 1024" version="1.1"    xmlns="http://www.w3.org/2000/svg" p-id="3782" width="24" height="24">    <path      d="M915.2 729.6l-128-76.8c-25.6-12.8-44.8-32-44.8-51.2V435.2c0-25.6 19.2-38.4 44.8-51.2l128-76.8c25.6-12.8 44.8 0 44.8 19.2V704c0 32-19.2 38.4-44.8 25.6z m-332.8 89.6H96c-51.2 0-89.6-38.4-89.6-89.6V332.8c0-51.2 38.4-89.6 89.6-89.6h486.4c51.2 0 89.6 38.4 89.6 89.6v396.8c0 51.2-38.4 89.6-89.6 89.6zM192 364.8c-32 6.4-57.6 32-64 64-12.8 57.6 38.4 115.2 96 102.4 32-6.4 57.6-32 64-70.4 12.8-57.6-38.4-108.8-96-96z m0 0"      p-id="3783" fill="#ffffff"></path>  </svg></span>',p.onclick=function(){i.startSave(),document.getElementById("startSave").setAttribute("class","icon hide"),document.getElementById("stopSave").setAttribute("class","icon")},r.appendChild(p);var m=document.createElement("span");m.innerHTML='<span title="结束录像"> <svg id="stopSave" t="1578882716693" class="icon hide" viewBox="0 0 1024 1024" version="1.1"   xmlns="http://www.w3.org/2000/svg" p-id="3782" width="24" height="24">   <path     d="M915.2 729.6l-128-76.8c-25.6-12.8-44.8-32-44.8-51.2V435.2c0-25.6 19.2-38.4 44.8-51.2l128-76.8c25.6-12.8 44.8 0 44.8 19.2V704c0 32-19.2 38.4-44.8 25.6z m-332.8 89.6H96c-51.2 0-89.6-38.4-89.6-89.6V332.8c0-51.2 38.4-89.6 89.6-89.6h486.4c51.2 0 89.6 38.4 89.6 89.6v396.8c0 51.2-38.4 89.6-89.6 89.6zM192 364.8c-32 6.4-57.6 32-64 64-12.8 57.6 38.4 115.2 96 102.4 32-6.4 57.6-32 64-70.4 12.8-57.6-38.4-108.8-96-96z m0 0"     p-id="3783" fill="red"></path> </svg> </span>',m.onclick=function(){i.stopSave(),document.getElementById("stopSave").setAttribute("class","icon hide"),document.getElementById("startSave").setAttribute("class","icon")},r.appendChild(m)}if(g().zoomModule){var h=document.createElement("span");h.innerHTML='<span title="开启电子放大">  <svg id="enableZoom" t="1578882639834" class="icon" viewBox="0 0 1000 1000" version="1.1"    xmlns="http://www.w3.org/2000/svg" p-id="2227" width="24" height="24">    <path      d="M830.6119 441.1089c0-193.7756-157.0939-350.8641-350.8775-350.8641S128.8559 247.3333 128.8559 441.1089 285.9508 791.972 479.7344 791.972 830.6119 634.8845 830.6119 441.1089zM483.2821 710.4863c-146.7975 0-265.8187-118.9953-265.8187-265.8088S336.4847 178.8697 483.2821 178.8697s265.8197 118.9953 265.8197 265.8078S630.0796 710.4863 483.2821 710.4863zM770.6031 653.5739l-72.6417 75.9485 141.6917 160.1814 82.0737-90.0739L770.6031 653.5739zM527.5849 267.4727h-88.60655762279428v132.90489048425167H306.0690340253259v88.60292721534799h132.90933675248866v132.9038911617923h88.60655762279428V488.9794719180395h132.90933675248866v-88.60292721534799H527.5849284006089V267.4726535408993z"      p-id="2228" fill="#ffffff"></path>  </svg></span>',h.onclick=function(){i.enableZoom(),document.getElementById("enableZoom").setAttribute("class","icon hide"),document.getElementById("closeZoom").setAttribute("class","icon")},r.appendChild(h);var f=document.createElement("span");f.innerHTML='<span title="关闭电子放大">  <svg id="closeZoom" t="1578882639834" class="icon hide" viewBox="0 0 1000 1000" version="1.1"    xmlns="http://www.w3.org/2000/svg" p-id="2227" width="24" height="24">    <path      d="M830.6119 441.1089c0-193.7756-157.0939-350.8641-350.8775-350.8641S128.8559 247.3333 128.8559 441.1089 285.9508 791.972 479.7344 791.972 830.6119 634.8845 830.6119 441.1089zM483.2821 710.4863c-146.7975 0-265.8187-118.9953-265.8187-265.8088S336.4847 178.8697 483.2821 178.8697s265.8197 118.9953 265.8197 265.8078S630.0796 710.4863 483.2821 710.4863zM770.6031 653.5739l-72.6417 75.9485 141.6917 160.1814 82.0737-90.0739L770.6031 653.5739zM527.5849 267.4727h-88.60655762279428v132.90489048425167H306.0690340253259v88.60292721534799h132.90933675248866v132.9038911617923h88.60655762279428V488.9794719180395h132.90933675248866v-88.60292721534799H527.5849284006089V267.4726535408993z"      p-id="2228" fill="red"></path>  </svg></span>',f.onclick=function(){i.closeZoom(),document.getElementById("closeZoom").setAttribute("class","icon hide"),document.getElementById("enableZoom").setAttribute("class","icon")},r.appendChild(f)}}function v(){var e={footerContainer:!1,talkModule:!1,broadcastModule:!1,hdModule:!1,fullScreenModule:!1};switch(i.opt.template){case"simple":case"standard":var t;if(n.footer&&n.footer instanceof Array)e={footerContainer:!0,talkModule:-1!==(t=n.footer).indexOf("talk"),broadcastModule:-1!==t.indexOf("broadcast"),hdModule:-1!==t.indexOf("hd"),fullScreenModule:-1!==t.indexOf("fullScreen")};break;case"security":break;case"voice":e={footerContainer:!0,talkModule:!0,broadcastModule:!0,hdModule:!0,fullScreenModule:!0}}return e}function g(){var e={headerContainer:!1,capturePictureModule:!1,saveModule:!1,zoomModule:!1};switch(i.opt.template){case"simple":if(n.header&&n.header instanceof Array){var t=n.header;e={headerContainer:!0,capturePictureModule:-1!==t.indexOf("capturePicture"),saveModule:-1!==t.indexOf("save"),zoomModule:-1!==t.indexOf("zoom")}}break;case"standard":case"security":break;case"voice":e={headerContainer:!0,capturePictureModule:!0,saveModule:!0,zoomModule:!0}}return e}if(v().footerContainer||-1!==i.opt.plugin.indexOf("talk")){var y=i.opt.filePath+"/npm/css/recoder.css",C=i.opt.filePath+"/npm/js/recoder.js",S=i.opt.filePath+"/recorder.js";if(function(e,t){for(var n=document.getElementsByTagName("head")[0].getElementsByTagName("link"),i=!1,o=0;o<n.length;o++)n[o].getAttribute("href")==e&&(i=!0,t());if(!i){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=e,r.onload=t,document.getElementsByTagName("head")[0].appendChild(r)}}(y,(function(){})),o(C,(function(){o(S,(function(){}))})),-1!==i.opt.plugin.indexOf("talk")||v().talkModule){a(i.opt.apiDomain,"POST",{accessToken:i.opt.accessToken,deviceSerial:i.opt.deviceSerial,channelNo:i.opt.channelNo},0,(function(t){if(console.log("data",t),200==t.code){var n=t.data;if(n){var r=n.rtcUrl;-1===r.indexOf("ws")&&(r=r.replace("https","wss").replace("rtcgw","rtcgw-ws")),i.opt.rtcUrl=r,i.opt.ttsUrl="tts://"+n.ttsUrl;var a="talk://"+i.opt.deviceSerial+":0:"+i.opt.channelNo+":cas.ys7.com:6500";if(i.opt.talkLink=i.opt.ttsUrl+"/"+a,i.opt.stream=n.stream,console.log("_this.opt",i.opt),!i.opt.isReliesReady){var s=i.opt.filePath+"/npm/js/adapeter.js",c=i.opt.filePath+"/npm/js/janus.js",l=i.opt.filePath+"/npm/js/tts.js";console.log("加载jquery.js"),o(s,(function(){console.log("加载adapeter.js"),o(c,(function(){console.log("加载janus.js"),o(l,(function(){console.log("加载tts.js"),i.opt.isReliesReady=!0}))}))}))}if(!document.getElementById("audioleft")){var u=document.createElement("div");u.style.display="none",u.id="audioleft",document.body.appendChild(u)}if(!document.getElementById("audioright")){var p=document.createElement("div");p.style.display="none",p.id="audioright",document.body.appendChild(p)}}}d.opt=i.opt,e.EZUIKit&&(e.EZUIKit.opt=i.opt)}))}if(v().footerContainer){var T=function(e,t){if(clearInterval(d.state.countTimer),"add"===e){var n=t;d.state.countTimer=setInterval((function(){++n,document.getElementById("time-area").innerHTML=i(n)}),1e3)}else if("sub"===e){n=t;d.state.countTimer=setInterval((function(){n>0?(n--,document.getElementById("time-area").innerHTML=i(n)):(clearInterval(d.state.countTimer),d.state.countTimer=void 0,console.log("倒计时结束，开启声音"))}),1e3)}else"destory"===e&&(clearInterval(d.state.countTimer),d.state.countTimer=void 0,document.getElementById("time-area").innerHTML="00:00");function i(e){var t,n,i,o=parseInt(e),r=0,a=0;return o>59&&(r=parseInt(o/60),o=parseInt(o%60),r>59&&(a=parseInt(r/60),r=parseInt(r%60))),t=parseInt(o)>9?parseInt(o):"0"+parseInt(o),n=parseInt(r)>9?parseInt(r):"0"+parseInt(r),i=parseInt(a)>9?parseInt(a):"0"+parseInt(a),a>0?i+":"+n+":"+t:r>0?n+":"+t:"00:"+t}},b=document.createElement("div");if(b.setAttribute("class","audio-controls"),l.appendChild(b),v().hdModule||v().fullScreenModule){var w=document.createElement("div");if(w.setAttribute("class","contros"),b.appendChild(w),v().hdModule){var P=document.createElement("span");P.setAttribute("id","video-hd"),P.innerHTML=-1===i.opt.url.indexOf(".hd")?"标清":"高清",P.onclick=function(){if(i.opt.videoLoading)return layer.msg("视频加载中，请稍后"),!1;var e=i.stop();i.opt.videoLoading=!0,e.then((function(e){i.opt.videoLoading=!1,-1===i.opt.url.indexOf(".hd")?(i.opt.url=i.opt.url.replace(".live",".hd.live"),P.innerHTML=-1===i.opt.url.indexOf(".hd")?"标清":"高清"):(i.opt.url=i.opt.url.replace(".hd.live",".live"),P.innerHTML=-1===i.opt.url.indexOf(".hd")?"标清":"高清"),i.play(i.opt.url)})).catch((function(e){console.log("error",e)}))},w.appendChild(P)}if(v().fullScreenModule){var k=document.createElement("span");k.setAttribute("class","hide"),k.setAttribute("id","ezuikit-open-sound"),k.setAttribute("title","打开声音"),k.setAttribute("style","vertical-align: top;"),k.innerHTML='<svg t="1590476263239" class="icon" viewBox="0 0 1178 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2273" width="16" height="16"><path d="M665.6 51.2 665.6 51.2c-10.24-30.72-40.96-51.2-71.68-51.2-5.12 0-15.36 0-20.48 5.12l0 0L358.4 153.6 51.2 209.92l0 0C20.48 220.16 0 250.88 0 281.6 0 286.72 0 291.84 0 307.2l0 0 0 409.6 0 0c0 15.36 0 20.48 0 25.6 0 30.72 20.48 61.44 51.2 71.68l0 0L358.4 870.4l97.28 71.68 107.52 76.8 0 0c5.12 5.12 15.36 5.12 25.6 5.12 40.96 0 76.8-35.84 76.8-76.8 0-10.24 0-10.24 0-25.6l0 0L665.6 51.2zM563.2 870.4l-153.6-102.4-307.2-51.2L102.4 307.2l307.2-51.2 153.6-102.4L563.2 870.4z" p-id="2274" fill="#FF0000"></path><path d="M1049.6 537.6l112.64-112.64c20.48-20.48 20.48-56.32 0-76.8-20.48-20.48-56.32-20.48-76.8 0L972.8 460.8l-112.64-112.64c0 0 0 0 0 0-20.48-20.48-56.32-20.48-76.8 0 0 0 0 0 0 0-20.48 20.48-20.48 56.32 0 76.8l112.64 112.64-112.64 112.64c-20.48 20.48-20.48 56.32 0 76.8 20.48 20.48 56.32 20.48 76.8 0L972.8 614.4l112.64 112.64c20.48 20.48 56.32 20.48 76.8 0s20.48-56.32 0-76.8L1049.6 537.6z" p-id="2275" fill="#FF0000"></path></svg>',k.onclick=function(){i.openSound(0),k.setAttribute("class","hide"),E.setAttribute("class","")};var E=document.createElement("span");k.setAttribute("id","ezuikit-close-sound"),E.setAttribute("class","hide"),E.setAttribute("title","关闭声音"),E.setAttribute("style","vertical-align: top;"),E.innerHTML='<svg t="1590414410633" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20545" width="16" height="16"><path d="M840.533333 98.133333c-17.066667-17.066667-42.666667-17.066667-59.733333 0-17.066667 17.066667-17.066667 42.666667 0 59.733334C883.2 256 938.666667 392.533333 938.666667 533.333333c0 140.8-55.466667 277.333333-157.866667 375.466667-17.066667 17.066667-17.066667 42.666667 0 59.733333 8.533333 8.533333 21.333333 12.8 29.866667 12.8 8.533333 0 21.333333-4.266667 29.866666-12.8 115.2-110.933333 183.466667-268.8 183.466667-435.2 0-166.4-68.266667-324.266667-183.466667-435.2zM571.733333 12.8c-17.066667-8.533333-34.133333-4.266667-46.933333 8.533333L281.6 256H42.666667c-25.6 0-42.666667 17.066667-42.666667 42.666667v426.666666c0 25.6 17.066667 42.666667 42.666667 42.666667h238.933333l243.2 234.666667c8.533333 8.533333 17.066667 12.8 29.866667 12.8 4.266667 0 12.8 0 17.066666-4.266667 17.066667-8.533333 25.6-21.333333 25.6-38.4V51.2c0-17.066667-8.533333-34.133333-25.6-38.4zM512 870.4l-183.466667-179.2c-8.533333-4.266667-17.066667-8.533333-29.866666-8.533333H85.333333V341.333333h213.333334c12.8 0 21.333333-4.266667 29.866666-12.8L512 153.6v716.8z" p-id="20546" fill="#ffffff"></path><path d="M759.466667 349.866667c-12.8-21.333333-38.4-25.6-59.733334-8.533334-21.333333 12.8-25.6 38.4-8.533333 59.733334 21.333333 29.866667 34.133333 76.8 34.133333 123.733333 0 46.933333-12.8 93.866667-34.133333 123.733333-12.8 21.333333-8.533333 46.933333 8.533333 59.733334 8.533333 4.266667 17.066667 8.533333 25.6 8.533333 12.8 0 25.6-4.266667 34.133334-17.066667 34.133333-46.933333 51.2-106.666667 51.2-174.933333 0-68.266667-17.066667-128-51.2-174.933333z" p-id="20547" fill="#ffffff"></path></svg>',E.onclick=function(){i.closeSound(0),k.setAttribute("class",""),E.setAttribute("class","hide")},w.appendChild(k),w.appendChild(E)}if(1==i.opt.audio?E.setAttribute("class",""):(k.setAttribute("class",""),i.closeSound(0)),v().fullScreenModule){var I=document.createElement("span");I.setAttribute("title","全屏"),I.setAttribute("style","vertical-align: top;"),I.innerHTML='<svg id="fullScreen" t="1578020167938" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5035" width="16" height="16"> <path d="M348.373333 625.706667l-128 128-64 64v-128a33.28 33.28 0 0 0-35.413333-35.413334A33.493333 33.493333 0 0 0 85.333333 689.706667v213.333333A33.706667 33.706667 0 0 0 120.96 938.666667h213.333333a35.626667 35.626667 0 0 0 0-71.04h-128l64-64 128-128a35.2 35.2 0 0 0-49.92-49.92zM206.293333 156.373333h128a33.28 33.28 0 0 0 35.413334-35.413333A33.493333 33.493333 0 0 0 334.293333 85.333333H113.706667c-7.04 0-14.08 7.04-21.333334 14.293334a26.026667 26.026667 0 0 0-7.04 21.333333v213.333333a33.493333 33.493333 0 0 0 35.626667 35.413334 33.28 33.28 0 0 0 35.413333-35.413334v-128l192 192a35.2 35.2 0 0 0 49.92-49.92zM903.04 85.333333h-213.333333a33.493333 33.493333 0 0 0-35.413334 35.626667 33.28 33.28 0 0 0 35.413334 35.413333h128l-64 64-128 128a35.2 35.2 0 0 0 49.92 49.92l128-128 64-64v128a35.626667 35.626667 0 0 0 71.04 0v-213.333333A33.706667 33.706667 0 0 0 903.04 85.333333zM903.04 654.293333a33.28 33.28 0 0 0-35.413333 35.413334v128l-64-64-128-128a35.2 35.2 0 0 0-49.92 49.92l128 128 64 64h-128a35.626667 35.626667 0 0 0 0 71.04h213.333333A33.706667 33.706667 0 0 0 938.666667 903.04v-213.333333a33.493333 33.493333 0 0 0-35.626667-35.413334z" p-id="5036" fill="#ffffff"></path></svg>',I.onclick=function(){i.fullScreen()},w.appendChild(I)}}if(v().talkModule){var x=document.createElement("div"),_=document.createElement("div");x.setAttribute("class","ptp-talk off"),x.innerHTML='<span title="对讲"><svg t="1581930496966" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  p-id="1641" width="16" height="16">  <path    d="M715.648 647.872c-30.208-22.336-61.568 39.36-100.992 77.44-39.36 38.08-34.112 31.488-123.392-17.088S311.488 540.224 280 491.648C248.448 443.072 265.472 424.704 265.472 424.704s78.72-62.976 97.152-81.344c18.368-18.368 13.12-30.208 13.12-30.208l-128.64-190.144c-23.616-5.184-64.32 5.12-128.576 57.6C54.208 233.088 30.592 353.856 151.296 575.68c120.768 221.824 347.84 330.752 485.568 374.08 137.856 43.328 228.416-61.696 249.408-103.68 21.056-41.984 13.12-85.312 13.12-85.312S745.856 670.208 715.648 647.872z"    p-id="1642" fill="#ffffff"></path>  <path    d="M715.328 64C580.992 64 472.192 172.864 472.192 307.2s108.8 243.2 243.136 243.2 243.2-108.864 243.2-243.2S849.6 64 715.328 64zM715.328 461.056c-84.992 0-153.856-68.864-153.856-153.856s68.864-153.856 153.856-153.856 153.856 68.928 153.856 153.856S800.32 461.056 715.328 461.056z"    p-id="1643" fill="#ffffff"></path>  <path    d="M777.472 277.376c-18.176 0-32.96-14.784-32.96-33.024 0-8.448 3.136-16.064 8.32-21.888-11.52-5.12-24.128-8-37.568-8-51.2 0-92.672 41.472-92.672 92.736s41.472 92.736 92.672 92.736S808.064 358.4 808.064 307.2c0-13.696-3.072-26.688-8.384-38.4C793.728 274.112 786.048 277.376 777.472 277.376zM715.328 340.928c-18.624 0-33.664-15.104-33.664-33.728 0-18.624 15.04-33.728 33.664-33.728 18.688 0 33.728 15.104 33.728 33.728C749.056 325.824 734.016 340.928 715.328 340.928z"    p-id="1644" fill="#ffffff"></path> </svg> </span> <span>开启对讲</span>',x.onclick=function(){if(console.log("EZUIKit.state.countTimer",d.state.countTimer),d.state.countTimer)return e.layer.msg("语音设备正忙，请稍后重试"),!1;T("add",0),console.log("开始对讲，关闭声音"),i.closeSound(0),console.log(i.opt),i.startTalk(),this.setAttribute("class","ptp-talk off hide"),_.setAttribute("class","ptp-talk on")},_.setAttribute("class","ptp-talk on hide"),_.innerHTML='<span title="对讲"> <svg t="1581930496966" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1641" width="16" height="16">    <path      d="M715.648 647.872c-30.208-22.336-61.568 39.36-100.992 77.44-39.36 38.08-34.112 31.488-123.392-17.088S311.488 540.224 280 491.648C248.448 443.072 265.472 424.704 265.472 424.704s78.72-62.976 97.152-81.344c18.368-18.368 13.12-30.208 13.12-30.208l-128.64-190.144c-23.616-5.184-64.32 5.12-128.576 57.6C54.208 233.088 30.592 353.856 151.296 575.68c120.768 221.824 347.84 330.752 485.568 374.08 137.856 43.328 228.416-61.696 249.408-103.68 21.056-41.984 13.12-85.312 13.12-85.312S745.856 670.208 715.648 647.872z"      p-id="1642" fill="#ff0000"></path>    <path      d="M715.328 64C580.992 64 472.192 172.864 472.192 307.2s108.8 243.2 243.136 243.2 243.2-108.864 243.2-243.2S849.6 64 715.328 64zM715.328 461.056c-84.992 0-153.856-68.864-153.856-153.856s68.864-153.856 153.856-153.856 153.856 68.928 153.856 153.856S800.32 461.056 715.328 461.056z"      p-id="1643" fill="#ff0000"></path>    <path      d="M777.472 277.376c-18.176 0-32.96-14.784-32.96-33.024 0-8.448 3.136-16.064 8.32-21.888-11.52-5.12-24.128-8-37.568-8-51.2 0-92.672 41.472-92.672 92.736s41.472 92.736 92.672 92.736S808.064 358.4 808.064 307.2c0-13.696-3.072-26.688-8.384-38.4C793.728 274.112 786.048 277.376 777.472 277.376zM715.328 340.928c-18.624 0-33.664-15.104-33.664-33.728 0-18.624 15.04-33.728 33.664-33.728 18.688 0 33.728 15.104 33.728 33.728C749.056 325.824 734.016 340.928 715.328 340.928z"      p-id="1644" fill="#ff0000"></path>  </svg> </span><span>关闭对讲</span>',_.onclick=function(){console.log(i.opt),i.stopTalk(),T("destory",0),i.openSound(0),this.setAttribute("class","ptp-talk on hide"),x.setAttribute("class","ptp-talk off")},b.appendChild(x),b.appendChild(_)}if(v().broadcastModule){var j=function e(t){a(s+"/api/lapp/voice/query","POST",{accessToken:i.opt.accessToken,pageStart:t,pageSize:d.state.pageSize,default:d.state.fetchDefaultList?"true":"false"},0,(function(n){console.log("data",n),200==n.code&&(R(n.data,5),d.state.page=n.page.page,0!=t||0!=n.data.length||d.state.fetchDefaultList||(d.state.fetchDefaultList=!0,e(0)))}))},R=function(e){if(console.log("renderVoliceList",e),e&&e.length>0){for(var t=0;t<e.length;t++){var n=document.createElement("li");n.innerHTML="<li class='voice-item' id='voice-item-"+t+"' data-time="+(e[t].duration||20)+" data-url="+e[t].fileUrl+">"+(e[t].voiceName.length>10?e[t].voiceName.substr(0,10)+"...":e[t].voiceName)+"</li>",document.getElementsByClassName("voice-list-ul")[0].append(n),n.onclick=function(e){console.log("点击元素",e.target,e.target.dataset.url);var t=e.target.dataset.url,n=e.target.dataset.time;M(t,n)}}e.length===d.state.pageSize?document.getElementById("voice-list-end").innerHTML="向下滚动加载更多":document.getElementById("voice-list-end").innerHTML="没有更多数据了"}},M=function(t,n){console.log("播放语音",t,n),a(s+"/api/lapp/voice/send","POST",{accessToken:i.opt.accessToken,deviceSerial:i.opt.deviceSerial,channelNo:i.opt.channelNo,fileUrl:t},0,(function(t){console.log("data.data",t.data),200==t.code?T("sub",parseInt(n)):"10001"==t.code?e.layer.msg("未找到当前语音"):e.layer.msg(t.msg||"发送失败，请稍后再试")}))},D=document.createElement("div"),A=document.createElement("div");D.setAttribute("class","broadcast off"),A.setAttribute("class","broadcast on hide"),D.innerHTML=' <span title="语音播报">  <svg t="1583561695846" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1126" width="16" height="16">    <path      d="M513.82044445 964.38044445c-8.192 0-15.47377778-2.73066667-21.84533334-8.192 0 0-46.42133333-41.87022222-99.21422222-86.47111112-89.20177778-73.728-117.41866667-88.29155555-123.79022222-90.112H35.04355555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666V271.70133333c0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666666H246.21511111c7.28177778-2.73066667 37.31911111-15.47377778 137.44355556-91.02222222 58.25422222-43.69066667 111.04711111-86.47111111 111.04711111-86.47111112 5.46133333-4.55111111 12.74311111-7.28177778 20.02488889-7.28177778 4.55111111 0 10.01244445 0.91022222 14.56355555 3.6408889 10.92266667 5.46133333 18.20444445 17.29422222 18.20444445 30.03733333v837.40444444c0 12.74311111-7.28177778 25.48622222-19.11466667 30.94755556-5.46133333 1.82044445-10.01244445 2.73066667-14.56355555 2.73066667zM270.79111111 724.992c19.11466667 0 48.24177778 8.192 167.48088889 106.496 16.384 13.65333333 33.67822222 28.21688889 51.88266667 43.69066667l5.46133333 4.55111111V139.71911111l-5.46133333 3.64088889c-22.75555555 17.29422222-44.60088889 34.58844445-65.536 50.06222222C293.54666667 291.72622222 264.41955555 299.008 245.30488889 299.008H82.37511111c-20.02488889 0-21.84533333 12.74311111-21.84533333 26.39644445V694.04444445c0 23.66577778 6.37155555 30.03733333 28.21688889 30.03733333h180.224l1.82044444 0.91022222z m520.64711111 162.01955555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666 0-11.83288889 8.192-20.02488889 16.384-24.576 112.86755555-67.35644445 182.04444445-191.14666667 182.04444444-324.03911111 0-132.89244445-70.08711111-256.68266667-182.04444444-324.03911111-10.01244445-5.46133333-15.47377778-14.56355555-15.47377778-24.576 0-14.56355555 11.83288889-27.30666667 26.39644445-27.30666667 5.46133333 0 10.01244445 1.82044445 16.384 5.46133333 128.34133333 76.45866667 207.53066667 218.45333333 207.53066666 369.55022222 0 152.00711111-80.09955555 293.09155555-208.44088889 369.55022223-6.37155555 5.46133333-10.92266667 7.28177778-16.384 7.28177777z m-90.112-152.91733333c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666667 0-10.01244445 4.55111111-18.20444445 12.74311111-23.66577777 61.89511111-34.58844445 100.12444445-100.12444445 100.12444444-171.12177778 0-70.08711111-37.31911111-134.71288889-96.48355555-170.21155555-8.192-4.55111111-12.74311111-13.65333333-12.74311111-23.66577778 0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666667 4.55111111 0 11.83288889 2.73066667 15.47377778 4.55111111 74.63822222 44.60088889 121.96977778 127.43111111 121.96977778 215.72266667 0 90.112-48.24177778 173.85244445-125.61066667 218.45333333-1.82044445 0-9.10222222 4.55111111-15.47377778 4.55111111z"      fill="#ffffff" p-id="1127"></path>  </svg></span><span>语音播报</span>',D.onclick=function(){this.setAttribute("class","broadcast off hide"),A.setAttribute("class","broadcast on")},A.innerHTML='<div class="pop-hover">  <div class="pop-hover-content">    <div class="vioce-list" id="voice-list">      <ul class="voice-list-ul">      </ul>      <div id="voice-list-end"></div>    </div>    <div id="voice-custom" style="text-align: center;">自定义语音</div>  </div></div><span title="语音播报">  <svg t="1583561695846" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1126" width="16" height="16">    <path      d="M513.82044445 964.38044445c-8.192 0-15.47377778-2.73066667-21.84533334-8.192 0 0-46.42133333-41.87022222-99.21422222-86.47111112-89.20177778-73.728-117.41866667-88.29155555-123.79022222-90.112H35.04355555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666V271.70133333c0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666666H246.21511111c7.28177778-2.73066667 37.31911111-15.47377778 137.44355556-91.02222222 58.25422222-43.69066667 111.04711111-86.47111111 111.04711111-86.47111112 5.46133333-4.55111111 12.74311111-7.28177778 20.02488889-7.28177778 4.55111111 0 10.01244445 0.91022222 14.56355555 3.6408889 10.92266667 5.46133333 18.20444445 17.29422222 18.20444445 30.03733333v837.40444444c0 12.74311111-7.28177778 25.48622222-19.11466667 30.94755556-5.46133333 1.82044445-10.01244445 2.73066667-14.56355555 2.73066667zM270.79111111 724.992c19.11466667 0 48.24177778 8.192 167.48088889 106.496 16.384 13.65333333 33.67822222 28.21688889 51.88266667 43.69066667l5.46133333 4.55111111V139.71911111l-5.46133333 3.64088889c-22.75555555 17.29422222-44.60088889 34.58844445-65.536 50.06222222C293.54666667 291.72622222 264.41955555 299.008 245.30488889 299.008H82.37511111c-20.02488889 0-21.84533333 12.74311111-21.84533333 26.39644445V694.04444445c0 23.66577778 6.37155555 30.03733333 28.21688889 30.03733333h180.224l1.82044444 0.91022222z m520.64711111 162.01955555c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666666 0-11.83288889 8.192-20.02488889 16.384-24.576 112.86755555-67.35644445 182.04444445-191.14666667 182.04444444-324.03911111 0-132.89244445-70.08711111-256.68266667-182.04444444-324.03911111-10.01244445-5.46133333-15.47377778-14.56355555-15.47377778-24.576 0-14.56355555 11.83288889-27.30666667 26.39644445-27.30666667 5.46133333 0 10.01244445 1.82044445 16.384 5.46133333 128.34133333 76.45866667 207.53066667 218.45333333 207.53066666 369.55022222 0 152.00711111-80.09955555 293.09155555-208.44088889 369.55022223-6.37155555 5.46133333-10.92266667 7.28177778-16.384 7.28177777z m-90.112-152.91733333c-14.56355555 0-26.39644445-11.83288889-26.39644444-27.30666667 0-10.01244445 4.55111111-18.20444445 12.74311111-23.66577777 61.89511111-34.58844445 100.12444445-100.12444445 100.12444444-171.12177778 0-70.08711111-37.31911111-134.71288889-96.48355555-170.21155555-8.192-4.55111111-12.74311111-13.65333333-12.74311111-23.66577778 0-14.56355555 11.83288889-27.30666667 26.39644444-27.30666667 4.55111111 0 11.83288889 2.73066667 15.47377778 4.55111111 74.63822222 44.60088889 121.96977778 127.43111111 121.96977778 215.72266667 0 90.112-48.24177778 173.85244445-125.61066667 218.45333333-1.82044445 0-9.10222222 4.55111111-15.47377778 4.55111111z"      fill="#ff0000" p-id="1127"></path>  </svg></span><span>语音播报</span>',A.onclick=function(){this.setAttribute("class","broadcast on hide"),D.setAttribute("class","broadcast off")},b.appendChild(D),b.appendChild(A),document.getElementById("voice-custom").onclick=function(){console.log("显示自定义语音"),B.setAttribute("class","speak off")},j(0);var B=document.createElement("div"),z=document.createElement("div");B.setAttribute("class","speak off hide"),z.setAttribute("class","speak on hide"),B.setAttribute("id","startSpeak"),z.setAttribute("id","stopSpeak"),B.innerHTML='<span title="按住说话">  <svg t="1581994757678" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"    p-id="1639" width="16" height="16">    <path      d="M757.059829 393.846154v-52.512821h262.564103v52.512821H757.059829z m-420.102564 481.367521v96.273504h175.042735a8.752137 8.752137 0 0 1 8.752137 8.752137v35.008547a8.752137 8.752137 0 0 1-8.752137 8.752137H109.401709a8.752137 8.752137 0 0 1-8.752136-8.752137v-35.008547a8.752137 8.752137 0 0 1 8.752136-8.752137h175.042735v-96.273504C129.767932 875.213675 4.376068 749.821812 4.376068 595.145299V463.863248a26.25641 26.25641 0 1 1 52.512821 0v113.777778c0 140.174222 113.637744 253.811966 253.811966 253.811965s253.811966-113.637744 253.811966-253.811965V463.863248a26.25641 26.25641 0 1 1 52.51282 0v131.282051c0 154.676513-125.391863 280.068376-280.068376 280.068376z m-26.25641-96.273504c-111.178393 0-201.299145-90.120752-201.299146-201.299145V201.299145C109.401709 90.120752 199.522462 0 310.700855 0s201.299145 90.120752 201.299145 201.299145v376.341881c0 111.178393-90.120752 201.299145-201.299145 201.299145z m691.418803-280.068376H757.059829v-52.512821h245.059829v52.512821z m-17.504273 105.025641H757.059829v-52.512821h227.555556v52.512821z m-17.504274 105.025641H757.059829v-52.512821h210.051282v52.512821z m-8.752137 105.025641H757.059829v-52.512821h201.299145v52.512821z m-17.504273 105.025641H757.059829v-52.512821h183.794872v52.512821z m-26.25641 105.025641H757.059829v-52.512821h157.538462v52.512821z"      p-id="1640" fill="#ffffff"></path>  </svg></span><span>按住说话</span>',z.innerHTML='<span title="按住说话"><svg t="1581994757678" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  p-id="1639" width="16" height="16">  <path    d="M757.059829 393.846154v-52.512821h262.564103v52.512821H757.059829z m-420.102564 481.367521v96.273504h175.042735a8.752137 8.752137 0 0 1 8.752137 8.752137v35.008547a8.752137 8.752137 0 0 1-8.752137 8.752137H109.401709a8.752137 8.752137 0 0 1-8.752136-8.752137v-35.008547a8.752137 8.752137 0 0 1 8.752136-8.752137h175.042735v-96.273504C129.767932 875.213675 4.376068 749.821812 4.376068 595.145299V463.863248a26.25641 26.25641 0 1 1 52.512821 0v113.777778c0 140.174222 113.637744 253.811966 253.811966 253.811965s253.811966-113.637744 253.811966-253.811965V463.863248a26.25641 26.25641 0 1 1 52.51282 0v131.282051c0 154.676513-125.391863 280.068376-280.068376 280.068376z m-26.25641-96.273504c-111.178393 0-201.299145-90.120752-201.299146-201.299145V201.299145C109.401709 90.120752 199.522462 0 310.700855 0s201.299145 90.120752 201.299145 201.299145v376.341881c0 111.178393-90.120752 201.299145-201.299145 201.299145z m691.418803-280.068376H757.059829v-52.512821h245.059829v52.512821z m-17.504273 105.025641H757.059829v-52.512821h227.555556v52.512821z m-17.504274 105.025641H757.059829v-52.512821h210.051282v52.512821z m-8.752137 105.025641H757.059829v-52.512821h201.299145v52.512821z m-17.504273 105.025641H757.059829v-52.512821h183.794872v52.512821z m-26.25641 105.025641H757.059829v-52.512821h157.538462v52.512821z"    p-id="1640" fill="#ff0000"></path></svg></span><span>松开发送</span>',b.appendChild(B),b.appendChild(z),document.getElementById("voice-list").onscroll=function(e){var t=this.scrollHeight;console.log("sum",t,this.scrollTop,document.getElementById("voice-list").clientHeight),t<=this.scrollTop+this.clientHeight&&(console.log("拖动到底，执行加载",d.state.page),j(++d.state.page))};var F,L=document.createElement("div");L.setAttribute("class","time-area"),L.setAttribute("id","time-area"),L.innerHTML="00:00",b.appendChild(L),document.getElementById("startSpeak").onmousedown=function(){if(d.state.countTimer)return e.layer.msg("语音设备正忙，请稍后重试"),!1;var t;function n(n){var i=t.createMediaStreamSource(n);F=new e.Recorder(i)}console.log("按住说话"),B.setAttribute("class","speak off hide"),z.setAttribute("class","speak on"),function(){console.log("run init");try{e.AudioContext=e.AudioContext||e.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia,e.URL=e.URL||e.webkitURL,t=new AudioContext,console.log("Audio context set up."),console.log("navigator.getUserMedia "+(navigator.getUserMedia?"available.":"not present!"))}catch(t){console.log("err",t),e.layer.msg("No web audio support in this browser!")}navigator.getUserMedia({audio:!0},n,(function(e){console.log("No live audio input: "+e)}))}(),T("add",0),setTimeout((function(){d.state.recodeTime=0,F&&F.record()}),1e3),d.state.recodeTimer&&clearInterval(d.state.recodeTimer),d.state.recodeTimer=setInterval((function(){d.state.recodeTime>=59?(i.stopTalk(),T("destory",0),this.setAttribute("class","ptp-talk on hide"),x.setAttribute("class","ptp-talk off"),e.layer.msg("不超过1分钟")):d.state.recodeTime=d.state.recodeTime+1}),1e3)},document.getElementById("stopSpeak").onmouseup=function(){console.log("松开发送"),z.setAttribute("class","speak on hide"),function(){if(T("destory",0),d.state.recodeTime<1)return e.layer.msg("说话时间过短"),clearInterval(d.state.recodeTimer),!1;clearInterval(d.state.recodeTimer),function(){try{F&&F.stop(),F&&F.exportWAV((function(t){if(console.log("wav_file",t),t.size<1e3)return e.layer.msg("录音失败，请重试"),d.state.recodeTime=0,!1;T("sub",d.state.recodeTime+2);var n=new FormData;n.append("voiceFile",t),n.append("accessToken",i.opt.accessToken),n.append("deviceSerial",i.opt.deviceSerial),n.append("channelNo",i.opt.channelNo),a(s+"/api/lapp/voice/sendonce","POST",{voiceFile:t,accessToken:i.opt.accessToken,deviceSerial:i.opt.deviceSerial,channelNo:i.opt.channelNo},0,(function(t){console.log("data.data",t.data),200==t.code?T("sub",d.state.recodeTime+2):"10001"==t.code?e.layer.msg("未找到当前语音"):e.layer.msg(t.msg||"发送失败，请稍后再试")}))})),F&&F.clear()}catch(e){console.log(e)}}()}()}}}}}))}));i=this;function f(e){i.opt.fullScreenStatus=e?1:0,n.fullScreenChangeCallBack&&n.fullScreenChangeCallBack({data:e,id:i.opt.id})}e.addEventListener("message",(function(t){t.origin;var o=i.opt.id;if(t.data.type)switch(t.data.type){case"openSound":o==t.data.id&&n.openSoundCallBack&&n.openSoundCallBack(t.data);break;case"closeSound":o==t.data.id&&n.closeSoundCallBack&&n.closeSoundCallBack(t.data);break;case"capturePicture":o==t.data.id&&n.capturePictureCallBack&&n.capturePictureCallBack(t.data);break;case"startSave":o==t.data.id&&n.startSaveCallBack&&n.startSaveCallBack(t.data);break;case"stopSave":o==t.data.id&&n.stopSaveCallBack&&n.stopSaveCallBack(t.data);break;case"fullScreen":o==t.data.id&&n.fullScreenCallBack&&n.fullScreenCallBack(t.data);break;case"getOSDTime":o==t.data.id&&n.getOSDTimeCallBack&&n.getOSDTimeCallBack(t.data);break;case"handleSuccess":o==t.data.id&&n.handleSuccess&&n.handleSuccess(t.data);break;case"handleError":o==t.data.id&&n.handleError&&n.handleError(t.data);break;case"dblclick":o==t.data.id&&i.opt.bSupporDoubleClickFull&&(0===i.opt.fullScreenStatus?i.fullScreen():i.cancelFullScreen());break;case"startTalk":i.startTalk(),i.closeSound();break;case"stopTalk":i.stopTalk(),i.openSound();break;case"clickEventHandle":console.log("event.data",t.data),n.clickEventHandle&&n.clickEventHandle(t.data);break;case"removeEventHandle":n.removeEventHandle&&n.removeEventHandle(t.data);break;case"esc":n.clickEventHandle&&n.clickEventHandle(t.data);break;case"iframeFullScreen":if(o==t.data.id){!function(t){var n=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(n)n.call(t);else if(void 0!==e.ActiveXObject){var i=new ActiveXObject("WScript.Shell");null!==i&&i.SendKeys("{F11}")}}(document.getElementById("EZUIKitPlayer-"+t.data.id))}}})),void 0!==document.fullScreen?document.addEventListener("fullscreenchange",(function(){f(document.fullscreen||!1)})):void 0!==document.webkitIsFullScreen?document.addEventListener("webkitfullscreenchange",(function(){f(document.webkitIsFullScreen||!1)})):void 0!==document.mozFullScreen&&document.addEventListener("mozfullscreenchange",(function(){f(document.mozFullScreen||!1)}))};return l.prototype.play=function(n){var i="EZUIKitPlayer-"+this.opt.id,o=document.getElementById(i).contentWindow;"object"===t(n)&&n.url&&(this.opt.url=n.url),"object"===t(n)&&n.accessToken&&(this.opt.accessToken=n.accessToken),"string"==typeof n&&(this.opt.url=n),o.postMessage({action:"play",accessToken:this.opt.accessToken,url:this.opt.url},s+"/ezopen/h5/iframe");var r=this;return this.opt.videoLoading=!0,new Promise((function(t,n){e.addEventListener("message",(function(e){r.opt.id==e.data.id&&"handleSuccess"===e.data.type&&(setTimeout((function(){r.opt.videoLoading=!1}),1e3),t(e.data))}))}))},l.prototype.stop=function(){var t="EZUIKitPlayer-"+this.opt.id;document.getElementById(t).contentWindow.postMessage("stop",s+"/ezopen/h5/iframe");var n=this;return new Promise((function(t,i){e.addEventListener("message",(function(e){n.opt.id==e.data.id&&"stop"===e.data.type&&t(e.data)}))}))},l.prototype.openSound=function(){var t="EZUIKitPlayer-"+this.opt.id;document.getElementById(t).contentWindow.postMessage("openSound",s+"/ezopen/h5/iframe");var n=this;return new Promise((function(t,i){e.addEventListener("message",(function(e){n.opt.id==e.data.id&&"openSound"===e.data.type&&t(e.data)}))}))},l.prototype.closeSound=function(){var t="EZUIKitPlayer-"+this.opt.id;document.getElementById(t).contentWindow.postMessage("closeSound",s+"/ezopen/h5/iframe");var n=this;return new Promise((function(t,i){e.addEventListener("message",(function(e){n.opt.id==e.data.id&&"closeSound"===e.data.type&&t(e.data)}))}))},l.prototype.startSave=function(t){var n="EZUIKitPlayer-"+this.opt.id;document.getElementById(n).contentWindow.postMessage({action:"startSave",fileName:t||"default"},s+"/ezopen/h5/iframe");var i=this;return new Promise((function(t,n){e.addEventListener("message",(function(e){i.opt.id==e.data.id&&"startSave"===e.data.type&&t(e.data)}))}))},l.prototype.stopSave=function(){var t="EZUIKitPlayer-"+this.opt.id;document.getElementById(t).contentWindow.postMessage("stopSave",s+"/ezopen/h5/iframe");var n=this;return new Promise((function(t,i){e.addEventListener("message",(function(e){n.opt.id==e.data.id&&"stopSave"===e.data.type&&t(e.data)}))}))},l.prototype.fullScreen=function(){if(1===this.opt.fullScreenStatus)return!1;var t="EZUIKitPlayer-"+this.opt.id,n=document.getElementById(t).contentWindow;if(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)){var i=document.documentElement.clientWidth,o=document.documentElement.clientHeight,r=(document.body,"");r+="width:"+o+"px;",r+="height:"+i+"px;",r+="-webkit-transform: rotate(90deg); transform: rotate(90deg);",r+="-webkit-transform-origin: "+i/2+"px "+i/2+"px;",r+="transform-origin: "+i/2+"px "+i/2+"px;",r+="position: fixed;top: 0;left: 0;z-index:10",document.getElementById(t).style.cssText=r,setTimeout((function(){n.postMessage("autoResize",s+"/ezopen/h5/iframe")}),500)}else{!function(t){var n=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(n)n.call(t);else if(void 0!==e.ActiveXObject){var i=new ActiveXObject("WScript.Shell");null!==i&&i.SendKeys("{F11}")}}(document.getElementById(t))}this.params.fullScreenCallBack&&this.params.fullScreenCallBack(this.opt.id),this.opt.fullScreenStatus=1},l.prototype.cancelFullScreen=function(){if(0===this.opt.fullScreenStatus)return!1;var e="EZUIKitPlayer-"+this.opt.id,t=document.getElementById(e).contentWindow;if(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)){var n=document.getElementById(e).width,i=document.getElementById(e).height,o=(document.body,"");o+="width:"+n+"px;",o+="height:"+i+"px;",o+="-webkit-transform: none; transform: none;",o+="-webkit-transform-origin: 0 0;",o+="transform-origin: 0 0;",document.getElementById(e).style.cssText=o,setTimeout((function(){t.postMessage("autoResize",s+"/ezopen/h5/iframe")}),500);var r=e+"cancel-full-screen",a=document.getElementById(r);a&&document.body.removeChild(a)}else document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen();this.params.cancelFullScreenCallBack&&this.params.cancelFullScreenCallBack(this.opt.id),this.opt.fullScreenStatus=0},l.prototype.capturePicture=function(t,n){var i="EZUIKitPlayer-"+this.opt.id;document.getElementById(i).contentWindow.postMessage({action:"capturePicture",fileName:t||"default",isUndownload:n},s+"/ezopen/h5/iframe");var o=this;return new Promise((function(t,n){e.addEventListener("message",(function(e){o.opt.id==e.data.id&&"capturePicture"===e.data.type&&t(e.data)}))}))},l.prototype.enableZoom=function(){var e="EZUIKitPlayer-"+this.opt.id;document.getElementById(e).contentWindow.postMessage("enableZoom",s+"/ezopen/h5/iframe")},l.prototype.closeZoom=function(){var e="EZUIKitPlayer-"+this.opt.id;document.getElementById(e).contentWindow.postMessage("closeZoom",s+"/ezopen/h5/iframe")},l.prototype.getOSDTime=function(){var t="EZUIKitPlayer-"+this.opt.id;document.getElementById(t).contentWindow.postMessage("getOSDTime",s+"/ezopen/h5/iframe");var n=this;return new Promise((function(t,i){e.addEventListener("message",(function(e){n.opt.id==e.data.id&&"getOSDTime"===e.data.type&&t(e.data)}))}))},l.prototype.autoResize=function(){var e="EZUIKitPlayer-"+this.opt.id;document.getElementById(e).contentWindow.postMessage("autoResize",s+"/ezopen/h5/iframe")},l.prototype.reSize=function(e,t){var n="EZUIKitPlayer-"+this.opt.id,i=document.getElementById(n).contentWindow,o=document.getElementById(this.opt.id);o.style.width=e+"px",o.style.height=t+"px",document.getElementById(this.opt.id).style.width=e+"px",document.getElementById(this.opt.id).style.height=t+"px";var r=document.getElementById(n);r.setAttribute("width",e),r.setAttribute("height",t),r.style.width=e+"px",r.style.height=t+"px",setTimeout((function(){i.postMessage({action:"autoResize"},s+"/ezopen/h5/iframe")}),500)},l.prototype.startTalk=function(){console.log("执行开始对讲"),console.log(this.opt);var t=this;d.opt=this.opt,e.EZUIKit&&(e.EZUIKit.opt=this.opt);a(t.opt.apiDomain,"POST",{accessToken:t.opt.accessToken,deviceSerial:t.opt.deviceSerial,channelNo:t.opt.channelNo},0,(function(n){if(200==n.code){var i=n.data;if(i){var o=i.rtcUrl;-1===o.indexOf("ws")&&(o=o.replace("https","wss").replace("rtcgw","rtcgw-ws")),t.opt.rtcUrl=o,t.opt.ttsUrl="tts://"+i.ttsUrl;var r="talk://"+t.opt.deviceSerial+":0:"+t.opt.channelNo+":cas.ys7.com:6500";t.opt.talkLink=t.opt.ttsUrl+"/"+r,t.opt.stream=i.stream,e.startTalk()}}}))},l.prototype.stopTalk=function(){console.log("执行结束对讲"),e.stopTalk()},l.prototype.edit=function(){var e="EZUIKitPlayer-"+this.opt.id;document.getElementById(e).contentWindow.postMessage("edit",s+"/ezopen/h5/iframe")},l.prototype.btnReRender=function(e){var t="EZUIKitPlayer-"+this.opt.id;document.getElementById(t).contentWindow.postMessage({action:"btnReRender",data:e},s+"/ezopen/h5/iframe")},l.prototype.changePlayUrl=function(e){e.deviceSerial&&(this.opt.deviceSerial=e.deviceSerial),e.channelNo&&(this.opt.channelNo=e.channelNo),e.accessToken&&(this.opt.accessToken=e.accessToken);var t="EZUIKitPlayer-"+this.opt.id;document.getElementById(t).contentWindow.postMessage({action:"changePlayUrl",data:e},s+"/ezopen/h5/iframe")},l.prototype.fetchThemeData=function(){var e="EZUIKitPlayer-"+this.opt.id;document.getElementById(e).contentWindow.postMessage({action:"fetchThemeData"},s+"/ezopen/h5/iframe")},l.prototype.setThemeData=function(e,t,n){var i="EZUIKitPlayer-"+this.opt.id;document.getElementById(i).contentWindow.postMessage({action:"setThemeData",data:{accessToken:e,header:t,footer:n}},s+"/ezopen/h5/iframe")},d.EZUIKitPlayer=l,e.EZUIKitV3=d,d}));var oe=EZUIKitV3,re=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var ae,de=(ae=void 0,function(e){return e&&(ae=e),ae});!function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),de())return de();if(void 0!==e.unique)return e.unique;e.unique=this,this.oAudioContext=null,this.currentVolume=80,this.bSetVolume=!1,this.gainNode=null,this.iWndNum=-1,this.mVolumes=new Map;var t=window.AudioContext||window.webkitAudioContext;this.oAudioContext=new t,this.writeString=function(e,t,n){for(var i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))},this.setBufferToDataview=function(e,t,n){for(var i=0;i<n.length;i++,t++)e.setUint8(t,n[i])},de(this)}re(e,[{key:"Play",value:function(e,t,n){var i=new ArrayBuffer(44+t),o=new DataView(i),r=n.samplesPerSec,a=n.channels,d=n.bitsPerSample;this.writeString(o,0,"RIFF"),o.setUint32(4,32+2*t,!0),this.writeString(o,8,"WAVE"),this.writeString(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,a,!0),o.setUint32(24,r,!0),o.setUint32(28,2*r,!0),o.setUint16(32,a*d/8,!0),o.setUint16(34,d,!0),this.writeString(o,36,"data"),o.setUint32(40,t,!0),this.setBufferToDataview(o,44,e);var s=this;return this.oAudioContext.decodeAudioData(o.buffer,(function(e){var t=s.oAudioContext.createBufferSource();if(null==t)return-1;t.buffer=e,t.start(0),(null==s.gainNode||s.bSetVolume)&&(s.gainNode=s.oAudioContext.createGain(),s.bSetVolume=!1),s.gainNode.gain.value=s.currentVolume/100,s.gainNode.connect(s.oAudioContext.destination),t.connect(s.gainNode)}),(function(e){return console.log("decode error"),-1})),0}},{key:"Stop",value:function(){return null!=this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),!0}},{key:"SetVolume",value:function(e){return this.bSetVolume=!0,this.currentVolume=e,this.mVolumes.set(this.iWndNum,this.currentVolume),!0}},{key:"SetWndNum",value:function(e){this.iWndNum=e;var t=this.mVolumes.get(e);return null==t&&(t=80),this.currentVolume=t,!0}},{key:"GetVolume",value:function(){var e=this.mVolumes.get(this.iWndNum);return null==e&&(e=80),e}}]),window.AudioRenderer=e}();var se=["attribute vec4 vertexPos;","attribute vec2 texturePos;","varying vec2 textureCoord;","void main()","{","gl_Position = vertexPos;","textureCoord = texturePos;","}"].join("\n"),ce=["precision highp float;","varying highp vec2 textureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","const mat4 YUV2RGB = mat4","(","1.1643828125, 0, 1.59602734375, -.87078515625,","1.1643828125, -.39176171875, -.81296875, .52959375,","1.1643828125, 2.017234375, 0, -1.081390625,","0, 0, 0, 1",");","void main(void) {","highp float y = texture2D(ySampler,  textureCoord).r;","highp float u = texture2D(uSampler,  textureCoord).r;","highp float v = texture2D(vSampler,  textureCoord).r;","gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n");window.SuperRender=function(){function e(e){this.canvasElement=document.getElementById(e),this.initContextGL(),this.contextGL&&(this.YUVProgram=this.initProgram(se,ce),this.initBuffers(),this.initTextures())}return e.prototype.initContextGL=function(){var e=this.canvasElement,t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(e){t=null}t&&"function"==typeof t.getParameter||(t=null),this.contextGL=t,console.log("WebGL1.0")},e.prototype.initProgram=function(e,t){var n=this.contextGL,i=n.createShader(n.VERTEX_SHADER);n.shaderSource(i,e),n.compileShader(i),n.getShaderParameter(i,n.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+n.getShaderInfoLog(i));var o=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(o,t),n.compileShader(o),n.getShaderParameter(o,n.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+n.getShaderInfoLog(o));var r=n.createProgram();return n.attachShader(r,i),n.attachShader(r,o),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||console.log("Program failed to compile: "+n.getProgramInfoLog(r)),n.deleteShader(i),n.deleteShader(o),r},e.prototype.initBuffers=function(){var e=this.contextGL,t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.vertexPosBuffer=t,this.texturePosBuffer=n},e.prototype.initTexture=function(){var e=this.contextGL,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),t},e.prototype.initTextures=function(){var e=this.contextGL,t=this.YUVProgram;e.useProgram(t);var n=this.initTexture(),i=e.getUniformLocation(t,"ySampler");e.uniform1i(i,0),this.yTextureRef=n;var o=this.initTexture(),r=e.getUniformLocation(t,"uSampler");e.uniform1i(r,1),this.uTextureRef=o;var a=this.initTexture(),d=e.getUniformLocation(t,"vSampler");e.uniform1i(d,2),this.vTextureRef=a,e.useProgram(null)},e.prototype.SR_DisplayFrameData=function(e,t,n,i,o){if(!(e<=0||t<=0)){var r=this.contextGL;if(null==n)return r.clearColor(0,0,0,0),void r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);var a=this.canvasElement;this.nWindowWidth=a.width,this.nWindowHeight=a.height;var d=this.nWindowWidth,s=this.nWindowHeight;r.clearColor(.8,.8,1,1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.viewport(0,0,d,s),this.updateFrameData(e,t,n,i,o);var c=this.YUVProgram;r.useProgram(c);var l=this.vertexPosBuffer;r.bindBuffer(r.ARRAY_BUFFER,l);var u=r.getAttribLocation(c,"vertexPos");r.enableVertexAttribArray(u),r.vertexAttribPointer(u,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,null);var p=this.texturePosBuffer;r.bindBuffer(r.ARRAY_BUFFER,p);var m=r.getAttribLocation(c,"texturePos");r.enableVertexAttribArray(m),r.vertexAttribPointer(m,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,null),r.drawArrays(r.TRIANGLE_STRIP,0,4),r.disableVertexAttribArray(u),r.disableVertexAttribArray(m),r.useProgram(null)}},e.prototype.updateFrameData=function(e,t,n,i,o){var r=this.contextGL,a=this.yTextureRef,d=this.uTextureRef,s=this.vTextureRef,c=n;if(e==i&&t==o){var l=e*t,u=c.subarray(0,l);r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,e,t,0,r.LUMINANCE,r.UNSIGNED_BYTE,u);var p=e/2*t/2,m=c.subarray(e*t,e*t+p);r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,e/2,t/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,m);var h=p,f=c.subarray(e*t+e*t/4,e*t+e*t/4+h);r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,d),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,e/2,t/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,f)}else{l=i*o,u=new Uint8Array(l);for(var v=0;v<o;v++)for(var g=c.subarray(v*e,v*e+i),y=0;y<i;y++)u[v*i+y]=g[y];for(r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i,o,0,r.LUMINANCE,r.UNSIGNED_BYTE,u),u=null,g=null,p=i/2*o/2,m=new Uint8Array(p),v=0;v<o/2;v++){var C=c.subarray(e*t+v*e/2,e*t+v*e/2+i/2);for(y=0;y<i/2;y++)m[v*i/2+y]=C[y]}for(r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i/2,o/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,m),m=null,C=null,h=p,f=new Uint8Array(h),v=0;v<o/2;v++){var S=c.subarray(e*t*5/4+v*e/2,e*t*5/4+v*e/2+i/2);for(y=0;y<i/2;y++)f[v*i/2+y]=S[y]}r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,d),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i/2,o/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,f),f=null,S=null}},e.prototype.SR_SetDisplayRect=function(e){var t=this.contextGL,n=this.nWindowWidth,i=this.nWindowHeight,o=null;if(e&&n>0&&i>0){var r=e.left/n,a=e.top/i,d=e.right/n,s=e.bottom/i;o=new Float32Array([d,a,r,a,d,s,r,s])}else o=new Float32Array([1,0,0,0,1,1,0,1]);var c=this.texturePosBuffer;t.bindBuffer(t.ARRAY_BUFFER,c),t.bufferSubData(t.ARRAY_BUFFER,0,o),t.bindBuffer(t.ARRAY_BUFFER,null)},e.prototype.SR_Destroy=function(){var e=this.contextGL,t=this.YUVProgram;e.deleteProgram(t);var n=this.vertexPosBuffer,i=this.texturePosBuffer;e.deleteBuffer(n),e.deleteBuffer(i);var o=this.yTextureRef,r=this.uTextureRef,a=this.vTextureRef;e.deleteTexture(o),e.deleteTexture(r),e.deleteTexture(a)},e}();var le=function(e,t){if(void 0===e)return t.themeData?{templateType:"themeData",templateId:"themeData"}:{templateType:"local",templateId:""};if("string"==typeof e){if(32===e.length)return{templateType:"remote",templateId:e};if(-1!==["theme","standard"].indexOf(e))return"simple"===e&&void 0===t.header&&void 0===t.footer?{templateType:"local",templateId:""}:{templateType:"iframe",templateId:e};if(-1!==["pcLive","pcRec","mobileLive","mobileRec","noData","security","voice","simple"].indexOf(e))return{templateType:"local",templateId:e}}},ue=function(){var e=window.navigator.userAgent.toLowerCase(),t=(/version.*safari/.test(e),/chrome/.test(e));/gecko/.test(e)&&/webkit/.test(e);if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return!1;if(t){return function(){for(var e=window.navigator.userAgent.split(" "),t="",n=0;n<e.length;n++)/chrome/i.test(e[n])&&(t=e[n]);return!!t&&Number(t.split("/")[1].split(".")[0])}()>91&&!!window.SharedArrayBuffer}return!1},pe=function(){function e(t){var i=this;n(this,e);var o=t.autoplay,r=void 0===o||o;if((t.template&&"simple"!==t.template||t.themeData)&&(r=!1),this.params=t,this.autoplay=r,window.EZUIKit[t.id]={state:{EZUIKitPlayer:{init:window.EZUIKit[t.id]&&window.EZUIKit[t.id].state&&window.EZUIKit[t.id].state.EZUIKitPlayer.init||!1,themeInit:window.EZUIKit[t.id]&&window.EZUIKit[t.id].state&&window.EZUIKit[t.id].state.EZUIKitPlayer.themeInit||!1,talkInit:window.EZUIKit[t.id]&&window.EZUIKit[t.id].state&&window.EZUIKit[t.id].state.EZUIKitPlayer.talkInit||!1}}},"iframe"===le(this.params.template,t).templateType)return new oe.EZUIKitPlayer(t);this.Monitor=new ie({env:void 0!==t.disableMonitor&&t.disableMonitor?"test12":"online"},this),this.id=t.id,this.width=t.width,this.height=t.height,this.url=t.url,this.accessToken=t.accessToken,this.themeId=le(t.template,t).templateId,this.id=t.id,this.audio=!0,this.poster=t.poster,this.speed=1,this.disabledTimeLine=!1,this.disabledPTZ=!1,this.enableSharedArrayBufferGuide=!1,this.capacity={},this.env={domain:"https://open.ys7.com"};var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);this.isMobile=a,document.getElementById("".concat(this.id,"-wrap"))&&(document.getElementById("".concat(this.id,"-wrap")).innerHTML="",document.getElementById("".concat(this.id,"-wrap")).id=this.id),this.staticPath=ue()?"https://open.ys7.com/console/ezuikit_static/v6/v2":"https://open.ys7.com/console/ezuikit_static/v6/v1","string"==typeof t.staticPath&&(t.staticPath.startsWith("http")?this.staticPath=t.staticPath:this.staticPath=window.location.protocol+"//"+window.location.host+t.staticPath,ue()?this.staticPath+="/v2":this.staticPath+="/v1"),void 0!==t.audio&&(this.audio=t.audio),void 0!==t.env&&(this.env=Object.assign(this.env,t.env)),void 0!==t.isMobile&&(this.isMobile=t.isMobile),void 0!==t.disabledTimeLine&&(this.disabledTimeLine=t.disabledTimeLine),void 0!==t.disabledPTZ&&(this.disabledPTZ=t.disabledPTZ),void 0!==t.enableSharedArrayBufferGuide&&(this.enableSharedArrayBufferGuide=t.enableSharedArrayBufferGuide);var s="".concat(this.staticPath,"/js/jsPluginV1-1.0.0.min.js");if(ue())console.log("启用多线程解析视频"),s="".concat(this.staticPath,"/js/jsPluginV2-2.0.1.min.js");else{if(!a&&91<function(){for(var e=navigator.userAgent.split(" "),t="",n=0;n<e.length;n++)/chrome/i.test(e[n])&&(t=e[n]);return!!t&&Number(t.split("/")[1].split(".")[0])}<106&&this.enableSharedArrayBufferGuide){console.log("提示用户开启谷歌实验室特性");var c="".concat(this.id,"-wrap"),l=document.createElement("div"),u=document.createElement("span");u.innerHTML="您当前浏览器可以开启谷歌实验室多线程特性，获取更好播放体验，避免浏览器卡顿及崩溃,详见",l.appendChild(u);var p=document.createElement("a");p.href="https://open.ys7.com/help/384",p.setAttribute("target","_blank"),l.appendChild(p),p.innerHTML="开启说明",l.id="".concat(this.id,"-guide"),l.style="font-size:12px;color:red;",setTimeout((function(){document.getElementById(c)&&document.getElementById(c).insertBefore(l,document.getElementById(i.id))}),5e3)}}this.pluginStatus=new T(this,this.id),d(s,(function(){if(i.autoplay){i.initTime=(new Date).getTime(),i.Monitor.dclog({url:i.url,action:0,text:"startInit"}),i.Monitor.localInfoLog({Serial:f(i.url).deviceSerial,Channel:f(i.url).channelNo,Ver:ue()?"v7.0.0":"v6.0.0",ExterVer:ue()?"v7.0.0":"v6.0.0"});var e=i.initEZUIKitPlayer(t),n=i._getRealUrlPromise(t.accessToken,t.url);Promise.all([e,n]).then((function(e){e[1]?(i.playStartTime=(new Date).getTime(),i._pluginPlay(e[1],(function(){console.log("自动播放成功"),i.Monitor.dclog({url:i.url,action:202,d:(new Date).getTime()-i.initTime,text:"autoPlaySuccess"})}),(function(){console.log("自动播放失败"),i.Monitor.dclog({url:i.url,action:402,d:(new Date).getTime()-i.initTime,text:"autoPlayError"})}))):console.log("promise of one",e),window.EZUIKit[t.id].state.EZUIKitPlayer.init=!0,document.getElementById("".concat(t.id,"canvas_draw0"))&&(document.getElementById("".concat(t.id,"canvas_draw0")).style.border="none")})).catch((function(e){console.log("err",e),i.pluginStatus.loadingSetText({text:e&&e.msg||"获取播放地址失败",color:"red"})}))}else{i.initTime=(new Date).getTime(),i.Monitor.dclog({url:i.url,action:0,text:"startInit"}),i.Monitor.localInfoLog({Serial:f(i.url).deviceSerial,Channel:f(i.url).channelNo,Ver:ue()?"v7.0.0":"v6.0.0"}),(e=i.initEZUIKitPlayer(t)).then((function(e){console.log("初始化成功",e),window.EZUIKit[t.id].state.EZUIKitPlayer.init=!0,document.getElementById("".concat(t.id,"canvas_draw0"))&&(document.getElementById("".concat(t.id,"canvas_draw0")).style.border="none"),i.Monitor.dclog({url:i.url,action:201,d:(new Date).getTime()-i.initTime,text:"initSuccess"})}))}}),(function(){return ue()?!!window.JSPluginV2:!!window.JSPluginV1})),t.plugin&&-1!==t.plugin.indexOf("talk")&&(this.Talk=new N(this),window.EZUIKit[t.id].state.EZUIKitPlayer.talkInit=!0),this.getDeviceCapacity()}return o(e,[{key:"initEZUIKitPlayer",value:function(e){var t=this,n=e.id,i=e.width,o=void 0===i?600:i,r=e.height,a=void 0===r?400:r;if(!e.width||!e.height){var d=document.getElementById(n).getBoundingClientRect();!e.width&&d.width>0&&(o=d.width),!e.height&&d.height>0&&(a=d.height)}if(!document.getElementById("".concat(n,"-wrap"))){var s=document.createElement("div");s.id="".concat(n,"-wrap"),s.style="display:inline-block;width:".concat(o,"px;position:relative;vertical-align: bottom;"),document.getElementById(n).parentNode.insertBefore(s,document.getElementById(n)),document.getElementById(n).parentNode.removeChild(document.getElementById(n)),s.innerHTML="<div id=".concat(n,"></div>"),document.getElementById(n).style="display:inline-block;width:".concat(o,"px;height:").concat(a,"px;"),document.getElementById(n).style.verticalAlign="top"}this.themeId&&(this.Theme=new ne(this,e.id),window.EZUIKit[e.id].state.EZUIKitPlayer.themeInit=!0,this.Monitor.dclog({url:this.url,action:2,text:this.themeId}),"function"==typeof this.params.handleThemeChange&&(this.handleThemeChange=this.params.handleThemeChange));var c=new b(this,n);this.Message=c;return new Promise((function(i,r){var d;if(ue()){d=new window.JSPluginV2({szId:n,iType:2,iWidth:o,iHeight:a,iMaxSplit:1,iCurrentSplit:1,szBasePath:"",staticPath:t.staticPath,oStyle:{border:"none",background:"#000000"}}),t.pluginStatus.loadingStart(n),t.pluginStatus.loadingSetText({text:"初始化播放器完成"}),d.EventCallback={pluginErrorHandler:function(e,n,i){console.log(e,n,i),1003===n&&(console.log("断流"),t.pluginStatus.loadingSetText({text:"连接断开，请重试",color:"red"}),"function"==typeof t.params.handleError&&t.params.handleError({msg:"连接断开，请重试",retcode:1003,id:t.params.id,type:"handleError"}))}},t.env={domain:"https://open.ys7.com"},void 0!==e.env&&(t.env=Object.assign(t.env,e.env)),void 0!==e.handleTalkSuccess&&(t.handleTalkSuccess=e.handleTalkSuccess),void 0!==e.handleTalkError&&(t.handleTalkError=e.handleTalkError),t.errorHander=new P,t.jSPlugin=d;var s=setInterval((function(){t.jSPlugin.Module&&t.jSPlugin.Module._JSPlayM4_GetSDKVersion&&t.jSPlugin.Module._JSPlayM4_GetSDKVersion()&&(clearInterval(s),"function"==typeof t.params.handleInitSuccess&&t.params.handleInitSuccess({retcode:0,id:t.params.id,type:"handleInitSuccess"}),i({meta:{retcode:200,msg:"初始化成功"}}))}),50)}else d=new window.JSPluginV1({szId:n,iType:2,iWidth:o,iHeight:a,iMaxSplit:1,iCurrentSplit:1,szBasePath:"",staticPath:t.staticPath,oStyle:{border:"none",background:"#000000"}}),t.pluginStatus.loadingStart(n),t.pluginStatus.loadingSetText({text:"初始化播放器完成"}),d.EventCallback={loadEventHandler:function(){},zoomEventResponse:function(){},windowEventSelect:function(e){},pluginErrorHandler:function(e,n,i){console.log(e,n,i),1003===n&&(console.log("断流"),t.pluginStatus.loadingSetText({text:"连接断开，请重试",color:"red"}),"function"==typeof t.params.handleError&&t.params.handleError({msg:"连接断开，请重试",retcode:1003,id:t.params.id,type:"handleError"}))},windowEventOver:function(e){},windowEventOut:function(e){},windowEventUp:function(e){},windowFullCcreenChange:function(e){},firstFrameDisplay:function(e,n,i){console.log(n,i),d.JS_SetCanFullScreen(!1),t.pluginStatus.loadingClear()},performanceLack:function(){},mouseEvent:function(e,t,n){}},t.env={domain:"https://open.ys7.com"},void 0!==e.env&&(t.env=Object.assign(t.env,e.env)),void 0!==e.handleTalkSuccess&&(t.handleTalkSuccess=e.handleTalkSuccess),void 0!==e.handleTalkError&&(t.handleTalkError=e.handleTalkError),t.errorHander=new P,t.jSPlugin=d,"function"==typeof t.params.handleInitSuccess&&t.params.handleInitSuccess({retcode:0,id:t.params.id,type:"handleInitSuccess"}),i({meta:{retcode:200,msg:"初始化成功"}})}))}},{key:"_getRealUrlPromise",value:function(e,t){var n=this,i=this.env.domain;this.env&&(i=this.env.domain);return new Promise((function(a,d){return function(a,d){var s="",c=i+"/api/lapp/live/url/ezopen",u=new FormData;u.append("ezopen",t),u.append("isFlv","false"),u.append("userAgent",window.navigator.userAgent),u.append("isHttp","false"),u.append("accessToken",e),fetch(c,{method:"POST",body:u}).then((function(e){return e.json()})).then((function(e){if(200==e.code||0==e.retcode){var c="",u="";e.ext&&e.ext.token?(s+=e.data,u=e.ext.token,c=e.data):e.data&&e.data.token&&(s+=e.data.url,u=e.data.token,c=e.data.url);var p=-1!==t.indexOf("live")?"live":"playback";s="live"===p?s+"&ssn="+u+"&auth=1&biz=4&cln=100":s+"&ssn="+u+"&auth=1&cln=100",console.log(s);var m=l("checkCode",s);if(m&&(void 0!==n.jSPlugin.decoderVersion&&"2.0"===n.jSPlugin.decoderVersion?n.validateCode=m:(console.log("设置密钥",m),n.jSPlugin.JS_SetSecretKey(0,m))),-1!==s.indexOf("playback")){var h=l("begin",c)||l("begin",t),f=l("end",c)||l("end",t);if(h)s=s.replace("&begin="+l("begin",c),"&begin="+o(h,"000000")),l("begin",s)||(s+="&begin="+o(h,"000000"));else{var g=new Date;s=s+"&begin="+g.Format("yyyyMMdd")+"T000000Z"}if(f?(s=s.replace("&end="+l("end",c),"&end="+o(f,"235959")),l("end",s)||(s+="&end="+o(f,"235959"))):s=s+"&end="+o(l("begin",s).substr(0,8),"235959"),l("stream",c)||(s=s.replace("stream","&stream")),-1!==t.indexOf(".cloud")){var y=r(l("begin",s)),C=r(l("end",s)),S=l("serial",s),T=l("chn",s),b=i+"/api/lapp/video/by/time",w={accessToken:n.accessToken,recType:1,deviceSerial:S,channelNo:T,startTime:y,endTime:C,version:"2.0"};v(b,"POST",w,0,(function(e){if(200==e.code){var t=[];if(e.data&&e.data.files&&e.data.files.length>0){var n=e.data.files,i=(new Date).getTime();if(e.data.isAll){t=r(n);var o=JSON.stringify(t).replace("\\","");s+="&recSlice="+o.replace("\\","")+"&r="+Math.random(),a(s)}else{!function e(){w.startTime=i,v(b,"POST",w,0,(function(o){if(o.data&&o.data.files&&o.data.files.length>0)if(0==o.data.isAll)o.data.files&&(n=n.concat(o.data.files)),i=o.data.nextFileTime>0?o.data.nextFileTime:(new Date).getTime(),e();else{t=r(n);var d=JSON.stringify(t).replace("\\","");s+="&recSlice="+d.replace("\\","")+"&r="+Math.random(),a(s)}else{t=r(n);d=JSON.stringify(t).replace("\\","");s+="&recSlice="+d.replace("\\","")+"&r="+Math.random(),a(s)}}))}()}}else d({retcode:-1,msg:"未找到录像片段"})}else d({retcode:-1,msg:"未找到录像片段"});function r(e){var t=[];return e.forEach((function(e,n){0==t.length||e.downloadPath!==t[t.length-1].downloadPath?t.push({downloadPath:e.downloadPath,ownerId:e.ownerId,iStorageVersion:e.iStorageVersion,videoType:e.videoType,iPlaySpeed:0,startTime:e.startTime,endTime:e.endTime}):t[t.length-1].endTime=e.endTime})),t}}))}else if(-1!==t.indexOf("alarmId")){console.log("进入alarmId回放");var P=l("alarmId",s);y=r(l("begin",s)),C=r(l("end",s)),S=l("serial",s),T=l("chn",s),b=i+"/api/lapp/video/by/id",w={accessToken:n.accessToken,deviceSerial:S,channelNo:T,alarmId:P};v(b,"POST",w,0,(function(e){if(200==e.code){var t=[];if(e.data){t=function(e){var t=[];return e.forEach((function(e,n){0==t.length||e.downloadPath!==t[t.length-1].downloadPath?t.push({downloadPath:e.downloadPath,ownerId:e.ownerId,iStorageVersion:e.iStorageVersion,videoType:e.videoType,iPlaySpeed:0,startTime:e.startTime,endTime:e.endTime}):t[t.length-1].endTime=e.endTime})),console.log("downloadPathArr",t),t}([e.data]);var n=JSON.stringify(t).replace("\\","");s+="&recSlice="+n.replace("\\",""),console.log("realUrl",s,e.data.recType),s=1==e.data.recType?s.replace("/playback","/cloudplayback"):s.replace("/cloudplayback","/playback"),a(s)}}}))}else a(s)}else a(s)}else n.pluginStatus.loadingSetText({text:e.msg,color:"red"}),"function"==typeof n.params.handleError&&n.params.handleError({retcode:e.code,msg:e.msg,id:n.params.id,type:"handleError"}),d(e)}))}(a,d)}));function o(e,t){if(/^[0-9]{8}T[0-9]{6}Z$/.test(e))return e;if(/[0-9]{8,14}/.test(e)){var n=6-(14-e.length),i=t.length,o=e+t.substring(n,i);return o.slice(0,8)+"T"+o.slice(8)+"Z"}throw new Error("回放时间格式有误，请确认")}function r(e){var t=e.slice(0,4),n=e.slice(4,6),i=e.slice(6,8),o=e.slice(9,11),r=e.slice(11,13),a=e.slice(13,15);return new Date((t+"-"+n+"-"+i+" "+o+":"+r+":"+a).replace(/-/g,"/")).getTime()}}},{key:"_pluginPlay",value:function(e,t,n){var i=this;if(console.log("get real url result ===",e),!e)return!1;function o(e){var t=e.split("?")[0].replace("/live","").replace("/playback",""),n=(-1===e.indexOf("/live")?-1!==e.indexOf("cloudplayback")?"/cloudplayback?":"/playback?":"/live?")+e.split("?")[1];return-1!==n.indexOf("/playback")&&(n=n.replace("stream=2","stream=1")),{websocketConnectUrl:t,websocketStreamingParam:n}}var r=o(e).websocketConnectUrl;this.env&&this.env.wsUrl&&(r=this.env.wsUrl);var a={playURL:o(e).websocketStreamingParam};this.jSPlugin.JS_Play(r,a,0).then((function(){if(console.log("播放成功"),i.validateCode&&void 0!==i.jSPlugin.decoderVersion&&"2.0"===i.jSPlugin.decoderVersion&&i.jSPlugin.JS_SetSecretKey(0,i.validateCode),i.pluginStatus.loadingClear(),i.pluginStatus.setPlayStatus({play:!0,loading:!1}),i.Theme){i.Theme.setDecoderState({play:!0});var e=S.findIndex(i.Theme.themeData.footer.btnList,(function(e){return"sound"===e.iconId&&1===e.isrender&&1===e.defaultActive}))>-1;i.audio=e}i.audio&&setTimeout((function(){i.openSound()}),500),"function"==typeof i.params.handleSuccess&&i.params.handleSuccess({retcode:0,id:i.params.id,type:"handleSuccess"}),t(),i.Monitor.dclog({url:i.url,action:211,d:(new Date).getTime()-i.playStartTime,text:"startPlaySuccess"}),i.Monitor.playLog({Enc:-1===i.url.indexOf("@")?0:1,PlTp:-1===i.url.indexOf("back")?1:2,Via:2,ErrCd:0,Cost:(new Date).getTime()-i.playStartTime,Serial:f(i.url).deviceSerial,Channel:f(i.url).channelNo,Ver:ue()?"v7.0.0":"v6.0.0"})}),(function(e){console.log("err",e);var t="播放失败，请检查设备及客户端网络",o=-1;if(e&&e.oError&&e.oError.errorCode){var r=i.errorHander.matchErrorInfo(e.oError.errorCode);t=r&&r.description?r.description:"播放失败，请检查设备及客户端网络",o=e.oError.errorCode}i.pluginStatus.loadingSetText({text:t,color:"red"}),"function"==typeof i.params.handleError&&i.params.handleError({retcode:o,msg:t,id:i.params.id,type:"handleError"}),n(),i.Monitor.dclog({url:i.url,action:411,d:(new Date).getTime()-i.playStartTime,text:"startPlayError"}),i.Monitor.playLog({Enc:-1===i.url.indexOf("@")?0:1,PlTp:-1===i.url.indexOf("back")?1:2,Via:2,ErrCd:o,Cost:-1,Serial:f(i.url).deviceSerial,Channel:f(i.url).channelNo,Ver:ue()?"v7.0.0":"v6.0.0"})}))}},{key:"play",value:function(e){var t=this;return!this.jSPlugin.bPlay&&(this.pluginStatus.setPlayStatus({play:!1,loading:!0}),this.playStartTime=(new Date).getTime(),this.Monitor.dclog({url:this.url,action:1,d:(new Date).getTime()-this.initTime,text:"startPlay"}),e&&("string"==typeof e.url&&(this.url=e.url),"string"==typeof e.accessToken&&(this.accessToken=e.accessToken),!this.Theme||"string"!=typeof e.url&&"string"!=typeof e.accessToken||this.Theme.getDeviceInfo()),new Promise((function(e,n){t._getRealUrlPromise(t.accessToken,t.url).then((function(i){t._pluginPlay(i,(function(){return e(!0)}),(function(){return n(!1)}))})).catch((function(e){var i=e.msg?e.msg:"播放失败，请检查设备及客户端网络";t.pluginStatus.loadingSetText({text:i,color:"red"}),"function"==typeof t.params.handleError&&t.params.handleError({retcode:e.oError?e.oError.errorCode:-1,msg:i,id:t.params.id,type:"handleError"}),n(!1)}))})))}},{key:"stop",value:function(){var e=this;return this.jSPlugin.bPlay?(this.pluginStatus.setPlayStatus({loading:!0}),this.jSPlugin.JS_Stop(0).then((function(){console.log("停止成功"),e.pluginStatus.setPlayStatus({play:!1,loading:!1}),e.Theme&&e.Theme.setDecoderState({play:!1})}))):(console.log("当前非播放状态"),new Promise((function(e,t){t({retcode:-1,msg:"当前非播放状态"})})))}},{key:"changeVideoLevel",value:function(e){var t=this,n=this.url,i=e?n.replace(".live",".hd.live"):n.replace(".hd.live",".live");return this.jSPlugin.playURL=e?this.jSPlugin.playURL.replace("stream=2","stream=1"):this.jSPlugin.playURL.replace("stream=1","stream=2"),console.log("changeVideoLevel",i,this.jSPlugin.playURL),this.url=i,new Promise((function(e,n){t.pause().then((function(){console.log("暂停成功"),t.resume().then((function(e){console.log("恢复成功")}))})).catch((function(){console.log("暂停失败"),t.resume().then((function(e){console.log("恢复成功")}))}))}))}},{key:"changePlayUrl",value:function(e){var t=this,n=function(e,t){if(t.url)return t.url;var n=e.split("/")[4].split(".")[e.split("/")[4].split(".").length-1].split("?")[0];"rec"===n&&-1!==e.indexOf(".cloud.rec")&&(n="cloud.rec");t.type&&(n=t.type);var i=e.split("/")[3];t.deviceSerial&&(i=t.deviceSerial);var o=e.split("/")[4].split(".")[0];t.channelNo&&(o=t.channelNo);var r=2===e.split("/")[2].split("@").length?e.split("/")[2].split("@")[0]:"";void 0!==t.validCode&&(r=t.validCode);var a=void 0===t.hd?-1!==e.indexOf(".hd"):t.hd,d="ezopen://".concat(r?"".concat(r,"@"):"","open.ys7.com/").concat(i,"/").concat(o).concat(a?".hd":"",".").concat(n);if("live"===n)return d;d="ezopen://".concat(r?"".concat(r,"@"):"","open.ys7.com/").concat(i,"/").concat(o,".").concat(n),t.begin&&t.end?d+="?begin=".concat(t.begin,"&end=").concat(t.end):t.begin?d+="?begin=".concat(t.begin):l("begin",e)&&(d+="?begin=".concat(l("begin",e)));return d}(this.url,e);return console.log("changePlayUrl",n),this.url=n,new Promise((function(i,o){t.stop().then((function(){if(console.log("changePlayUrl stop success"),t.Theme&&t.Theme.Ptz&&(t.Theme.setDecoderState({pantile:!1}),t.Theme.Ptz.hide()),t.Theme&&t.Theme.setDecoderState({recordvideo:!1}),t.Theme&&(t.Theme.setDecoderState({zoom:!1}),t.Zoom&&t.Zoom.stopZoom()),t.Theme&&t.Theme.decoderState.state.talk&&(t.stopTalk(),t.Theme.setDecoderState({talk:!1})),e.accessToken)return t.accessToken=e.accessToken,t.play({accessToken:e.accessToken,url:n}).then((function(){console.log("changePlayUrl replay success"),t.Theme&&t.Theme.decoderState.state.webExpend&&t.Theme.webExpend(),t.Theme&&t.Theme.decoderState.state.expend&&t.Theme.expend(),i(n)})).catch((function(e){o(n)}));t.play(n).then((function(){console.log("changePlayUrl replay success"),t.Theme&&t.Theme.decoderState.state.webExpend&&t.Theme.webExpend(),t.Theme&&t.Theme.decoderState.state.expend&&t.Theme.expend(),i(n)})).catch((function(e){o(n)}))})).catch((function(r){if(console.log("切换过程停止失败",r),e.accessToken)return t.accessToken=e.accessToken,t.play({accessToken:e.accessToken,url:n}).then((function(){i(n)})).catch((function(e){o(n)}));t.play(n).then((function(){i(n)})).catch((function(e){o(n)}))}))}))}},{key:"getOSDTime",value:function(){var e=this;return new Promise((function(t,n){e.jSPlugin.JS_GetOSDTime(0).then((function(n){t({code:0,retcode:0,data:n}),"function"==typeof e.params.getOSDTimeCallBack&&e.params.getOSDTimeCallBack({id:e.id,type:"getOSDTime",code:0,data:n})})).catch((function(t){n({code:-1,retcode:-1,data:t}),"function"==typeof e.params.getOSDTimeCallBack&&e.params.getOSDTimeCallBack({id:e.id,type:"getOSDTime",code:-1,data:-1})}))}))}},{key:"capturePicture",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.jSPlugin.JS_CapturePicture(0,e,"JPEG",n,!!n);return c(i)?("function"==typeof this.params.capturePictureCallBack&&i.then((function(){t.params.capturePictureCallBack({id:t.id,type:"capturePicture",code:0})})).catch((function(){t.params.capturePictureCallBack({id:t.id,type:"capturePicture",code:-1})})),i):new Promise((function(e){e(i)}))}},{key:"startSave",value:function(e){var t=this,n=this.jSPlugin.JS_StartSave(0,e);return c(n)?("function"==typeof this.params.startSaveCallBack&&n.then((function(){t.params.startSaveCallBack({id:t.id,type:"startSave",code:0})})).catch((function(){t.params.startSaveCallBack({id:t.id,type:"startSave",code:-1})})),n):(this.Theme&&this.Theme.setDecoderState({recordvideo:!0}),new Promise((function(e){e(n)})))}},{key:"stopSave",value:function(){var e=this,t=this.jSPlugin.JS_StopSave(0);return c(t)?("function"==typeof this.params.startSaveCallBack&&t.then((function(){e.params.stopSaveCallBack({id:e.id,type:"stopSave",code:0})})).catch((function(){e.params.stopSaveCallBack({id:e.id,type:"stopSave",code:-1})})),t):(this.Theme&&this.Theme.setDecoderState({recordvideo:!1}),new Promise((function(e){e(t)})))}},{key:"openSound",value:function(){var e=this.jSPlugin.JS_OpenSound(0);return console.log("打开声音",e),c(e)?e:(this.Theme&&this.Theme.setDecoderState({sound:!0}),"function"==typeof this.params.openSoundCallBack&&this.params.openSoundCallBack({id:this.id,type:"openSound",code:e}),new Promise((function(t){t(e)})))}},{key:"closeSound",value:function(){var e=this.jSPlugin.JS_CloseSound(0);return c(e)?e:(this.Theme&&this.Theme.setDecoderState({sound:!1}),"function"==typeof this.params.closeSoundCallBack&&this.params.closeSoundCallBack({id:this.id,type:"closeSound",code:e}),new Promise((function(t){t(e)})))}},{key:"enableZoom",value:function(){var e=this.jSPlugin.JS_EnableZoom(0);return c(e)?e:new Promise((function(t){t(e)}))}},{key:"closeZoom",value:function(){var e=this.jSPlugin.JS_DisableZoom(0);return c(e)?e:new Promise((function(t){t(e)}))}},{key:"setPoster",value:function(e){ue()?document.getElementById("".concat(this.id))&&(document.getElementById("".concat(this.id)).style.backgroundImage="url(".concat(e,")"),document.getElementById("".concat(this.id)).style.backgroundSize="cover"):document.getElementById("".concat(this.id,"canvas0"))&&(document.getElementById("".concat(this.id,"canvas0")).style.backgroundImage="url(".concat(e,")"),document.getElementById("".concat(this.id,"canvas0")).style.backgroundSize="cover")}},{key:"reSize",value:function(e,t){var n=0,i=0;if(this.params.height=t,this.params.width=e,this.Theme&&this.Theme.isNeedRenderHeader&&document.getElementById("".concat(this.id,"-headControl"))&&(n=parseInt(document.getElementById("".concat(this.id,"-headControl")).style.height,10)),this.Theme&&this.Theme.isNeedRenderTimeLine&&!this.isMobile&&(i=48),t=t-n-i,this.width=e,this.height=t,document.getElementById("".concat(this.id,"-wrap")).style="width:".concat(e,"px;position:relative;display:inline-block;vertical-align: bottom;"),document.getElementById("".concat(this.id)).style.width=e+"px",document.getElementById("".concat(this.id)).style.height=t+"px",this.jSPlugin&&this.jSPlugin.bPlay)this.jSPlugin&&(this.jSPlugin.iHeight=t,this.jSPlugin.iWidth=e),this.jSPlugin.JS_Resize(e,t);else{document.getElementById("".concat(this.id,"-player"))&&(document.getElementById("".concat(this.id,"-player")).style.width=e,document.getElementById("".concat(this.id,"-player")).style.height=t);var o=1;if(document.getElementById("".concat(this.id,"canvas0")))navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)&&(o=2),document.getElementById("".concat(this.id,"canvas0")).style.width=e*o,document.getElementById("".concat(this.id,"canvas0")).style.height=t*o,document.getElementById("".concat(this.id,"canvas0")).width=e*o,document.getElementById("".concat(this.id,"canvas0")).height=t*o,document.getElementById("".concat(this.id,"canvas0")).parentNode.style.width=e*o,document.getElementById("".concat(this.id,"canvas0")).parentNode.style.height=t*o,document.getElementById("".concat(this.id,"canvas_draw0")).height=t*o;this.jSPlugin&&(this.jSPlugin.iHeight=t*o,this.jSPlugin.iWidth=e*o)}}},{key:"fast",value:function(e){var t=this,n=this.speed;if(e)var i=this.jSPlugin.JS_Fast(0,e);else{if(1===n)n=2;else{if(2!==n)return"function"==typeof this.params.handleError&&this.params.handleError({msg:"播放速度最大为4倍速度",retcode:1003,id:this.id,type:"handleError"}),new Promise((function(e,i){t.speed=n,i({code:-1,data:{speed:n,result:"播放速度最大为4倍速度"}})}));n=4}i=this.jSPlugin.JS_Fast(0)}return new Promise((function(e){t.speed=n,e({code:0,data:{speed:n,result:i}})}))}},{key:"slow",value:function(){var e=this,t=this.speed;if(4===t)t=2;else{if(2!==t)return"function"==typeof this.params.handleError&&this.params.handleError({msg:"播放速度最小为1倍速度",retcode:1003,id:this.id,type:"handleError"}),new Promise((function(n,i){e.speed=t,i({code:-1,data:{speed:t,result:"播放速度最小为1倍速度"}})}));t=1}var n=this.jSPlugin.JS_Slow(0);return new Promise((function(i){e.speed=t,i({code:0,data:{speed:t,result:n}})}))}},{key:"seek",value:function(e,t){var n=this.url,i=(l("begin",n)||(new Date).Format("yyyyMMdd")).substr(0,8);if(t=o(i,"235959"),6===e.length)e=o(i,e);else{if(16!==e.length)return"function"==typeof this.params.handleError&&this.params.handleError({msg:"seek时间格式错误",retcode:-1,id:this.id,type:"handleError"}),!1;if(e.substr(0,8)!==i)return"function"==typeof this.params.handleError&&this.params.handleError({msg:"seek时间不能跨日期",retcode:-1,id:this.id,type:"handleError"}),!1}function o(e,t){if(/^[0-9]{8}T[0-9]{6}Z$/.test(e))return e;if(/[0-9]{8,14}/.test(e)){var n=6-(14-e.length),i=t.length,o=e+t.substring(n,i);return o.slice(0,8)+"T"+o.slice(8)+"Z"}throw new Error("回放时间格式有误，请确认")}var r=this.jSPlugin.JS_Seek(0,e,t);return console.log("seekRT",r),c(r)?r:new Promise((function(e){e(r)}))}},{key:"fullScreen",value:function(){var e=this;m(document.getElementById("".concat(this.id))).then((function(t){console.log("全屏promise",window.screen.availWidth),e.jSPlugin.JS_Resize(window.screen.availWidth,window.screen.availHeight),"function"==typeof e.params.fullScreenCallBack&&e.params.fullScreenCallBack({id:e.id,type:"fullScreen",code:0})}));["fullscreenchange","webkitfullscreenchange","mozfullscreenchange"].forEach((function(t){window.addEventListener(t,(function(t){return(n=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen)||e.jSPlugin.JS_Resize(e.width,e.height),void("function"==typeof e.params.fullScreenChangeCallBack&&e.params.fullScreenChangeCallBack({id:e.id,type:"fullScreen",code:n}));var n}))}))}},{key:"cancelFullScreen",value:function(){var e=this;h().then((function(t){console.log("取消全屏",t,e.jSPlugin),e.jSPlugin.JS_Resize(e.width,e.height)}))}},{key:"startTalk",value:function(){this.Talk.startTalk()}},{key:"stopTalk",value:function(){this.Talk.stopTalk()}},{key:"destroy",value:function(){var e=this.jSPlugin.JS_DestroyWorker(0);return this.Theme&&(this.Theme=null,window.EZUIKit[this.params.id].state.EZUIKitPlayer.themeInit=!1),c(e)?e:new Promise((function(t){t(e)}))}},{key:"getDeviceCapacity",value:function(){var e=this,t=this.env.domain;this.env&&(t=this.env.domain);var n=t+"/api/lapp/device/capacity",i={accessToken:this.accessToken,deviceSerial:f(this.url).deviceSerial};v(n,"POST",i,0,(function(t){200==t.code&&t.data&&(e.capacity=t.data)}))}},{key:"pause",value:function(){return this.jSPlugin.JS_Pause(0)}},{key:"resume",value:function(e){return this.jSPlugin.JS_Resume(e)}}]),e}();!function(e,n){"object"===("undefined"==typeof module?"undefined":t(module))&&"object"===t(module.exports)?module.exports=e.document?n(e,!0):function(e){if(!e.document)throw new Error("EZUIPlayer requires a window with a document");return n(e)}:n(e)}("undefined"!=typeof window?window:void 0,(function(e,t){var n={Core:a,HLS:g,FLV:y,EZUIKitPlayer:pe};return e.EZUIKit=n,n}));